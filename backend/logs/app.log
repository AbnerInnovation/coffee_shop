2025-10-19 23:37:49,938 - app.main - INFO - ==================================================
2025-10-19 23:37:49,939 - app.main - INFO - Application starting - Logging initialized
2025-10-19 23:37:49,939 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-19 23:37:49,940 - app.main - INFO - ==================================================
2025-10-19 23:37:51,349 - app.main - INFO - Starting background tasks...
2025-10-19 23:37:53,958 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:54,151 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-19 23:37:54,152 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:37:54,160 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-19 23:37:54,161 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:37:54,167 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-19 23:37:54,169 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:37:54,173 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,185 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:54,187 - sqlalchemy.engine.Engine - INFO - [generated in 0.00259s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:54,213 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:54,214 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,217 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:54,220 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:54,221 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,222 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:54,224 - sqlalchemy.engine.Engine - INFO - [cached since 0.03996s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:54,228 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:54,229 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,231 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:54,235 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:54,237 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,239 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:54,240 - sqlalchemy.engine.Engine - INFO - [cached since 0.05586s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:54,244 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:54,245 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,246 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:54,261 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:54,263 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,265 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:54,266 - sqlalchemy.engine.Engine - INFO - [cached since 0.08186s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:54,269 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:54,269 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,271 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:54,272 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:54,274 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,275 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:54,277 - sqlalchemy.engine.Engine - INFO - [cached since 0.0929s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:54,281 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:54,282 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,285 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:54,289 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:54,291 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,292 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:54,295 - sqlalchemy.engine.Engine - INFO - [cached since 0.1105s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:54,299 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:54,299 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,302 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:54,302 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5ODE5MDMsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.WQQcf0JeROlU2yZVM_xtoomuwxoWKaHFhPQ2YRxE_rc
2025-10-19 23:37:54,333 - app.services.user - DEBUG - Decoded payload: {'exp': 1760981903, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:37:54,335 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,342 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:37:54,344 - sqlalchemy.engine.Engine - INFO - [generated in 0.00134s] {'id_1': 3, 'param_1': 1}
2025-10-19 23:37:54,352 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,354 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5ODE5MDMsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.WQQcf0JeROlU2yZVM_xtoomuwxoWKaHFhPQ2YRxE_rc
2025-10-19 23:37:54,358 - app.services.user - DEBUG - Decoded payload: {'exp': 1760981903, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:37:54,387 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,387 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:37:54,389 - sqlalchemy.engine.Engine - INFO - [cached since 0.04663s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:37:54,394 - app.main - ERROR - Database error: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 3, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'users.staff_type' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 264, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 563, in solve_dependencies
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 592, in solve_dependencies
    solved = await call(**sub_values)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 49, in get_current_user
    user = get_user(db, user_id=int(subject))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 84, in get_user
    return db.query(UserModel).filter(UserModel.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 3, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-19 23:37:54,973 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,976 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:54,977 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,978 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:54,979 - sqlalchemy.engine.Engine - INFO - [cached since 0.7941s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:54,980 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:54,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:54,982 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:54,982 - app.main - ERROR - Database error: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 3, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'users.staff_type' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 264, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 563, in solve_dependencies
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 563, in solve_dependencies
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 563, in solve_dependencies
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 592, in solve_dependencies
    solved = await call(**sub_values)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 49, in get_current_user
    user = get_user(db, user_id=int(subject))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 84, in get_user
    return db.query(UserModel).filter(UserModel.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 3, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-19 23:37:54,995 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:54,996 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:54,997 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:54,999 - sqlalchemy.engine.Engine - INFO - [cached since 0.8144s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:55,003 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:55,003 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:55,004 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:55,006 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5ODE5MDMsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.WQQcf0JeROlU2yZVM_xtoomuwxoWKaHFhPQ2YRxE_rc
2025-10-19 23:37:55,006 - app.services.user - DEBUG - Decoded payload: {'exp': 1760981903, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:37:55,007 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:55,008 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:37:55,009 - sqlalchemy.engine.Engine - INFO - [cached since 0.6671s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:37:55,011 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:55,013 - app.main - ERROR - Database error: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 3, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'users.staff_type' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 264, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 563, in solve_dependencies
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 592, in solve_dependencies
    solved = await call(**sub_values)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 49, in get_current_user
    user = get_user(db, user_id=int(subject))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 84, in get_user
    return db.query(UserModel).filter(UserModel.id == user_id).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 3, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-19 23:37:58,398 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:37:58,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:58,401 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:37:58,401 - sqlalchemy.engine.Engine - INFO - [cached since 4.217s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:37:58,404 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:37:58,404 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:58,406 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:37:58,408 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:37:58,408 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:37:58,408 - multipart.multipart - DEBUG - Calling on_field_data with data[9:31]
2025-10-19 23:37:58,408 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:37:58,409 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:37:58,409 - multipart.multipart - DEBUG - Calling on_field_name with data[32:40]
2025-10-19 23:37:58,409 - multipart.multipart - DEBUG - Calling on_field_data with data[41:49]
2025-10-19 23:37:58,410 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:37:58,410 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:37:58,410 - multipart.multipart - DEBUG - Calling on_field_name with data[50:60]
2025-10-19 23:37:58,410 - multipart.multipart - DEBUG - Calling on_field_data with data[61:69]
2025-10-19 23:37:58,410 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:37:58,411 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:37:58,411 - multipart.multipart - DEBUG - Calling on_field_name with data[70:75]
2025-10-19 23:37:58,412 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:37:58,412 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:37:58,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:37:58,418 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:37:58,419 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] {'email_1': 'admin@coffeeshop.com', 'param_1': 1}
2025-10-19 23:37:58,421 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:37:58,422 - app.main - ERROR - Database error: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'email_1': 'admin@coffeeshop.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'users.staff_type' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\api\routers\auth.py", line 59, in login_for_access_token
    user = user_service.authenticate_user(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 199, in authenticate_user
    user = get_user_by_email(db, email=email)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 97, in get_user_by_email
    return db.query(UserModel).filter(UserModel.email == email).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'email_1': 'admin@coffeeshop.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-19 23:38:05,996 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:05,997 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:05,998 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:05,999 - sqlalchemy.engine.Engine - INFO - [cached since 11.81s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:06,002 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:06,002 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:06,004 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:06,005 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:38:06,005 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:38:06,005 - multipart.multipart - DEBUG - Calling on_field_data with data[9:31]
2025-10-19 23:38:06,005 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_name with data[32:40]
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_data with data[41:49]
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_name with data[50:60]
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_data with data[61:69]
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:38:06,006 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:38:06,007 - multipart.multipart - DEBUG - Calling on_field_name with data[70:75]
2025-10-19 23:38:06,007 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:38:06,007 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:38:06,009 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:06,010 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:38:06,011 - sqlalchemy.engine.Engine - INFO - [cached since 7.593s ago] {'email_1': 'admin@coffeeshop.com', 'param_1': 1}
2025-10-19 23:38:06,012 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:06,014 - app.main - ERROR - Database error: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'email_1': 'admin@coffeeshop.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'users.staff_type' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\api\routers\auth.py", line 59, in login_for_access_token
    user = user_service.authenticate_user(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 199, in authenticate_user
    user = get_user_by_email(db, email=email)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\services\user.py", line 97, in get_user_by_email
    return db.query(UserModel).filter(UserModel.email == email).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 822, in _read_query_result
    result.read()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pymysql\err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'users.staff_type' in 'field list'")
[SQL: SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'email_1': 'admin@coffeeshop.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-19 23:38:20,862 - app.main - INFO - Shutting down background tasks...
2025-10-19 23:38:36,930 - app.main - INFO - ==================================================
2025-10-19 23:38:36,932 - app.main - INFO - Application starting - Logging initialized
2025-10-19 23:38:36,932 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-19 23:38:36,933 - app.main - INFO - ==================================================
2025-10-19 23:38:37,656 - app.main - INFO - Starting background tasks...
2025-10-19 23:38:44,948 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:45,043 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-19 23:38:45,044 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:38:45,046 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-19 23:38:45,047 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:38:45,049 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-19 23:38:45,049 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:38:45,051 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:45,059 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:45,061 - sqlalchemy.engine.Engine - INFO - [generated in 0.00197s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:45,064 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:45,064 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:45,066 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:45,067 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:38:45,067 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:38:45,067 - multipart.multipart - DEBUG - Calling on_field_data with data[9:31]
2025-10-19 23:38:45,069 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:38:45,069 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:38:45,069 - multipart.multipart - DEBUG - Calling on_field_name with data[32:40]
2025-10-19 23:38:45,069 - multipart.multipart - DEBUG - Calling on_field_data with data[41:49]
2025-10-19 23:38:45,070 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:38:45,070 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:38:45,070 - multipart.multipart - DEBUG - Calling on_field_name with data[50:60]
2025-10-19 23:38:45,070 - multipart.multipart - DEBUG - Calling on_field_data with data[61:69]
2025-10-19 23:38:45,070 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:38:45,070 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:38:45,070 - multipart.multipart - DEBUG - Calling on_field_name with data[70:75]
2025-10-19 23:38:45,070 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:38:45,071 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:38:45,074 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:45,078 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:38:45,079 - sqlalchemy.engine.Engine - INFO - [generated in 0.00145s] {'email_1': 'admin@coffeeshop.com', 'param_1': 1}
2025-10-19 23:38:45,083 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-19 23:38:45,084 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-19 23:38:45,452 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:45,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:45,472 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:45,475 - sqlalchemy.engine.Engine - INFO - [cached since 0.4157s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:45,481 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:45,481 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:45,500 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:45,508 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:45,509 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:45,511 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:45,515 - sqlalchemy.engine.Engine - INFO - [cached since 0.4556s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:45,521 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:45,522 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:45,524 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:45,529 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:38:45,531 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:38:45,533 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:45,538 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:38:45,538 - sqlalchemy.engine.Engine - INFO - [generated in 0.00144s] {'id_1': 3, 'param_1': 1}
2025-10-19 23:38:45,542 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:38:45,565 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,103 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:46,104 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,106 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:46,107 - sqlalchemy.engine.Engine - INFO - [cached since 1.048s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:46,109 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:46,109 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,111 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:46,117 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:46,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,119 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:46,120 - sqlalchemy.engine.Engine - INFO - [cached since 1.061s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:46,123 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:46,124 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,125 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:46,128 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:38:46,129 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:38:46,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,132 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:38:46,132 - sqlalchemy.engine.Engine - INFO - [cached since 0.595s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:38:46,136 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:38:46,137 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:46,137 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,138 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:46,139 - sqlalchemy.engine.Engine - INFO - [cached since 1.081s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:46,142 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:46,142 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,144 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,148 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:38:46,149 - sqlalchemy.engine.Engine - INFO - [generated in 0.00116s] {'restaurant_id_1': 1}
2025-10-19 23:38:46,156 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,172 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:46,173 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,174 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:46,174 - sqlalchemy.engine.Engine - INFO - [cached since 1.116s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:46,178 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:46,178 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,178 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:46,191 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:46,192 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,194 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:46,195 - sqlalchemy.engine.Engine - INFO - [cached since 1.136s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:46,197 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:46,197 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,199 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:46,203 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:46,204 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,204 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:46,206 - sqlalchemy.engine.Engine - INFO - [cached since 1.147s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:46,207 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:46,208 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,209 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:46,213 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:46,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,215 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:46,216 - sqlalchemy.engine.Engine - INFO - [cached since 1.158s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:46,218 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:46,218 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,220 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:46,221 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:38:46,222 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:38:46,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,223 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:38:46,223 - sqlalchemy.engine.Engine - INFO - [cached since 0.6862s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:38:46,226 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:38:46,228 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:46,229 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,230 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:46,230 - sqlalchemy.engine.Engine - INFO - [cached since 1.172s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:46,233 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:46,234 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:46,256 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:38:46,257 - sqlalchemy.engine.Engine - INFO - [generated in 0.00152s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:38:46,293 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:46,295 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,694 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:48,695 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,698 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:48,699 - sqlalchemy.engine.Engine - INFO - [cached since 3.641s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:48,704 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:48,704 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,708 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:48,709 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:48,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,714 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:48,716 - sqlalchemy.engine.Engine - INFO - [cached since 3.658s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:48,720 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:48,721 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,722 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:48,729 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:38:48,730 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:38:48,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,732 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:38:48,735 - sqlalchemy.engine.Engine - INFO - [cached since 3.197s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:38:48,738 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:38:48,739 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:48,741 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,741 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:48,743 - sqlalchemy.engine.Engine - INFO - [cached since 3.684s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:48,747 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:48,747 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,753 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,758 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:38:48,760 - sqlalchemy.engine.Engine - INFO - [generated in 0.00183s] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:38:48,766 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:38:48,767 - sqlalchemy.engine.Engine - INFO - [cached since 0.009641s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:38:48,781 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:38:48,784 - sqlalchemy.engine.Engine - INFO - [generated in 0.00258s] {'pk_1': 4}
2025-10-19 23:38:48,794 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:38:48,795 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] {'param_1': 12}
2025-10-19 23:38:48,804 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:38:48,806 - sqlalchemy.engine.Engine - INFO - [generated in 0.00123s] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-19 23:38:48,812 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:38:48,812 - sqlalchemy.engine.Engine - INFO - [cached since 0.007739s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-19 23:38:48,815 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:38:48,816 - sqlalchemy.engine.Engine - INFO - [cached since 0.01147s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-19 23:38:48,817 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:38:48,819 - sqlalchemy.engine.Engine - INFO - [cached since 0.01448s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-19 23:38:48,822 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:38:48,823 - sqlalchemy.engine.Engine - INFO - [cached since 0.01905s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-19 23:38:48,829 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-19 23:38:48,830 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] {'restaurant_id_1': 1}
2025-10-19 23:38:48,836 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-19 23:38:48,838 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] {'restaurant_id_1': 1}
2025-10-19 23:38:48,845 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-19 23:38:48,846 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] {'restaurant_id_1': 1}
2025-10-19 23:38:48,850 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,851 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,854 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:48,855 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,857 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:48,858 - sqlalchemy.engine.Engine - INFO - [cached since 3.799s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:48,860 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:48,860 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,861 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:38:48,863 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:38:48,864 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,865 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:38:48,866 - sqlalchemy.engine.Engine - INFO - [cached since 3.808s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:38:48,868 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:38:48,868 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,869 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:38:48,870 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:38:48,871 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,872 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:38:48,872 - sqlalchemy.engine.Engine - INFO - [cached since 3.335s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:38:48,874 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:38:48,876 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:38:48,878 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:38:48,879 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:38:48,884 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:38:48,886 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:35,758 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:35,760 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:35,761 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:35,763 - sqlalchemy.engine.Engine - INFO - [cached since 50.71s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:35,767 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:35,767 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:35,770 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:39:35,778 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:35,780 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:35,781 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:35,783 - sqlalchemy.engine.Engine - INFO - [cached since 50.72s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:35,785 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:35,787 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:35,787 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:39:35,791 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:35,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:35,795 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:35,796 - sqlalchemy.engine.Engine - INFO - [cached since 50.74s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:35,799 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:35,800 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:35,802 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:39:35,805 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:39:35,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:35,807 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:35,808 - sqlalchemy.engine.Engine - INFO - [cached since 50.27s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:39:35,810 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:39:35,814 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:35,815 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:39:35,815 - sqlalchemy.engine.Engine - INFO - [cached since 47.06s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:39:35,819 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:39:35,820 - sqlalchemy.engine.Engine - INFO - [cached since 47.04s ago] {'pk_1': 4}
2025-10-19 23:39:35,823 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:39:35,824 - sqlalchemy.engine.Engine - INFO - [cached since 47.03s ago] {'param_1': 12}
2025-10-19 23:39:35,826 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:35,828 - sqlalchemy.engine.Engine - INFO - [cached since 47.02s ago] {'restaurant_id_1': 1, 'role_1': 'staff'}
2025-10-19 23:39:35,831 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:35,832 - sqlalchemy.engine.Engine - INFO - [cached since 50.75s ago] {'email_1': 'mesero-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:39:35,834 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:35,835 - sqlalchemy.engine.Engine - INFO - [cached since 50.76s ago] {'email_1': 'mesero-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:39:36,158 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (email, hashed_password, full_name, `role`, staff_type, is_active, restaurant_id, created_at, updated_at, deleted_at) VALUES (%(email)s, %(hashed_password)s, %(full_name)s, %(role)s, %(staff_type)s, %(is_active)s, %(restaurant_id)s, %(created_at)s, %(updated_at)s, %(deleted_at)s)
2025-10-19 23:39:36,160 - sqlalchemy.engine.Engine - INFO - [generated in 0.00153s] {'email': 'mesero-default@shopacoffee.com', 'hashed_password': '$2b$12$.bZE3w5XzDGEo.C9EbQVn.MvNHpaaOFl2I9FEOB8hBodUWbesMdEq', 'full_name': 'Mesero', 'role': 'staff', 'staff_type': None, 'is_active': 1, 'restaurant_id': 1, 'created_at': datetime.datetime(2025, 10, 20, 6, 39, 36, 158521, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 6, 39, 36, 158521, tzinfo=datetime.timezone.utc), 'deleted_at': None}
2025-10-19 23:39:36,166 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-19 23:39:36,172 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,174 - sqlalchemy.engine.Engine - INFO - SELECT users.email, users.hashed_password, users.full_name, users.`role`, users.staff_type, users.is_active, users.restaurant_id, users.id, users.created_at, users.updated_at, users.deleted_at 
FROM users 
WHERE users.id = %(pk_1)s
2025-10-19 23:39:36,174 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] {'pk_1': 7}
2025-10-19 23:39:36,180 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,219 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:36,220 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,221 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:36,222 - sqlalchemy.engine.Engine - INFO - [cached since 51.16s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:36,223 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:36,224 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,226 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:39:36,227 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:36,228 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,229 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:36,231 - sqlalchemy.engine.Engine - INFO - [cached since 51.17s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:36,234 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:36,234 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,235 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:39:36,238 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:36,239 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,239 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:36,240 - sqlalchemy.engine.Engine - INFO - [cached since 51.18s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:36,242 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:36,242 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,245 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:39:36,246 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:39:36,247 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,249 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:36,249 - sqlalchemy.engine.Engine - INFO - [cached since 50.71s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:39:36,250 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:39:36,251 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:36,253 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,253 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:36,254 - sqlalchemy.engine.Engine - INFO - [cached since 51.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:36,256 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:36,256 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,258 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:39:36,258 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:39:36,259 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,260 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:36,261 - sqlalchemy.engine.Engine - INFO - [cached since 50.72s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:39:36,264 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:39:36,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,272 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:39:36,272 - sqlalchemy.engine.Engine - INFO - [cached since 47.39s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:39:36,281 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,287 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:36,289 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:39:36,290 - sqlalchemy.engine.Engine - INFO - [cached since 47.53s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:39:36,296 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:39:36,296 - sqlalchemy.engine.Engine - INFO - [cached since 47.54s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:39:36,300 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:39:36,301 - sqlalchemy.engine.Engine - INFO - [cached since 47.52s ago] {'pk_1': 4}
2025-10-19 23:39:36,304 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:39:36,305 - sqlalchemy.engine.Engine - INFO - [cached since 47.51s ago] {'param_1': 12}
2025-10-19 23:39:36,308 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:36,310 - sqlalchemy.engine.Engine - INFO - [cached since 47.51s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-19 23:39:36,313 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:36,315 - sqlalchemy.engine.Engine - INFO - [cached since 47.51s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-19 23:39:36,318 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:36,319 - sqlalchemy.engine.Engine - INFO - [cached since 47.51s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-19 23:39:36,322 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:36,323 - sqlalchemy.engine.Engine - INFO - [cached since 47.52s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-19 23:39:36,324 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:36,325 - sqlalchemy.engine.Engine - INFO - [cached since 47.52s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-19 23:39:36,328 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:36,328 - sqlalchemy.engine.Engine - INFO - [cached since 47.5s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:36,330 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:36,331 - sqlalchemy.engine.Engine - INFO - [cached since 47.49s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:36,334 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:36,335 - sqlalchemy.engine.Engine - INFO - [cached since 47.49s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:36,338 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:36,340 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:47,901 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:47,902 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,904 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:47,905 - sqlalchemy.engine.Engine - INFO - [cached since 62.85s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:47,907 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:47,907 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:47,909 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:39:47,909 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:47,911 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,911 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:47,913 - sqlalchemy.engine.Engine - INFO - [cached since 62.85s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:47,918 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:47,919 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:47,920 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:39:47,923 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:39:47,923 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:39:47,924 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,926 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:47,926 - sqlalchemy.engine.Engine - INFO - [cached since 62.39s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:39:47,928 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:39:47,929 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:39:47,929 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:39:47,930 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,932 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:47,932 - sqlalchemy.engine.Engine - INFO - [cached since 62.39s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:39:47,934 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:39:47,936 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:47,937 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,939 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:47,940 - sqlalchemy.engine.Engine - INFO - [cached since 62.88s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:47,943 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:47,943 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:47,948 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:47,948 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:47,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,951 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:47,952 - sqlalchemy.engine.Engine - INFO - [cached since 62.89s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:47,954 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:47,954 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:47,956 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:39:47,959 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:47,959 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,961 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,961 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:39:47,963 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:47,964 - sqlalchemy.engine.Engine - INFO - [cached since 59.21s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:39:47,964 - sqlalchemy.engine.Engine - INFO - [cached since 62.91s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:47,966 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:47,967 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:47,970 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:39:47,972 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:39:47,972 - sqlalchemy.engine.Engine - INFO - [cached since 59.21s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:39:47,972 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:39:47,975 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:39:47,975 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,976 - sqlalchemy.engine.Engine - INFO - [cached since 59.2s ago] {'pk_1': 4}
2025-10-19 23:39:47,976 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:47,978 - sqlalchemy.engine.Engine - INFO - [cached since 62.44s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:39:47,980 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:39:47,982 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:39:47,984 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:47,984 - sqlalchemy.engine.Engine - INFO - [cached since 59.19s ago] {'param_1': 12}
2025-10-19 23:39:47,985 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:39:47,986 - sqlalchemy.engine.Engine - INFO - [cached since 59.11s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:39:47,988 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:47,990 - sqlalchemy.engine.Engine - INFO - [cached since 59.19s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-19 23:39:47,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:47,998 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:47,998 - sqlalchemy.engine.Engine - INFO - [cached since 59.19s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-19 23:39:47,999 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:48,001 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,004 - sqlalchemy.engine.Engine - INFO - [cached since 59.2s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-19 23:39:48,006 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,006 - sqlalchemy.engine.Engine - INFO - [cached since 59.2s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-19 23:39:48,010 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,011 - sqlalchemy.engine.Engine - INFO - [cached since 59.21s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-19 23:39:48,014 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,014 - sqlalchemy.engine.Engine - INFO - [cached since 59.19s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:48,017 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,019 - sqlalchemy.engine.Engine - INFO - [cached since 59.18s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:48,023 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,023 - sqlalchemy.engine.Engine - INFO - [cached since 59.18s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:48,028 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:48,028 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:48,031 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:48,032 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:48,032 - sqlalchemy.engine.Engine - INFO - [cached since 62.97s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:48,034 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:48,035 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:48,036 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:39:48,037 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:39:48,037 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:48,038 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:39:48,039 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:48,040 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:39:48,041 - sqlalchemy.engine.Engine - INFO - [cached since 62.5s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:39:48,043 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:39:48,044 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:39:48,045 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:48,046 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:39:48,047 - sqlalchemy.engine.Engine - INFO - [cached since 62.99s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:39:48,048 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:39:48,048 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:48,052 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:39:48,054 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:39:48,055 - sqlalchemy.engine.Engine - INFO - [cached since 59.3s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:39:48,058 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:39:48,060 - sqlalchemy.engine.Engine - INFO - [cached since 59.3s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:39:48,064 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:39:48,065 - sqlalchemy.engine.Engine - INFO - [cached since 59.28s ago] {'pk_1': 4}
2025-10-19 23:39:48,068 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:39:48,069 - sqlalchemy.engine.Engine - INFO - [cached since 59.28s ago] {'param_1': 12}
2025-10-19 23:39:48,073 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,074 - sqlalchemy.engine.Engine - INFO - [cached since 59.27s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-19 23:39:48,077 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,078 - sqlalchemy.engine.Engine - INFO - [cached since 59.27s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-19 23:39:48,080 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,082 - sqlalchemy.engine.Engine - INFO - [cached since 59.28s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-19 23:39:48,085 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,085 - sqlalchemy.engine.Engine - INFO - [cached since 59.28s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-19 23:39:48,088 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,088 - sqlalchemy.engine.Engine - INFO - [cached since 59.28s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-19 23:39:48,091 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,092 - sqlalchemy.engine.Engine - INFO - [cached since 59.26s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:48,096 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,097 - sqlalchemy.engine.Engine - INFO - [cached since 59.26s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:48,101 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-19 23:39:48,102 - sqlalchemy.engine.Engine - INFO - [cached since 59.26s ago] {'restaurant_id_1': 1}
2025-10-19 23:39:48,106 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:39:48,110 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:35,386 - app.main - INFO - Shutting down background tasks...
2025-10-19 23:43:46,545 - app.main - INFO - ==================================================
2025-10-19 23:43:46,546 - app.main - INFO - Application starting - Logging initialized
2025-10-19 23:43:46,546 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-19 23:43:46,547 - app.main - INFO - ==================================================
2025-10-19 23:43:47,825 - app.main - INFO - Starting background tasks...
2025-10-19 23:43:49,665 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:49,799 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-19 23:43:49,800 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:43:49,801 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-19 23:43:49,803 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:43:49,804 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-19 23:43:49,805 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:43:49,807 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,812 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:49,814 - sqlalchemy.engine.Engine - INFO - [generated in 0.00137s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:49,819 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:49,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:49,820 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:49,823 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:49,824 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,825 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:49,827 - sqlalchemy.engine.Engine - INFO - [cached since 0.01395s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:49,829 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:49,830 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:49,831 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:49,836 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:49,837 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,839 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:49,840 - sqlalchemy.engine.Engine - INFO - [cached since 0.02712s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:49,842 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:49,843 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:49,844 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:49,845 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:49,851 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:49,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,856 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:49,858 - sqlalchemy.engine.Engine - INFO - [generated in 0.00116s] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:49,863 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:49,863 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:49,864 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:49,888 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,889 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:49,891 - sqlalchemy.engine.Engine - INFO - [cached since 0.03483s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:49,896 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:49,907 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:49,914 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,915 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:49,917 - sqlalchemy.engine.Engine - INFO - [cached since 0.1044s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:49,920 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:49,921 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:49,928 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:49,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,937 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:43:49,939 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:49,938 - sqlalchemy.engine.Engine - INFO - [generated in 0.00199s] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:43:49,941 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,943 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:49,944 - sqlalchemy.engine.Engine - INFO - [cached since 0.1307s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:49,948 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:49,947 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:43:49,949 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:49,951 - sqlalchemy.engine.Engine - INFO - [cached since 0.0143s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:43:49,953 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:49,961 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:49,961 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:49,960 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:43:49,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,963 - sqlalchemy.engine.Engine - INFO - [generated in 0.00389s] {'pk_1': 4}
2025-10-19 23:43:49,966 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:49,968 - sqlalchemy.engine.Engine - INFO - [cached since 0.1109s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:49,974 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:49,973 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:43:49,976 - sqlalchemy.engine.Engine - INFO - [generated in 0.00271s] {'param_1': 12}
2025-10-19 23:43:49,977 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:49,988 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:49,989 - sqlalchemy.engine.Engine - INFO - [generated in 0.00137s] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-19 23:43:49,993 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:49,994 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:49,995 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:49,997 - sqlalchemy.engine.Engine - INFO - [cached since 0.1847s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:49,998 - sqlalchemy.engine.Engine - INFO - [cached since 0.01056s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-19 23:43:50,003 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,002 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:50,003 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,004 - sqlalchemy.engine.Engine - INFO - [cached since 0.01554s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-19 23:43:50,009 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,011 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:50,039 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-19 23:43:50,039 - sqlalchemy.engine.Engine - INFO - [cached since 0.05137s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-19 23:43:50,042 - sqlalchemy.engine.Engine - INFO - [generated in 0.00303s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-19 23:43:50,044 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:50,046 - sqlalchemy.engine.Engine - INFO - [cached since 0.05849s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-19 23:43:50,052 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:50,054 - sqlalchemy.engine.Engine - INFO - [generated in 0.00123s] {'restaurant_id_1': 1}
2025-10-19 23:43:50,062 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:50,064 - sqlalchemy.engine.Engine - INFO - [generated in 0.00253s] {'restaurant_id_1': 1}
2025-10-19 23:43:50,071 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:50,075 - sqlalchemy.engine.Engine - INFO - [generated in 0.00519s] {'restaurant_id_1': 1}
2025-10-19 23:43:50,094 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,095 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] {'pk_1': 16}
2025-10-19 23:43:50,098 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,100 - sqlalchemy.engine.Engine - INFO - [cached since 0.006522s ago] {'pk_1': 9}
2025-10-19 23:43:50,103 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,103 - sqlalchemy.engine.Engine - INFO - [cached since 0.01043s ago] {'pk_1': 15}
2025-10-19 23:43:50,107 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,109 - sqlalchemy.engine.Engine - INFO - [cached since 0.01528s ago] {'pk_1': 13}
2025-10-19 23:43:50,113 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,114 - sqlalchemy.engine.Engine - INFO - [cached since 0.02063s ago] {'pk_1': 14}
2025-10-19 23:43:50,118 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,120 - sqlalchemy.engine.Engine - INFO - [cached since 0.02645s ago] {'pk_1': 18}
2025-10-19 23:43:50,123 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,124 - sqlalchemy.engine.Engine - INFO - [cached since 0.03002s ago] {'pk_1': 21}
2025-10-19 23:43:50,126 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,128 - sqlalchemy.engine.Engine - INFO - [cached since 0.03443s ago] {'pk_1': 19}
2025-10-19 23:43:50,131 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,132 - sqlalchemy.engine.Engine - INFO - [cached since 0.03873s ago] {'pk_1': 22}
2025-10-19 23:43:50,136 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,138 - sqlalchemy.engine.Engine - INFO - [cached since 0.04444s ago] {'pk_1': 7}
2025-10-19 23:43:50,142 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,143 - sqlalchemy.engine.Engine - INFO - [cached since 0.04965s ago] {'pk_1': 5}
2025-10-19 23:43:50,147 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,148 - sqlalchemy.engine.Engine - INFO - [cached since 0.05404s ago] {'pk_1': 6}
2025-10-19 23:43:50,154 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:43:50,158 - sqlalchemy.engine.Engine - INFO - [cached since 0.06384s ago] {'pk_1': 8}
2025-10-19 23:43:50,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,186 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,188 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,192 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,199 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,203 - sqlalchemy.engine.Engine - INFO - [cached since 0.3893s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,206 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,207 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,208 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,218 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,221 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,225 - sqlalchemy.engine.Engine - INFO - [cached since 0.4116s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,228 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,228 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,231 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,238 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,239 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,241 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,243 - sqlalchemy.engine.Engine - INFO - [cached since 0.4304s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,249 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,249 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,253 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,258 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,260 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,263 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,266 - sqlalchemy.engine.Engine - INFO - [cached since 0.4533s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,270 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,270 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,273 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,275 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:50,275 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:50,275 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,276 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:50,278 - sqlalchemy.engine.Engine - INFO - [cached since 0.4212s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:50,279 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:50,281 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,284 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,286 - sqlalchemy.engine.Engine - INFO - [cached since 0.4726s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,288 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,288 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,290 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,294 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:43:50,296 - sqlalchemy.engine.Engine - INFO - [generated in 0.00236s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:43:50,310 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,313 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,678 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,679 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,682 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,685 - sqlalchemy.engine.Engine - INFO - [cached since 0.8718s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,692 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,693 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,701 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,706 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,707 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,710 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,711 - sqlalchemy.engine.Engine - INFO - [cached since 0.8983s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,718 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,718 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,720 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,721 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:50,723 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:50,724 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,726 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:50,727 - sqlalchemy.engine.Engine - INFO - [cached since 0.87s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:50,730 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:50,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,751 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:43:50,755 - sqlalchemy.engine.Engine - INFO - [generated in 0.00432s] {'opened_by_user_id_1': 3, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:43:50,793 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,795 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,803 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,805 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,806 - sqlalchemy.engine.Engine - INFO - [cached since 0.993s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,808 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,809 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,810 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,811 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,812 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,813 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,814 - sqlalchemy.engine.Engine - INFO - [cached since 1.001s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,817 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,817 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,818 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,825 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,826 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,827 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,828 - sqlalchemy.engine.Engine - INFO - [cached since 1.015s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,830 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,831 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,834 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:50,835 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,836 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:50,838 - sqlalchemy.engine.Engine - INFO - [cached since 1.025s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:50,842 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:50,842 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,843 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:50,860 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:50,861 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:50,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,863 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:50,863 - sqlalchemy.engine.Engine - INFO - [cached since 1.007s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:50,865 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:50,866 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:50,867 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:50,868 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,868 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:50,869 - sqlalchemy.engine.Engine - INFO - [cached since 1.013s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:50,872 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:50,875 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,875 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:50,877 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_reports.session_id AS cash_register_reports_session_id, cash_register_reports.report_type AS cash_register_reports_report_type, cash_register_reports.data AS cash_register_reports_data, cash_register_reports.generated_at AS cash_register_reports_generated_at, cash_register_reports.id AS cash_register_reports_id, cash_register_reports.created_at AS cash_register_reports_created_at, cash_register_reports.updated_at AS cash_register_reports_updated_at, cash_register_reports.deleted_at AS cash_register_reports_deleted_at 
FROM cash_register_reports 
WHERE cash_register_reports.session_id = %(session_id_1)s AND cash_register_reports.report_type = %(report_type_1)s ORDER BY cash_register_reports.generated_at DESC 
 LIMIT %(param_1)s
2025-10-19 23:43:50,879 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:43:50,880 - sqlalchemy.engine.Engine - INFO - [generated in 0.00307s] {'session_id_1': 10, 'report_type_1': 'daily_summary', 'param_1': 1}
2025-10-19 23:43:50,881 - sqlalchemy.engine.Engine - INFO - [generated in 0.00138s] {'session_id_1': 10, 'param_1': 0, 'param_2': 100}
2025-10-19 23:43:50,891 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,891 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,893 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:50,894 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:52,190 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:52,191 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:52,192 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:52,193 - sqlalchemy.engine.Engine - INFO - [cached since 2.38s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:52,194 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:52,195 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:52,196 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:52,197 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:52,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:52,199 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:52,200 - sqlalchemy.engine.Engine - INFO - [cached since 2.387s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:52,203 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:52,203 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:52,205 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:43:52,206 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:52,206 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:52,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:52,207 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:52,208 - sqlalchemy.engine.Engine - INFO - [cached since 2.352s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:52,209 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:52,211 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:52,211 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:52,213 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:52,213 - sqlalchemy.engine.Engine - INFO - [cached since 2.401s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:52,215 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:52,215 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:52,217 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:43:52,217 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:52,220 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:43:52,221 - sqlalchemy.engine.Engine - INFO - [cached since 2.408s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:43:52,223 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:43:52,223 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:52,225 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:43:52,225 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:43:52,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:52,226 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:43:52,228 - sqlalchemy.engine.Engine - INFO - [cached since 2.371s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:43:52,229 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:43:52,232 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:52,233 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:43:52,234 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:43:52,239 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:43:52,240 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:52,241 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:43:52,243 - sqlalchemy.engine.Engine - INFO - [cached since 2.306s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:43:52,243 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:52,245 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:43:52,247 - sqlalchemy.engine.Engine - INFO - [cached since 2.311s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:43:52,250 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:43:52,251 - sqlalchemy.engine.Engine - INFO - [cached since 2.292s ago] {'pk_1': 4}
2025-10-19 23:43:52,254 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:43:52,254 - sqlalchemy.engine.Engine - INFO - [cached since 2.282s ago] {'param_1': 12}
2025-10-19 23:43:52,259 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:52,265 - sqlalchemy.engine.Engine - INFO - [cached since 2.277s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-19 23:43:52,273 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:52,277 - sqlalchemy.engine.Engine - INFO - [cached since 2.289s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-19 23:43:52,282 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:52,289 - sqlalchemy.engine.Engine - INFO - [cached since 2.301s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-19 23:43:52,299 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:52,310 - sqlalchemy.engine.Engine - INFO - [cached since 2.322s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-19 23:43:52,321 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:52,326 - sqlalchemy.engine.Engine - INFO - [cached since 2.338s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-19 23:43:52,331 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:52,336 - sqlalchemy.engine.Engine - INFO - [cached since 2.284s ago] {'restaurant_id_1': 1}
2025-10-19 23:43:52,344 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:52,351 - sqlalchemy.engine.Engine - INFO - [cached since 2.29s ago] {'restaurant_id_1': 1}
2025-10-19 23:43:52,358 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-19 23:43:52,359 - sqlalchemy.engine.Engine - INFO - [cached since 2.289s ago] {'restaurant_id_1': 1}
2025-10-19 23:43:52,365 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:43:52,366 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,296 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:32,298 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,299 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:32,300 - sqlalchemy.engine.Engine - INFO - [cached since 42.49s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:32,302 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:32,302 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,305 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:32,307 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:32,309 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,310 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:32,311 - sqlalchemy.engine.Engine - INFO - [cached since 42.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:32,314 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:32,314 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,318 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:44:32,319 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:44:32,320 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,320 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:32,320 - sqlalchemy.engine.Engine - INFO - [cached since 42.46s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:44:32,323 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:44:32,326 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,328 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:44:32,329 - sqlalchemy.engine.Engine - INFO - [cached since 42.39s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:44:32,335 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:44:32,336 - sqlalchemy.engine.Engine - INFO - [cached since 42.38s ago] {'pk_1': 4}
2025-10-19 23:44:32,340 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:44:32,340 - sqlalchemy.engine.Engine - INFO - [cached since 42.37s ago] {'param_1': 12}
2025-10-19 23:44:32,342 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,344 - sqlalchemy.engine.Engine - INFO - [cached since 42.36s ago] {'restaurant_id_1': 1, 'role_1': 'staff'}
2025-10-19 23:44:32,346 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:32,348 - sqlalchemy.engine.Engine - INFO - [generated in 0.00164s] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:44:32,350 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:32,352 - sqlalchemy.engine.Engine - INFO - [cached since 0.004975s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:44:32,354 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-19 23:44:32,354 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-19 23:44:32,709 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (email, hashed_password, full_name, `role`, staff_type, is_active, restaurant_id, created_at, updated_at, deleted_at) VALUES (%(email)s, %(hashed_password)s, %(full_name)s, %(role)s, %(staff_type)s, %(is_active)s, %(restaurant_id)s, %(created_at)s, %(updated_at)s, %(deleted_at)s)
2025-10-19 23:44:32,710 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] {'email': 'cashier-default@shopacoffee.com', 'hashed_password': '$2b$12$oyj63gqHuMBfl49ZGIlfCuELlCXmKVsxRCd5on7vIxtQnANUg0ln.', 'full_name': 'cashier', 'role': 'staff', 'staff_type': 'cashier', 'is_active': 1, 'restaurant_id': 1, 'created_at': datetime.datetime(2025, 10, 20, 6, 44, 32, 709001, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 6, 44, 32, 709001, tzinfo=datetime.timezone.utc), 'deleted_at': None}
2025-10-19 23:44:32,717 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-19 23:44:32,723 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,724 - sqlalchemy.engine.Engine - INFO - SELECT users.email, users.hashed_password, users.full_name, users.`role`, users.staff_type, users.is_active, users.restaurant_id, users.id, users.created_at, users.updated_at, users.deleted_at 
FROM users 
WHERE users.id = %(pk_1)s
2025-10-19 23:44:32,724 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] {'pk_1': 8}
2025-10-19 23:44:32,730 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,733 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,771 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:32,771 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,772 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:32,774 - sqlalchemy.engine.Engine - INFO - [cached since 42.96s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:32,776 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:32,776 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,778 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:32,780 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:32,781 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,783 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:32,785 - sqlalchemy.engine.Engine - INFO - [cached since 42.97s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:32,788 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:32,788 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,791 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:32,793 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:32,794 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,795 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:32,796 - sqlalchemy.engine.Engine - INFO - [cached since 42.98s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:32,801 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:32,801 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,805 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:44:32,806 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:44:32,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,806 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:32,808 - sqlalchemy.engine.Engine - INFO - [cached since 42.95s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:44:32,810 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:44:32,810 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTAzMjUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0._aHwGO8kYQ6ksAoWUGxqoRSHzDH2QFiH9iybbnfa590
2025-10-19 23:44:32,812 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990325, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:44:32,812 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,813 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:32,815 - sqlalchemy.engine.Engine - INFO - [cached since 42.96s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:44:32,817 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:44:32,817 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:32,818 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,820 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:32,820 - sqlalchemy.engine.Engine - INFO - [cached since 43.01s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:32,822 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:32,822 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,826 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,827 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:44:32,828 - sqlalchemy.engine.Engine - INFO - [cached since 40.59s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:44:32,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:32,834 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:44:32,835 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,836 - sqlalchemy.engine.Engine - INFO - [cached since 42.9s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:44:32,841 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:44:32,841 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,842 - sqlalchemy.engine.Engine - INFO - [cached since 42.91s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:44:32,845 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:44:32,846 - sqlalchemy.engine.Engine - INFO - [cached since 42.89s ago] {'pk_1': 4}
2025-10-19 23:44:32,851 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:44:32,851 - sqlalchemy.engine.Engine - INFO - [cached since 42.88s ago] {'param_1': 12}
2025-10-19 23:44:32,856 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,857 - sqlalchemy.engine.Engine - INFO - [cached since 42.87s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-19 23:44:32,860 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,862 - sqlalchemy.engine.Engine - INFO - [cached since 42.87s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-19 23:44:32,864 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,865 - sqlalchemy.engine.Engine - INFO - [cached since 42.88s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-19 23:44:32,869 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,870 - sqlalchemy.engine.Engine - INFO - [cached since 42.88s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-19 23:44:32,872 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,873 - sqlalchemy.engine.Engine - INFO - [cached since 42.89s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-19 23:44:32,875 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,876 - sqlalchemy.engine.Engine - INFO - [cached since 42.82s ago] {'restaurant_id_1': 1}
2025-10-19 23:44:32,878 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,879 - sqlalchemy.engine.Engine - INFO - [cached since 42.82s ago] {'restaurant_id_1': 1}
2025-10-19 23:44:32,884 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-19 23:44:32,884 - sqlalchemy.engine.Engine - INFO - [cached since 42.81s ago] {'restaurant_id_1': 1}
2025-10-19 23:44:32,888 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:32,891 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:42,546 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:42,547 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:42,550 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:42,551 - sqlalchemy.engine.Engine - INFO - [cached since 52.74s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:42,556 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:42,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:42,561 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:42,563 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:44:42,563 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:44:42,563 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:44:42,563 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:44:42,564 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:44:42,564 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:44:42,564 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:44:42,564 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:44:42,566 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:44:42,566 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:44:42,567 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:44:42,567 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:44:42,567 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:44:42,567 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:44:42,567 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:44:42,568 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:44:42,570 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:42,574 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:42,574 - sqlalchemy.engine.Engine - INFO - [cached since 10.23s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:44:42,899 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:42,900 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:42,901 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:42,904 - sqlalchemy.engine.Engine - INFO - [cached since 53.09s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:42,906 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:42,907 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:42,910 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:42,913 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:42,915 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:42,918 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:42,921 - sqlalchemy.engine.Engine - INFO - [cached since 53.11s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:42,925 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:42,925 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:42,927 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:42,929 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:44:42,930 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:44:42,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:42,934 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:42,937 - sqlalchemy.engine.Engine - INFO - [cached since 53.08s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:44:42,942 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:44:42,945 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,264 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:43,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,266 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:43,267 - sqlalchemy.engine.Engine - INFO - [cached since 53.45s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:43,269 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:43,269 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,271 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:43,272 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:44:43,273 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:44:43,274 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,274 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:43,276 - sqlalchemy.engine.Engine - INFO - [cached since 53.42s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:44:43,278 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:44:43,279 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:43,279 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,280 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:43,281 - sqlalchemy.engine.Engine - INFO - [cached since 53.47s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:43,284 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:43,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,287 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:44:43,288 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] {'restaurant_id_1': 1}
2025-10-19 23:44:43,293 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,295 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,301 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:43,303 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,304 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:43,304 - sqlalchemy.engine.Engine - INFO - [cached since 53.49s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:43,306 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:43,306 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,308 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:43,321 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:43,322 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,323 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:43,323 - sqlalchemy.engine.Engine - INFO - [cached since 53.51s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:43,326 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:43,326 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,327 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:43,329 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:44:43,329 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:44:43,330 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,332 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:43,333 - sqlalchemy.engine.Engine - INFO - [cached since 53.48s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:44:43,335 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:44:43,336 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:43,337 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,337 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:43,338 - sqlalchemy.engine.Engine - INFO - [cached since 53.53s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:43,340 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:43,340 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,343 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:43,351 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:44:43,353 - sqlalchemy.engine.Engine - INFO - [generated in 0.00169s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:44:43,374 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:43,377 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:46,170 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:46,170 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:46,171 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:46,172 - sqlalchemy.engine.Engine - INFO - [cached since 56.36s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:46,175 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:46,175 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:46,176 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:46,182 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:46,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:46,184 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:46,186 - sqlalchemy.engine.Engine - INFO - [cached since 56.37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:46,188 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:46,189 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:46,190 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:46,191 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:44:46,191 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:44:46,192 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:46,193 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:46,195 - sqlalchemy.engine.Engine - INFO - [cached since 56.34s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:44:46,197 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:44:46,199 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:46,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:46,201 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:46,202 - sqlalchemy.engine.Engine - INFO - [cached since 56.39s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:46,204 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:46,204 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:46,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:46,208 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-19 23:44:46,209 - sqlalchemy.engine.Engine - INFO - [cached since 56.17s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-19 23:44:46,234 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,235 - sqlalchemy.engine.Engine - INFO - [cached since 56.14s ago] {'pk_1': 16}
2025-10-19 23:44:46,237 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,237 - sqlalchemy.engine.Engine - INFO - [cached since 56.14s ago] {'pk_1': 9}
2025-10-19 23:44:46,240 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,241 - sqlalchemy.engine.Engine - INFO - [cached since 56.15s ago] {'pk_1': 15}
2025-10-19 23:44:46,243 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,244 - sqlalchemy.engine.Engine - INFO - [cached since 56.15s ago] {'pk_1': 13}
2025-10-19 23:44:46,246 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,246 - sqlalchemy.engine.Engine - INFO - [cached since 56.15s ago] {'pk_1': 14}
2025-10-19 23:44:46,249 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,249 - sqlalchemy.engine.Engine - INFO - [cached since 56.16s ago] {'pk_1': 18}
2025-10-19 23:44:46,251 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,251 - sqlalchemy.engine.Engine - INFO - [cached since 56.16s ago] {'pk_1': 21}
2025-10-19 23:44:46,254 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,256 - sqlalchemy.engine.Engine - INFO - [cached since 56.16s ago] {'pk_1': 19}
2025-10-19 23:44:46,258 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,259 - sqlalchemy.engine.Engine - INFO - [cached since 56.16s ago] {'pk_1': 22}
2025-10-19 23:44:46,261 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,261 - sqlalchemy.engine.Engine - INFO - [cached since 56.17s ago] {'pk_1': 7}
2025-10-19 23:44:46,264 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,264 - sqlalchemy.engine.Engine - INFO - [cached since 56.17s ago] {'pk_1': 5}
2025-10-19 23:44:46,266 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,268 - sqlalchemy.engine.Engine - INFO - [cached since 56.17s ago] {'pk_1': 6}
2025-10-19 23:44:46,270 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:44:46,270 - sqlalchemy.engine.Engine - INFO - [cached since 56.18s ago] {'pk_1': 8}
2025-10-19 23:44:46,279 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:46,282 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,322 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:49,322 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,324 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:49,325 - sqlalchemy.engine.Engine - INFO - [cached since 59.51s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:49,327 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:49,327 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,329 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:49,329 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:49,330 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,331 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:49,332 - sqlalchemy.engine.Engine - INFO - [cached since 59.52s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:49,336 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:49,336 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,339 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:49,350 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:49,353 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,354 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:49,356 - sqlalchemy.engine.Engine - INFO - [cached since 59.54s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:49,359 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:49,360 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,361 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:49,363 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:49,364 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,367 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:49,369 - sqlalchemy.engine.Engine - INFO - [cached since 59.56s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:49,374 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:49,374 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,378 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:49,387 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:49,389 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,390 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:49,391 - sqlalchemy.engine.Engine - INFO - [cached since 59.58s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:49,395 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:49,395 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,397 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:49,400 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:49,401 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,402 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:49,404 - sqlalchemy.engine.Engine - INFO - [cached since 59.59s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:49,410 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:49,410 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,413 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:44:49,417 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:44:49,417 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:44:49,420 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,422 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:49,424 - sqlalchemy.engine.Engine - INFO - [cached since 59.57s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:44:49,426 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:44:49,428 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:44:49,429 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:44:49,430 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,431 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:44:49,432 - sqlalchemy.engine.Engine - INFO - [cached since 59.58s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:44:49,435 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:44:49,438 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:49,439 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,440 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:49,441 - sqlalchemy.engine.Engine - INFO - [cached since 59.63s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:49,445 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:49,445 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,447 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:44:49,449 - sqlalchemy.engine.Engine - INFO - [cached since 6.098s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:44:49,469 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:44:49,472 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,473 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:44:49,474 - sqlalchemy.engine.Engine - INFO - [cached since 59.66s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:44:49,476 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:44:49,476 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:44:49,481 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:44:49,482 - sqlalchemy.engine.Engine - INFO - [cached since 59.19s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:44:49,492 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,495 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,499 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:44:49,501 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,146 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:05,148 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,148 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:05,150 - sqlalchemy.engine.Engine - INFO - [cached since 75.34s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:05,151 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:05,152 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,153 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:05,157 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:05,158 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,158 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:05,159 - sqlalchemy.engine.Engine - INFO - [cached since 75.35s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:05,161 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:05,161 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,163 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:05,169 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:05,170 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,171 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:05,172 - sqlalchemy.engine.Engine - INFO - [cached since 75.36s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:05,175 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:05,175 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,176 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:05,181 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:05,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,182 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:05,184 - sqlalchemy.engine.Engine - INFO - [cached since 75.37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:05,186 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:05,186 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,188 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:05,189 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:05,189 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:05,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,191 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:05,193 - sqlalchemy.engine.Engine - INFO - [cached since 75.34s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:05,194 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:05,196 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:05,196 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,197 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:05,199 - sqlalchemy.engine.Engine - INFO - [cached since 75.39s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:05,202 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:05,202 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,205 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,207 - sqlalchemy.engine.Engine - INFO - SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:05,207 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] {'id_1': 12, 'param_1': 1}
2025-10-19 23:45:05,211 - sqlalchemy.engine.Engine - INFO - INSERT INTO orders (table_id, customer_name, order_type, status, notes, total_amount, user_id, is_paid, payment_method, deleted_at, restaurant_id, created_at, updated_at) VALUES (%(table_id)s, %(customer_name)s, %(order_type)s, %(status)s, %(notes)s, %(total_amount)s, %(user_id)s, %(is_paid)s, %(payment_method)s, %(deleted_at)s, %(restaurant_id)s, %(created_at)s, %(updated_at)s)
2025-10-19 23:45:05,212 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] {'table_id': None, 'customer_name': 'Abner', 'order_type': 'delivery', 'status': 'PENDING', 'notes': None, 'total_amount': 0.0, 'user_id': None, 'is_paid': 0, 'payment_method': None, 'deleted_at': None, 'restaurant_id': 1, 'created_at': datetime.datetime(2025, 10, 20, 6, 45, 5, 209490, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 6, 45, 5, 209490, tzinfo=datetime.timezone.utc)}
2025-10-19 23:45:05,218 - sqlalchemy.engine.Engine - INFO - SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:05,219 - sqlalchemy.engine.Engine - INFO - [cached since 0.01225s ago] {'id_1': 12, 'param_1': 1}
2025-10-19 23:45:05,221 - sqlalchemy.engine.Engine - INFO - SELECT menu_item_variants.menu_item_id AS menu_item_variants_menu_item_id, menu_item_variants.name AS menu_item_variants_name, menu_item_variants.price AS menu_item_variants_price, menu_item_variants.discount_price AS menu_item_variants_discount_price, menu_item_variants.is_available AS menu_item_variants_is_available, menu_item_variants.id AS menu_item_variants_id, menu_item_variants.created_at AS menu_item_variants_created_at, menu_item_variants.updated_at AS menu_item_variants_updated_at, menu_item_variants.deleted_at AS menu_item_variants_deleted_at 
FROM menu_item_variants 
WHERE menu_item_variants.id = %(id_1)s AND menu_item_variants.menu_item_id = %(menu_item_id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:05,223 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] {'id_1': 68, 'menu_item_id_1': 12, 'param_1': 1}
2025-10-19 23:45:05,226 - sqlalchemy.engine.Engine - INFO - UPDATE orders SET total_amount=%(total_amount)s, updated_at=%(updated_at)s WHERE orders.id = %(orders_id)s
2025-10-19 23:45:05,228 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] {'total_amount': 200.0, 'updated_at': datetime.datetime(2025, 10, 20, 6, 45, 5, 224846, tzinfo=datetime.timezone.utc), 'orders_id': 59}
2025-10-19 23:45:05,232 - sqlalchemy.engine.Engine - INFO - INSERT INTO order_items (order_id, menu_item_id, variant_id, quantity, unit_price, special_instructions, status, deleted_at, created_at, updated_at) VALUES (%(order_id)s, %(menu_item_id)s, %(variant_id)s, %(quantity)s, %(unit_price)s, %(special_instructions)s, %(status)s, %(deleted_at)s, %(created_at)s, %(updated_at)s)
2025-10-19 23:45:05,234 - sqlalchemy.engine.Engine - INFO - [generated in 0.00163s] {'order_id': 59, 'menu_item_id': 12, 'variant_id': 68, 'quantity': 2, 'unit_price': 100.0, 'special_instructions': '', 'status': 'PENDING', 'deleted_at': None, 'created_at': datetime.datetime(2025, 10, 20, 6, 45, 5, 224846, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 6, 45, 5, 224846, tzinfo=datetime.timezone.utc)}
2025-10-19 23:45:05,237 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-19 23:45:05,242 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,257 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.id = %(id_1)s AND orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id
2025-10-19 23:45:05,258 - sqlalchemy.engine.Engine - INFO - [generated in 0.00148s] {'id_1': 59, 'restaurant_id_1': 1, 'param_1': 1}
2025-10-19 23:45:05,263 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,264 - sqlalchemy.engine.Engine - INFO - [generated in 0.00114s] {'pk_1': 9}
2025-10-19 23:45:05,269 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,271 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,297 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:05,299 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,299 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:05,300 - sqlalchemy.engine.Engine - INFO - [cached since 75.49s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:05,301 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:05,302 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,302 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:05,309 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:05,310 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,311 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:05,312 - sqlalchemy.engine.Engine - INFO - [cached since 75.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:05,314 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:05,314 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,317 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:05,317 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:05,317 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:05,319 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,320 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:05,321 - sqlalchemy.engine.Engine - INFO - [cached since 75.46s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:05,323 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:05,324 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:05,325 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,325 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:05,326 - sqlalchemy.engine.Engine - INFO - [cached since 75.51s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:05,328 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:05,328 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,332 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:05,332 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-19 23:45:05,335 - sqlalchemy.engine.Engine - INFO - [cached since 75.3s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-19 23:45:05,351 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,352 - sqlalchemy.engine.Engine - INFO - [cached since 75.26s ago] {'pk_1': 9}
2025-10-19 23:45:05,356 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,356 - sqlalchemy.engine.Engine - INFO - [cached since 75.26s ago] {'pk_1': 16}
2025-10-19 23:45:05,359 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,360 - sqlalchemy.engine.Engine - INFO - [cached since 75.27s ago] {'pk_1': 15}
2025-10-19 23:45:05,362 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,363 - sqlalchemy.engine.Engine - INFO - [cached since 75.27s ago] {'pk_1': 13}
2025-10-19 23:45:05,366 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,367 - sqlalchemy.engine.Engine - INFO - [cached since 75.27s ago] {'pk_1': 14}
2025-10-19 23:45:05,370 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,370 - sqlalchemy.engine.Engine - INFO - [cached since 75.28s ago] {'pk_1': 18}
2025-10-19 23:45:05,372 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,373 - sqlalchemy.engine.Engine - INFO - [cached since 75.28s ago] {'pk_1': 21}
2025-10-19 23:45:05,375 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,376 - sqlalchemy.engine.Engine - INFO - [cached since 75.28s ago] {'pk_1': 19}
2025-10-19 23:45:05,377 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,379 - sqlalchemy.engine.Engine - INFO - [cached since 75.29s ago] {'pk_1': 22}
2025-10-19 23:45:05,382 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,382 - sqlalchemy.engine.Engine - INFO - [cached since 75.29s ago] {'pk_1': 7}
2025-10-19 23:45:05,385 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,386 - sqlalchemy.engine.Engine - INFO - [cached since 75.29s ago] {'pk_1': 5}
2025-10-19 23:45:05,388 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,389 - sqlalchemy.engine.Engine - INFO - [cached since 75.3s ago] {'pk_1': 6}
2025-10-19 23:45:05,391 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:05,391 - sqlalchemy.engine.Engine - INFO - [cached since 75.3s ago] {'pk_1': 8}
2025-10-19 23:45:05,402 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:05,404 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:13,459 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:13,460 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:13,461 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:13,462 - sqlalchemy.engine.Engine - INFO - [cached since 83.65s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:13,464 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:13,464 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:13,466 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:13,468 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:13,468 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:13,469 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:13,470 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:13,471 - sqlalchemy.engine.Engine - INFO - [cached since 83.61s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:13,473 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:13,475 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:13,478 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:45:13,481 - sqlalchemy.engine.Engine - INFO - [cached since 82.73s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:45:13,490 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:13,493 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:15,849 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:15,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:15,851 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:15,852 - sqlalchemy.engine.Engine - INFO - [cached since 86.04s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:15,854 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:15,854 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:15,856 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:15,861 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:15,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:15,864 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:15,864 - sqlalchemy.engine.Engine - INFO - [cached since 86.05s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:15,867 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:15,867 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:15,869 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:15,871 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:15,871 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:15,872 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:15,874 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:15,875 - sqlalchemy.engine.Engine - INFO - [cached since 86.02s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:15,878 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:15,881 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:15,883 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:15,885 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:15,887 - sqlalchemy.engine.Engine - INFO - [cached since 86.07s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:15,890 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:15,890 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:15,894 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:15,896 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-19 23:45:15,899 - sqlalchemy.engine.Engine - INFO - [cached since 85.86s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-19 23:45:15,923 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,925 - sqlalchemy.engine.Engine - INFO - [cached since 85.83s ago] {'pk_1': 9}
2025-10-19 23:45:15,929 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,929 - sqlalchemy.engine.Engine - INFO - [cached since 85.84s ago] {'pk_1': 16}
2025-10-19 23:45:15,935 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,936 - sqlalchemy.engine.Engine - INFO - [cached since 85.84s ago] {'pk_1': 15}
2025-10-19 23:45:15,940 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,941 - sqlalchemy.engine.Engine - INFO - [cached since 85.85s ago] {'pk_1': 13}
2025-10-19 23:45:15,944 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,945 - sqlalchemy.engine.Engine - INFO - [cached since 85.85s ago] {'pk_1': 14}
2025-10-19 23:45:15,949 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,950 - sqlalchemy.engine.Engine - INFO - [cached since 85.86s ago] {'pk_1': 18}
2025-10-19 23:45:15,954 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,955 - sqlalchemy.engine.Engine - INFO - [cached since 85.86s ago] {'pk_1': 21}
2025-10-19 23:45:15,958 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,960 - sqlalchemy.engine.Engine - INFO - [cached since 85.87s ago] {'pk_1': 19}
2025-10-19 23:45:15,961 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,963 - sqlalchemy.engine.Engine - INFO - [cached since 85.87s ago] {'pk_1': 22}
2025-10-19 23:45:15,967 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,969 - sqlalchemy.engine.Engine - INFO - [cached since 85.87s ago] {'pk_1': 7}
2025-10-19 23:45:15,973 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,974 - sqlalchemy.engine.Engine - INFO - [cached since 85.88s ago] {'pk_1': 5}
2025-10-19 23:45:15,978 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,978 - sqlalchemy.engine.Engine - INFO - [cached since 85.89s ago] {'pk_1': 6}
2025-10-19 23:45:15,982 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:15,983 - sqlalchemy.engine.Engine - INFO - [cached since 85.89s ago] {'pk_1': 8}
2025-10-19 23:45:15,994 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:15,996 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:36,114 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:36,116 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:36,117 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:36,118 - sqlalchemy.engine.Engine - INFO - [cached since 106.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:36,119 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:36,120 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:36,121 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:36,126 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:36,128 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:36,129 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:36,130 - sqlalchemy.engine.Engine - INFO - [cached since 106.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:36,133 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:36,134 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:36,134 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:36,137 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:36,137 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:36,139 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:36,139 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:36,140 - sqlalchemy.engine.Engine - INFO - [cached since 106.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:36,141 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:36,142 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:36,142 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:36,144 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:36,145 - sqlalchemy.engine.Engine - INFO - [cached since 106.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:36,148 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:36,148 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:36,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:36,150 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:45:36,152 - sqlalchemy.engine.Engine - INFO - [cached since 52.8s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:45:36,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:36,250 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:39,763 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:39,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:39,765 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:39,766 - sqlalchemy.engine.Engine - INFO - [cached since 110s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:39,769 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:39,770 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:39,771 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:39,776 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:39,779 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:39,779 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:39,781 - sqlalchemy.engine.Engine - INFO - [cached since 110s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:39,784 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:39,784 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:39,785 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:39,788 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:39,788 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:39,788 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:39,789 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:39,791 - sqlalchemy.engine.Engine - INFO - [cached since 109.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:39,794 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:39,796 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:39,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:39,798 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:39,800 - sqlalchemy.engine.Engine - INFO - [cached since 110s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:39,804 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:39,806 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:39,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:39,814 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-19 23:45:39,818 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-19 23:45:39,849 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,850 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 9}
2025-10-19 23:45:39,854 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,856 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 16}
2025-10-19 23:45:39,859 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,861 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 15}
2025-10-19 23:45:39,865 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,866 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 13}
2025-10-19 23:45:39,871 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,872 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 14}
2025-10-19 23:45:39,877 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,877 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 18}
2025-10-19 23:45:39,880 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,882 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 21}
2025-10-19 23:45:39,885 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,887 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 19}
2025-10-19 23:45:39,891 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,892 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 22}
2025-10-19 23:45:39,895 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,896 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 7}
2025-10-19 23:45:39,899 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,901 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 5}
2025-10-19 23:45:39,904 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,906 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 6}
2025-10-19 23:45:39,910 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:45:39,910 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'pk_1': 8}
2025-10-19 23:45:39,930 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:39,934 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:40,383 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:40,384 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:40,385 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:40,387 - sqlalchemy.engine.Engine - INFO - [cached since 110.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:40,389 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:40,390 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:40,391 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:40,392 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:40,392 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:40,394 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:40,395 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:40,396 - sqlalchemy.engine.Engine - INFO - [cached since 110.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:40,397 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:40,400 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:40,402 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:45:40,405 - sqlalchemy.engine.Engine - INFO - [cached since 109.7s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:45:40,410 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:40,413 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:42,203 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:42,204 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:42,204 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:42,206 - sqlalchemy.engine.Engine - INFO - [cached since 112.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:42,208 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:42,208 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:42,209 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:42,213 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:42,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:42,217 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:42,229 - sqlalchemy.engine.Engine - INFO - [cached since 112.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:42,239 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:42,239 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:42,241 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:42,244 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:42,244 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:42,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:42,252 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:42,255 - sqlalchemy.engine.Engine - INFO - [cached since 112.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:42,261 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:42,271 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:42,275 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:45:42,276 - sqlalchemy.engine.Engine - INFO - [generated in 0.00173s] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-19 23:45:42,287 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:42,293 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:50,181 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:45:50,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:50,184 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:45:50,185 - sqlalchemy.engine.Engine - INFO - [cached since 120.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:45:50,187 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:45:50,187 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:50,189 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:45:50,193 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:45:50,194 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:45:50,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:50,199 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:45:50,201 - sqlalchemy.engine.Engine - INFO - [cached since 120.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:45:50,205 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:45:50,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:45:50,210 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:45:50,213 - sqlalchemy.engine.Engine - INFO - [cached since 7.938s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-19 23:45:50,222 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:45:50,226 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:40,281 - app.main - INFO - Shutting down background tasks...
2025-10-19 23:47:44,723 - app.main - INFO - ==================================================
2025-10-19 23:47:44,723 - app.main - INFO - Application starting - Logging initialized
2025-10-19 23:47:44,724 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-19 23:47:44,724 - app.main - INFO - ==================================================
2025-10-19 23:47:45,963 - app.main - INFO - Starting background tasks...
2025-10-19 23:47:47,952 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:48,051 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-19 23:47:48,052 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:47:48,054 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-19 23:47:48,056 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:47:48,057 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-19 23:47:48,058 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:47:48,059 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,066 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:48,067 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:48,072 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:48,072 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,074 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:48,077 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:48,078 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,079 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:48,080 - sqlalchemy.engine.Engine - INFO - [cached since 0.01389s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:48,085 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:48,085 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,086 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:48,087 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:48,087 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,088 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:48,089 - sqlalchemy.engine.Engine - INFO - [cached since 0.02288s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:48,091 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:48,091 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,093 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:48,094 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:47:48,099 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:47:48,100 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,103 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:47:48,105 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] {'id_1': 8, 'param_1': 1}
2025-10-19 23:47:48,108 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:47:48,121 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:47:48,122 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:47:48,128 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,129 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:47:48,130 - sqlalchemy.engine.Engine - INFO - [cached since 0.02648s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:47:48,134 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:47:48,136 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:48,152 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,154 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:48,155 - sqlalchemy.engine.Engine - INFO - [cached since 0.08846s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:48,158 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:48,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,162 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,162 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,164 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:48,166 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,167 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:48,167 - sqlalchemy.engine.Engine - INFO - [cached since 0.1015s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:48,169 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:48,170 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,171 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:48,173 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA2ODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.4O8ezcgsrBxyFhaYHj2JRQjWjiCFp-XMEW7OT7HNY7Q
2025-10-19 23:47:48,173 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990682, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:47:48,174 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,174 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:47:48,176 - sqlalchemy.engine.Engine - INFO - [cached since 0.07259s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:47:48,178 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:47:48,179 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:48,181 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,183 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:48,183 - sqlalchemy.engine.Engine - INFO - [cached since 0.1171s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:48,186 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:48,186 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,191 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:48,215 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-19 23:47:48,217 - sqlalchemy.engine.Engine - INFO - [generated in 0.00237s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-19 23:47:48,244 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,245 - sqlalchemy.engine.Engine - INFO - [generated in 0.00122s] {'pk_1': 9}
2025-10-19 23:47:48,247 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,249 - sqlalchemy.engine.Engine - INFO - [cached since 0.005354s ago] {'pk_1': 16}
2025-10-19 23:47:48,251 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,253 - sqlalchemy.engine.Engine - INFO - [cached since 0.00883s ago] {'pk_1': 15}
2025-10-19 23:47:48,256 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,257 - sqlalchemy.engine.Engine - INFO - [cached since 0.01333s ago] {'pk_1': 13}
2025-10-19 23:47:48,260 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,260 - sqlalchemy.engine.Engine - INFO - [cached since 0.01663s ago] {'pk_1': 14}
2025-10-19 23:47:48,263 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,264 - sqlalchemy.engine.Engine - INFO - [cached since 0.02021s ago] {'pk_1': 18}
2025-10-19 23:47:48,266 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,267 - sqlalchemy.engine.Engine - INFO - [cached since 0.02356s ago] {'pk_1': 21}
2025-10-19 23:47:48,270 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,270 - sqlalchemy.engine.Engine - INFO - [cached since 0.02704s ago] {'pk_1': 19}
2025-10-19 23:47:48,272 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,273 - sqlalchemy.engine.Engine - INFO - [cached since 0.03s ago] {'pk_1': 22}
2025-10-19 23:47:48,276 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,276 - sqlalchemy.engine.Engine - INFO - [cached since 0.03336s ago] {'pk_1': 7}
2025-10-19 23:47:48,280 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,280 - sqlalchemy.engine.Engine - INFO - [cached since 0.03695s ago] {'pk_1': 5}
2025-10-19 23:47:48,284 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,285 - sqlalchemy.engine.Engine - INFO - [cached since 0.04087s ago] {'pk_1': 6}
2025-10-19 23:47:48,287 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:47:48,288 - sqlalchemy.engine.Engine - INFO - [cached since 0.04439s ago] {'pk_1': 8}
2025-10-19 23:47:48,299 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:48,301 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:51,347 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:51,348 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:51,350 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:51,352 - sqlalchemy.engine.Engine - INFO - [cached since 3.286s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:51,356 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:51,356 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:51,357 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:51,358 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:47:51,358 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:47:51,358 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:47:51,359 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:47:51,359 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:47:51,359 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:47:51,359 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:47:51,359 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:47:51,359 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:47:51,360 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:47:51,360 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:47:51,360 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:47:51,360 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:47:51,360 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:47:51,363 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:47:51,363 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:47:51,364 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:51,369 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:47:51,369 - sqlalchemy.engine.Engine - INFO - [generated in 0.00110s] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:47:51,372 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-19 23:47:51,374 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-19 23:47:51,741 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:51,744 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:51,744 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:51,745 - sqlalchemy.engine.Engine - INFO - [cached since 3.679s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:51,747 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:51,747 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:51,752 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:51,758 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:51,759 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:51,761 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:51,762 - sqlalchemy.engine.Engine - INFO - [cached since 3.696s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:51,765 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:51,765 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:51,768 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:51,770 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:47:51,770 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:47:51,771 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:51,773 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:47:51,775 - sqlalchemy.engine.Engine - INFO - [cached since 3.671s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:47:51,777 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:47:51,780 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,290 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:52,292 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,296 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:52,303 - sqlalchemy.engine.Engine - INFO - [cached since 4.236s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:52,314 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:52,315 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,323 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:52,326 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:47:52,326 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:47:52,327 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,331 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:47:52,339 - sqlalchemy.engine.Engine - INFO - [cached since 4.236s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:47:52,347 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:47:52,348 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:52,349 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,356 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:52,362 - sqlalchemy.engine.Engine - INFO - [cached since 4.296s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:52,372 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:52,372 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,381 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:47:52,392 - sqlalchemy.engine.Engine - INFO - [generated in 0.01194s] {'restaurant_id_1': 1}
2025-10-19 23:47:52,413 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,420 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,427 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:52,428 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,432 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:52,438 - sqlalchemy.engine.Engine - INFO - [cached since 4.371s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:52,443 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:52,443 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,446 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:52,457 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:52,458 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,462 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:52,464 - sqlalchemy.engine.Engine - INFO - [cached since 4.397s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:52,469 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:52,469 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,479 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:52,482 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:47:52,483 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:47:52,484 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,487 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:47:52,488 - sqlalchemy.engine.Engine - INFO - [cached since 4.385s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:47:52,491 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:47:52,493 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:52,493 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,496 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:52,499 - sqlalchemy.engine.Engine - INFO - [cached since 4.432s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:52,502 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:52,503 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,507 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:52,521 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:47:52,523 - sqlalchemy.engine.Engine - INFO - [generated in 0.00196s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:47:52,551 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:52,554 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:55,867 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:47:55,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:55,869 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:47:55,870 - sqlalchemy.engine.Engine - INFO - [cached since 7.804s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:47:55,872 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:47:55,873 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:55,874 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:47:55,876 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:47:55,876 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:47:55,877 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:55,878 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:47:55,879 - sqlalchemy.engine.Engine - INFO - [cached since 7.775s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:47:55,880 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:47:55,882 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:47:55,898 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:47:55,900 - sqlalchemy.engine.Engine - INFO - [generated in 0.00235s] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:47:55,910 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:47:55,912 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,374 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:00,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,376 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:00,377 - sqlalchemy.engine.Engine - INFO - [cached since 12.31s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:00,379 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:00,380 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,381 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:00,387 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:00,389 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,390 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:00,392 - sqlalchemy.engine.Engine - INFO - [cached since 12.33s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:00,395 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:00,395 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,397 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:00,400 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:48:00,401 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:48:00,403 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,403 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:00,404 - sqlalchemy.engine.Engine - INFO - [cached since 12.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:48:00,407 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:48:00,409 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,411 - sqlalchemy.engine.Engine - INFO - INSERT INTO cash_register_sessions (opened_at, closed_at, opened_by_user_id, cashier_id, initial_balance, final_balance, expected_balance, actual_balance, status, notes, created_at, updated_at, deleted_at) VALUES (%(opened_at)s, %(closed_at)s, %(opened_by_user_id)s, %(cashier_id)s, %(initial_balance)s, %(final_balance)s, %(expected_balance)s, %(actual_balance)s, %(status)s, %(notes)s, %(created_at)s, %(updated_at)s, %(deleted_at)s)
2025-10-19 23:48:00,412 - sqlalchemy.engine.Engine - INFO - [generated in 0.00105s] {'opened_at': datetime.datetime(2025, 10, 20, 6, 48, 0, 407836, tzinfo=datetime.timezone.utc), 'closed_at': None, 'opened_by_user_id': 8, 'cashier_id': 8, 'initial_balance': 400.0, 'final_balance': None, 'expected_balance': 0.0, 'actual_balance': None, 'status': 'OPEN', 'notes': None, 'created_at': datetime.datetime(2025, 10, 20, 6, 48, 0, 411848, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 6, 48, 0, 411848, tzinfo=datetime.timezone.utc), 'deleted_at': None}
2025-10-19 23:48:00,419 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-19 23:48:00,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,427 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at, cash_register_sessions.closed_at, cash_register_sessions.opened_by_user_id, cash_register_sessions.cashier_id, cash_register_sessions.initial_balance, cash_register_sessions.final_balance, cash_register_sessions.expected_balance, cash_register_sessions.actual_balance, cash_register_sessions.status, cash_register_sessions.notes, cash_register_sessions.id, cash_register_sessions.created_at, cash_register_sessions.updated_at, cash_register_sessions.deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.id = %(pk_1)s
2025-10-19 23:48:00,428 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] {'pk_1': 11}
2025-10-19 23:48:00,430 - app.services.cash_register - INFO - Created cash register session 11
2025-10-19 23:48:00,435 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE %(param_1)s = cash_transactions.session_id
2025-10-19 23:48:00,436 - sqlalchemy.engine.Engine - INFO - [generated in 0.00141s] {'param_1': 11}
2025-10-19 23:48:00,441 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_reports.session_id AS cash_register_reports_session_id, cash_register_reports.report_type AS cash_register_reports_report_type, cash_register_reports.data AS cash_register_reports_data, cash_register_reports.generated_at AS cash_register_reports_generated_at, cash_register_reports.id AS cash_register_reports_id, cash_register_reports.created_at AS cash_register_reports_created_at, cash_register_reports.updated_at AS cash_register_reports_updated_at, cash_register_reports.deleted_at AS cash_register_reports_deleted_at 
FROM cash_register_reports 
WHERE %(param_1)s = cash_register_reports.session_id
2025-10-19 23:48:00,441 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] {'param_1': 11}
2025-10-19 23:48:00,447 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s
2025-10-19 23:48:00,447 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] {'pk_1': 8}
2025-10-19 23:48:00,453 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,454 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,476 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:00,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,478 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:00,479 - sqlalchemy.engine.Engine - INFO - [cached since 12.41s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:00,481 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:00,482 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,482 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:00,484 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:00,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,486 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:00,489 - sqlalchemy.engine.Engine - INFO - [cached since 12.42s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:00,491 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:00,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,492 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:00,498 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:48:00,498 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:48:00,499 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,501 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:00,502 - sqlalchemy.engine.Engine - INFO - [cached since 12.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:48:00,505 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:48:00,507 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:00,508 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,510 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,512 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:48:00,512 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:00,513 - sqlalchemy.engine.Engine - INFO - [cached since 4.615s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:48:00,514 - sqlalchemy.engine.Engine - INFO - [cached since 12.45s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:00,519 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:00,519 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,522 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:00,527 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:48:00,527 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:48:00,528 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,529 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:00,529 - sqlalchemy.engine.Engine - INFO - [cached since 12.43s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:48:00,531 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:48:00,534 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,539 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,542 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:00,542 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,543 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,544 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:00,545 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:48:00,546 - sqlalchemy.engine.Engine - INFO - [cached since 12.48s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:00,546 - sqlalchemy.engine.Engine - INFO - [generated in 0.00132s] {'session_id_1': 11, 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:00,548 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:00,549 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,551 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:00,556 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:00,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,556 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,558 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:00,559 - sqlalchemy.engine.Engine - INFO - [cached since 12.49s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:00,560 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:00,561 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,563 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:00,563 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,564 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:48:00,566 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:48:00,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,567 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:00,568 - sqlalchemy.engine.Engine - INFO - [cached since 12.47s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:48:00,571 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:48:00,574 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:00,574 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,576 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_reports.session_id AS cash_register_reports_session_id, cash_register_reports.report_type AS cash_register_reports_report_type, cash_register_reports.data AS cash_register_reports_data, cash_register_reports.generated_at AS cash_register_reports_generated_at, cash_register_reports.id AS cash_register_reports_id, cash_register_reports.created_at AS cash_register_reports_created_at, cash_register_reports.updated_at AS cash_register_reports_updated_at, cash_register_reports.deleted_at AS cash_register_reports_deleted_at 
FROM cash_register_reports 
WHERE cash_register_reports.session_id = %(session_id_1)s AND cash_register_reports.report_type = %(report_type_1)s ORDER BY cash_register_reports.generated_at DESC 
 LIMIT %(param_1)s
2025-10-19 23:48:00,576 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,576 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] {'session_id_1': 11, 'report_type_1': 'daily_summary', 'param_1': 1}
2025-10-19 23:48:00,578 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:00,579 - sqlalchemy.engine.Engine - INFO - [cached since 12.51s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:00,581 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:00,581 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,583 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:00,586 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:48:00,587 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:48:00,588 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,589 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:00,590 - sqlalchemy.engine.Engine - INFO - [cached since 12.49s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:48:00,595 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:48:00,599 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,599 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:00,601 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:48:00,602 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,602 - sqlalchemy.engine.Engine - INFO - [cached since 0.05793s ago] {'session_id_1': 11, 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:00,608 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:00,610 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:09,922 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:09,923 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:09,924 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:09,925 - sqlalchemy.engine.Engine - INFO - [cached since 21.86s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:09,927 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:09,928 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:09,928 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:09,933 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:09,934 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:09,935 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:09,936 - sqlalchemy.engine.Engine - INFO - [cached since 21.87s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:09,938 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:09,938 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:09,940 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:09,942 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:48:09,943 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:48:09,943 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:09,946 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:09,947 - sqlalchemy.engine.Engine - INFO - [cached since 21.84s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:48:09,950 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:48:09,952 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:09,963 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.id = %(id_1)s 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id
2025-10-19 23:48:09,964 - sqlalchemy.engine.Engine - INFO - [generated in 0.00163s] {'id_1': 11, 'param_1': 1}
2025-10-19 23:48:09,970 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:48:09,971 - sqlalchemy.engine.Engine - INFO - [generated in 0.00130s] {'session_id_1': 11}
2025-10-19 23:48:09,977 - sqlalchemy.engine.Engine - INFO - UPDATE cash_register_sessions SET closed_at=%(closed_at)s, final_balance=%(final_balance)s, expected_balance=%(expected_balance)s, actual_balance=%(actual_balance)s, status=%(status)s, notes=%(notes)s, updated_at=%(updated_at)s WHERE cash_register_sessions.id = %(cash_register_sessions_id)s
2025-10-19 23:48:09,977 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] {'closed_at': datetime.datetime(2025, 10, 20, 6, 48, 9, 975871, tzinfo=datetime.timezone.utc), 'final_balance': 200.0, 'expected_balance': Decimal('400.00'), 'actual_balance': 200.0, 'status': 'CLOSED', 'notes': 'Session closed by cashier', 'updated_at': datetime.datetime(2025, 10, 20, 6, 48, 9, 977957, tzinfo=datetime.timezone.utc), 'cash_register_sessions_id': 11}
2025-10-19 23:48:09,982 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-19 23:48:09,988 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:09,995 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at, cash_register_sessions.closed_at, cash_register_sessions.opened_by_user_id, cash_register_sessions.cashier_id, cash_register_sessions.initial_balance, cash_register_sessions.final_balance, cash_register_sessions.expected_balance, cash_register_sessions.actual_balance, cash_register_sessions.status, cash_register_sessions.notes, cash_register_sessions.id, cash_register_sessions.created_at, cash_register_sessions.updated_at, cash_register_sessions.deleted_at, users_1.email, users_1.hashed_password, users_1.full_name, users_1.`role`, users_1.staff_type, users_1.is_active, users_1.restaurant_id, users_1.id AS id_1, users_1.created_at AS created_at_1, users_1.updated_at AS updated_at_1, users_1.deleted_at AS deleted_at_1, cash_transactions_1.session_id, cash_transactions_1.transaction_type, cash_transactions_1.amount, cash_transactions_1.description, cash_transactions_1.order_id, cash_transactions_1.created_by_user_id, cash_transactions_1.payment_method, cash_transactions_1.category, cash_transactions_1.id AS id_2, cash_transactions_1.created_at AS created_at_2, cash_transactions_1.updated_at AS updated_at_2, cash_transactions_1.deleted_at AS deleted_at_2, cash_register_reports_1.session_id AS session_id_1, cash_register_reports_1.report_type, cash_register_reports_1.data, cash_register_reports_1.generated_at, cash_register_reports_1.id AS id_3, cash_register_reports_1.created_at AS created_at_3, cash_register_reports_1.updated_at AS updated_at_3, cash_register_reports_1.deleted_at AS deleted_at_3 
FROM cash_register_sessions LEFT OUTER JOIN users AS users_1 ON users_1.id = cash_register_sessions.opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON cash_register_sessions.id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON cash_register_sessions.id = cash_register_reports_1.session_id 
WHERE cash_register_sessions.id = %(pk_1)s
2025-10-19 23:48:09,996 - sqlalchemy.engine.Engine - INFO - [generated in 0.00121s] {'pk_1': 11}
2025-10-19 23:48:10,001 - app.services.cash_register - INFO - Closed cash register session 11
2025-10-19 23:48:10,006 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:10,008 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:10,015 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:10,016 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:10,018 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:10,021 - sqlalchemy.engine.Engine - INFO - [cached since 21.95s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:10,023 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:10,024 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:10,025 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:10,026 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:48:10,027 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:48:10,028 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:10,029 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:10,030 - sqlalchemy.engine.Engine - INFO - [cached since 21.93s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:48:10,031 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:48:10,033 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:10,034 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:48:10,036 - sqlalchemy.engine.Engine - INFO - [cached since 14.14s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:48:10,048 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:10,051 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:11,377 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:11,378 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:11,378 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:11,380 - sqlalchemy.engine.Engine - INFO - [cached since 23.31s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:11,384 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:11,385 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:11,388 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:11,390 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4NzEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.c2Sts836b9sWOHBT6UT83L3dYsr_kuV8VrcOnQK1EN4
2025-10-19 23:48:11,390 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990871, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:48:11,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:11,393 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:11,393 - sqlalchemy.engine.Engine - INFO - [cached since 23.29s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:48:11,396 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:48:11,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:11,407 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:48:11,408 - sqlalchemy.engine.Engine - INFO - [generated in 0.00125s] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:11,411 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:48:11,412 - sqlalchemy.engine.Engine - INFO - [cached since 1.442s ago] {'session_id_1': 11}
2025-10-19 23:48:11,417 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:11,419 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,104 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:19,105 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,106 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:19,107 - sqlalchemy.engine.Engine - INFO - [cached since 31.04s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:19,110 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:19,110 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,112 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:19,114 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:48:19,114 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:48:19,114 - multipart.multipart - DEBUG - Calling on_field_data with data[9:31]
2025-10-19 23:48:19,114 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:48:19,114 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:48:19,114 - multipart.multipart - DEBUG - Calling on_field_name with data[32:40]
2025-10-19 23:48:19,114 - multipart.multipart - DEBUG - Calling on_field_data with data[41:49]
2025-10-19 23:48:19,115 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:48:19,115 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:48:19,115 - multipart.multipart - DEBUG - Calling on_field_name with data[50:60]
2025-10-19 23:48:19,115 - multipart.multipart - DEBUG - Calling on_field_data with data[61:69]
2025-10-19 23:48:19,115 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:48:19,116 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:48:19,116 - multipart.multipart - DEBUG - Calling on_field_name with data[70:75]
2025-10-19 23:48:19,116 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:48:19,117 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:48:19,119 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,120 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:19,121 - sqlalchemy.engine.Engine - INFO - [cached since 27.75s ago] {'email_1': 'admin@coffeeshop.com', 'param_1': 1}
2025-10-19 23:48:19,444 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:19,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,447 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:19,448 - sqlalchemy.engine.Engine - INFO - [cached since 31.38s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:19,450 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:19,451 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,455 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,459 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:19,461 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,461 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:19,462 - sqlalchemy.engine.Engine - INFO - [cached since 31.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:19,463 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:19,463 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,465 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:19,470 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:19,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,473 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:19,474 - sqlalchemy.engine.Engine - INFO - [cached since 31.41s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:19,476 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:19,476 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,478 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:19,479 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:19,479 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:19,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,482 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:19,483 - sqlalchemy.engine.Engine - INFO - [cached since 31.38s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:19,487 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:19,497 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,531 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:19,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,538 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:19,542 - sqlalchemy.engine.Engine - INFO - [cached since 31.48s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:19,547 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:19,547 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,552 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:19,563 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:19,564 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,569 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:19,574 - sqlalchemy.engine.Engine - INFO - [cached since 31.51s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:19,579 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:19,580 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,585 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:19,586 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:19,586 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:19,589 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,591 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:19,594 - sqlalchemy.engine.Engine - INFO - [cached since 31.49s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:19,596 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:19,598 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:19,599 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,600 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:19,601 - sqlalchemy.engine.Engine - INFO - [cached since 31.53s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:19,603 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:19,604 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,606 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:19,607 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:48:19,609 - sqlalchemy.engine.Engine - INFO - [cached since 27.09s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:19,639 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:19,642 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,313 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:23,314 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,315 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:23,316 - sqlalchemy.engine.Engine - INFO - [cached since 35.25s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:23,318 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:23,318 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,320 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:23,321 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:23,322 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:23,322 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,324 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:23,324 - sqlalchemy.engine.Engine - INFO - [cached since 35.22s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:23,326 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:23,328 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,330 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:48:23,330 - sqlalchemy.engine.Engine - INFO - [cached since 27.43s ago] {'opened_by_user_id_1': 3, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:48:23,351 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,354 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,359 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:23,361 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,361 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:23,363 - sqlalchemy.engine.Engine - INFO - [cached since 35.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:23,366 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:23,366 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,368 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:23,369 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:23,370 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,371 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:23,372 - sqlalchemy.engine.Engine - INFO - [cached since 35.31s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:23,374 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:23,374 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,377 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:23,379 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:23,380 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:23,381 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,382 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:23,383 - sqlalchemy.engine.Engine - INFO - [cached since 35.28s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:23,384 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:23,385 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:23,386 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:23,387 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,388 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:23,389 - sqlalchemy.engine.Engine - INFO - [cached since 35.29s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:23,392 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:23,394 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,395 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:23,395 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:48:23,396 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_reports.session_id AS cash_register_reports_session_id, cash_register_reports.report_type AS cash_register_reports_report_type, cash_register_reports.data AS cash_register_reports_data, cash_register_reports.generated_at AS cash_register_reports_generated_at, cash_register_reports.id AS cash_register_reports_id, cash_register_reports.created_at AS cash_register_reports_created_at, cash_register_reports.updated_at AS cash_register_reports_updated_at, cash_register_reports.deleted_at AS cash_register_reports_deleted_at 
FROM cash_register_reports 
WHERE cash_register_reports.session_id = %(session_id_1)s AND cash_register_reports.report_type = %(report_type_1)s ORDER BY cash_register_reports.generated_at DESC 
 LIMIT %(param_1)s
2025-10-19 23:48:23,397 - sqlalchemy.engine.Engine - INFO - [cached since 22.85s ago] {'session_id_1': 10, 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:23,398 - sqlalchemy.engine.Engine - INFO - [cached since 22.82s ago] {'session_id_1': 10, 'report_type_1': 'daily_summary', 'param_1': 1}
2025-10-19 23:48:23,409 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,409 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,411 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:23,411 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:30,508 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:30,510 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:30,511 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:30,513 - sqlalchemy.engine.Engine - INFO - [cached since 42.45s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:30,516 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:30,516 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:30,519 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:30,522 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:30,522 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:30,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:30,524 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:30,525 - sqlalchemy.engine.Engine - INFO - [cached since 42.42s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:30,528 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:30,530 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:30,531 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:48:30,533 - sqlalchemy.engine.Engine - INFO - [cached since 19.13s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:30,537 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:48:30,538 - sqlalchemy.engine.Engine - INFO - [cached since 20.57s ago] {'session_id_1': 11}
2025-10-19 23:48:30,542 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:30,546 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:47,219 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:47,221 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:47,222 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:47,223 - sqlalchemy.engine.Engine - INFO - [cached since 59.16s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:47,225 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:47,225 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:47,226 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:47,229 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:47,231 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:47,232 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:47,234 - sqlalchemy.engine.Engine - INFO - [cached since 59.17s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:47,237 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:47,237 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:47,239 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:47,242 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:47,242 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:47,244 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:47,245 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:47,245 - sqlalchemy.engine.Engine - INFO - [cached since 59.14s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:47,248 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:47,251 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:47,252 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.id = %(id_1)s 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id
2025-10-19 23:48:47,253 - sqlalchemy.engine.Engine - INFO - [cached since 37.29s ago] {'id_1': 10, 'param_1': 1}
2025-10-19 23:48:47,269 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:48:47,271 - sqlalchemy.engine.Engine - INFO - [cached since 37.3s ago] {'session_id_1': 10}
2025-10-19 23:48:47,275 - sqlalchemy.engine.Engine - INFO - UPDATE cash_register_sessions SET closed_at=%(closed_at)s, final_balance=%(final_balance)s, expected_balance=%(expected_balance)s, actual_balance=%(actual_balance)s, status=%(status)s, notes=%(notes)s, updated_at=%(updated_at)s WHERE cash_register_sessions.id = %(cash_register_sessions_id)s
2025-10-19 23:48:47,276 - sqlalchemy.engine.Engine - INFO - [cached since 37.3s ago] {'closed_at': datetime.datetime(2025, 10, 20, 6, 48, 47, 274479, tzinfo=datetime.timezone.utc), 'final_balance': 400.0, 'expected_balance': Decimal('1303.00'), 'actual_balance': 400.0, 'status': 'CLOSED', 'notes': 'Session closed by Admin User', 'updated_at': datetime.datetime(2025, 10, 20, 6, 48, 47, 275097, tzinfo=datetime.timezone.utc), 'cash_register_sessions_id': 10}
2025-10-19 23:48:47,280 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-19 23:48:47,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:47,286 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at, cash_register_sessions.closed_at, cash_register_sessions.opened_by_user_id, cash_register_sessions.cashier_id, cash_register_sessions.initial_balance, cash_register_sessions.final_balance, cash_register_sessions.expected_balance, cash_register_sessions.actual_balance, cash_register_sessions.status, cash_register_sessions.notes, cash_register_sessions.id, cash_register_sessions.created_at, cash_register_sessions.updated_at, cash_register_sessions.deleted_at, users_1.email, users_1.hashed_password, users_1.full_name, users_1.`role`, users_1.staff_type, users_1.is_active, users_1.restaurant_id, users_1.id AS id_1, users_1.created_at AS created_at_1, users_1.updated_at AS updated_at_1, users_1.deleted_at AS deleted_at_1, cash_transactions_1.session_id, cash_transactions_1.transaction_type, cash_transactions_1.amount, cash_transactions_1.description, cash_transactions_1.order_id, cash_transactions_1.created_by_user_id, cash_transactions_1.payment_method, cash_transactions_1.category, cash_transactions_1.id AS id_2, cash_transactions_1.created_at AS created_at_2, cash_transactions_1.updated_at AS updated_at_2, cash_transactions_1.deleted_at AS deleted_at_2, cash_register_reports_1.session_id AS session_id_1, cash_register_reports_1.report_type, cash_register_reports_1.data, cash_register_reports_1.generated_at, cash_register_reports_1.id AS id_3, cash_register_reports_1.created_at AS created_at_3, cash_register_reports_1.updated_at AS updated_at_3, cash_register_reports_1.deleted_at AS deleted_at_3 
FROM cash_register_sessions LEFT OUTER JOIN users AS users_1 ON users_1.id = cash_register_sessions.opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON cash_register_sessions.id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON cash_register_sessions.id = cash_register_reports_1.session_id 
WHERE cash_register_sessions.id = %(pk_1)s
2025-10-19 23:48:47,287 - sqlalchemy.engine.Engine - INFO - [cached since 37.29s ago] {'pk_1': 10}
2025-10-19 23:48:47,303 - app.services.cash_register - INFO - Closed cash register session 10
2025-10-19 23:48:47,308 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:47,311 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:47,320 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:47,321 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:47,321 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:47,322 - sqlalchemy.engine.Engine - INFO - [cached since 59.26s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:47,324 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:47,324 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:47,326 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:47,327 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:47,328 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:47,329 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:47,330 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:47,331 - sqlalchemy.engine.Engine - INFO - [cached since 59.23s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:47,332 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:47,335 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:47,337 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:48:47,339 - sqlalchemy.engine.Engine - INFO - [cached since 51.44s ago] {'opened_by_user_id_1': 3, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:48:47,345 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:47,348 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,409 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:50,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,411 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:50,412 - sqlalchemy.engine.Engine - INFO - [cached since 62.35s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:50,414 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:50,415 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,415 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:50,416 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:50,418 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:50,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,420 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:50,421 - sqlalchemy.engine.Engine - INFO - [cached since 62.32s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:50,422 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:50,426 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,429 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:50,430 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,431 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:50,431 - sqlalchemy.engine.Engine - INFO - [cached since 62.36s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:50,432 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:50,434 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,435 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:50,440 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:50,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,442 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:50,443 - sqlalchemy.engine.Engine - INFO - [cached since 62.38s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:50,445 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:50,445 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,447 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:50,448 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:50,449 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:50,449 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,450 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:50,452 - sqlalchemy.engine.Engine - INFO - [cached since 62.35s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:50,454 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:50,454 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:50,455 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,456 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:50,456 - sqlalchemy.engine.Engine - INFO - [cached since 62.39s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:50,459 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:50,459 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,463 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,467 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:48:50,468 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:48:50,472 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-19 23:48:50,473 - sqlalchemy.engine.Engine - INFO - [cached since 0.006499s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-19 23:48:50,479 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-19 23:48:50,480 - sqlalchemy.engine.Engine - INFO - [generated in 0.00133s] {'pk_1': 4}
2025-10-19 23:48:50,487 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-19 23:48:50,487 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] {'param_1': 12}
2025-10-19 23:48:50,495 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:48:50,496 - sqlalchemy.engine.Engine - INFO - [generated in 0.00144s] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-19 23:48:50,500 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:48:50,501 - sqlalchemy.engine.Engine - INFO - [cached since 0.005847s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-19 23:48:50,504 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:48:50,505 - sqlalchemy.engine.Engine - INFO - [cached since 0.009866s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-19 23:48:50,507 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:48:50,507 - sqlalchemy.engine.Engine - INFO - [cached since 0.0125s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-19 23:48:50,509 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-19 23:48:50,510 - sqlalchemy.engine.Engine - INFO - [cached since 0.01541s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-19 23:48:50,515 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-19 23:48:50,516 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] {'restaurant_id_1': 1}
2025-10-19 23:48:50,523 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-19 23:48:50,524 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] {'restaurant_id_1': 1}
2025-10-19 23:48:50,529 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-19 23:48:50,529 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] {'restaurant_id_1': 1}
2025-10-19 23:48:50,534 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,536 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,539 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:50,540 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,541 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:50,542 - sqlalchemy.engine.Engine - INFO - [cached since 62.48s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:50,544 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:50,545 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,546 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:50,549 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:50,550 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:50,551 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,552 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:50,552 - sqlalchemy.engine.Engine - INFO - [cached since 62.45s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:50,554 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:50,556 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:50,556 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:48:50,557 - sqlalchemy.engine.Engine - INFO - [cached since 54.66s ago] {'opened_by_user_id_1': 3, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:48:50,563 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:50,566 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:51,659 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:51,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:51,661 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:51,663 - sqlalchemy.engine.Engine - INFO - [cached since 63.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:51,665 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:51,666 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:51,667 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:51,670 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:51,670 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:51,672 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:51,673 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:51,675 - sqlalchemy.engine.Engine - INFO - [cached since 63.57s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:51,677 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:51,680 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:51,681 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:48:51,682 - sqlalchemy.engine.Engine - INFO - [cached since 40.28s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:51,686 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:48:51,690 - sqlalchemy.engine.Engine - INFO - [cached since 41.72s ago] {'session_id_1': 10}
2025-10-19 23:48:51,693 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:48:51,694 - sqlalchemy.engine.Engine - INFO - [cached since 41.72s ago] {'session_id_1': 11}
2025-10-19 23:48:51,700 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:51,705 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,530 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:59,531 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,532 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:59,534 - sqlalchemy.engine.Engine - INFO - [cached since 71.47s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:59,537 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:59,537 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,538 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:59,542 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:59,543 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:59,544 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,545 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:59,547 - sqlalchemy.engine.Engine - INFO - [cached since 71.44s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:59,550 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:59,552 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,554 - sqlalchemy.engine.Engine - INFO - INSERT INTO cash_register_sessions (opened_at, closed_at, opened_by_user_id, cashier_id, initial_balance, final_balance, expected_balance, actual_balance, status, notes, created_at, updated_at, deleted_at) VALUES (%(opened_at)s, %(closed_at)s, %(opened_by_user_id)s, %(cashier_id)s, %(initial_balance)s, %(final_balance)s, %(expected_balance)s, %(actual_balance)s, %(status)s, %(notes)s, %(created_at)s, %(updated_at)s, %(deleted_at)s)
2025-10-19 23:48:59,554 - sqlalchemy.engine.Engine - INFO - [cached since 59.14s ago] {'opened_at': datetime.datetime(2025, 10, 20, 6, 48, 59, 551161, tzinfo=datetime.timezone.utc), 'closed_at': None, 'opened_by_user_id': 3, 'cashier_id': 3, 'initial_balance': 500.0, 'final_balance': None, 'expected_balance': 0.0, 'actual_balance': None, 'status': 'OPEN', 'notes': None, 'created_at': datetime.datetime(2025, 10, 20, 6, 48, 59, 553710, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 6, 48, 59, 553710, tzinfo=datetime.timezone.utc), 'deleted_at': None}
2025-10-19 23:48:59,558 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-19 23:48:59,563 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,563 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at, cash_register_sessions.closed_at, cash_register_sessions.opened_by_user_id, cash_register_sessions.cashier_id, cash_register_sessions.initial_balance, cash_register_sessions.final_balance, cash_register_sessions.expected_balance, cash_register_sessions.actual_balance, cash_register_sessions.status, cash_register_sessions.notes, cash_register_sessions.id, cash_register_sessions.created_at, cash_register_sessions.updated_at, cash_register_sessions.deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.id = %(pk_1)s
2025-10-19 23:48:59,565 - sqlalchemy.engine.Engine - INFO - [cached since 59.14s ago] {'pk_1': 12}
2025-10-19 23:48:59,567 - app.services.cash_register - INFO - Created cash register session 12
2025-10-19 23:48:59,569 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE %(param_1)s = cash_transactions.session_id
2025-10-19 23:48:59,570 - sqlalchemy.engine.Engine - INFO - [cached since 59.14s ago] {'param_1': 12}
2025-10-19 23:48:59,572 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_reports.session_id AS cash_register_reports_session_id, cash_register_reports.report_type AS cash_register_reports_report_type, cash_register_reports.data AS cash_register_reports_data, cash_register_reports.generated_at AS cash_register_reports_generated_at, cash_register_reports.id AS cash_register_reports_id, cash_register_reports.created_at AS cash_register_reports_created_at, cash_register_reports.updated_at AS cash_register_reports_updated_at, cash_register_reports.deleted_at AS cash_register_reports_deleted_at 
FROM cash_register_reports 
WHERE %(param_1)s = cash_register_reports.session_id
2025-10-19 23:48:59,574 - sqlalchemy.engine.Engine - INFO - [cached since 59.13s ago] {'param_1': 12}
2025-10-19 23:48:59,577 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s
2025-10-19 23:48:59,577 - sqlalchemy.engine.Engine - INFO - [cached since 59.13s ago] {'pk_1': 3}
2025-10-19 23:48:59,582 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,586 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,598 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:59,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,600 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:59,602 - sqlalchemy.engine.Engine - INFO - [cached since 71.54s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:59,607 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:59,608 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,610 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:59,611 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:59,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,614 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:59,615 - sqlalchemy.engine.Engine - INFO - [cached since 71.55s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:59,618 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:59,619 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,621 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:59,626 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:59,626 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:59,628 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,629 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:59,630 - sqlalchemy.engine.Engine - INFO - [cached since 71.53s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:59,634 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:59,635 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:59,638 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,640 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:59,642 - sqlalchemy.engine.Engine - INFO - [cached since 71.58s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:59,645 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:59,645 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,647 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:59,651 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,654 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:59,654 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:59,654 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:48:59,656 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,656 - sqlalchemy.engine.Engine - INFO - [cached since 63.76s ago] {'opened_by_user_id_1': 3, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:48:59,657 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:59,658 - sqlalchemy.engine.Engine - INFO - [cached since 71.55s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:59,659 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:59,663 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,665 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,666 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:48:59,669 - sqlalchemy.engine.Engine - INFO - [cached since 59.12s ago] {'session_id_1': 12, 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:59,671 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,678 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:59,679 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,680 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:59,681 - sqlalchemy.engine.Engine - INFO - [cached since 71.61s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:59,684 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:59,684 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,685 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:59,690 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,694 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:59,695 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,695 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:59,697 - sqlalchemy.engine.Engine - INFO - [cached since 71.63s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:59,699 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:59,699 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,700 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:59,703 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:59,702 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,703 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:59,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,705 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:59,706 - sqlalchemy.engine.Engine - INFO - [cached since 71.6s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:59,707 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:59,710 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:48:59,710 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,711 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,711 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_reports.session_id AS cash_register_reports_session_id, cash_register_reports.report_type AS cash_register_reports_report_type, cash_register_reports.data AS cash_register_reports_data, cash_register_reports.generated_at AS cash_register_reports_generated_at, cash_register_reports.id AS cash_register_reports_id, cash_register_reports.created_at AS cash_register_reports_created_at, cash_register_reports.updated_at AS cash_register_reports_updated_at, cash_register_reports.deleted_at AS cash_register_reports_deleted_at 
FROM cash_register_reports 
WHERE cash_register_reports.session_id = %(session_id_1)s AND cash_register_reports.report_type = %(report_type_1)s ORDER BY cash_register_reports.generated_at DESC 
 LIMIT %(param_1)s
2025-10-19 23:48:59,713 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:48:59,713 - sqlalchemy.engine.Engine - INFO - [cached since 59.14s ago] {'session_id_1': 12, 'report_type_1': 'daily_summary', 'param_1': 1}
2025-10-19 23:48:59,714 - sqlalchemy.engine.Engine - INFO - [cached since 71.65s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:48:59,717 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:48:59,718 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,720 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:48:59,724 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:48:59,724 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:48:59,725 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,726 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:48:59,727 - sqlalchemy.engine.Engine - INFO - [cached since 71.62s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:48:59,728 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:48:59,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:48:59,732 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,733 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:48:59,735 - sqlalchemy.engine.Engine - INFO - [cached since 59.19s ago] {'session_id_1': 12, 'param_1': 0, 'param_2': 100}
2025-10-19 23:48:59,737 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,744 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:48:59,747 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:03,840 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:03,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:03,843 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:03,844 - sqlalchemy.engine.Engine - INFO - [cached since 75.78s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:03,847 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:03,847 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:03,849 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:03,854 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:03,856 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:03,857 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:03,858 - sqlalchemy.engine.Engine - INFO - [cached since 75.79s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:03,859 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:03,861 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:03,862 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:03,865 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:49:03,867 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:49:03,868 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:03,869 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:03,871 - sqlalchemy.engine.Engine - INFO - [cached since 75.77s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:49:03,873 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:49:03,875 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:03,877 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.id = %(id_1)s 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id
2025-10-19 23:49:03,878 - sqlalchemy.engine.Engine - INFO - [cached since 53.92s ago] {'id_1': 12, 'param_1': 1}
2025-10-19 23:49:03,883 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:49:03,885 - sqlalchemy.engine.Engine - INFO - [cached since 53.92s ago] {'session_id_1': 12}
2025-10-19 23:49:03,891 - sqlalchemy.engine.Engine - INFO - UPDATE cash_register_sessions SET closed_at=%(closed_at)s, final_balance=%(final_balance)s, expected_balance=%(expected_balance)s, actual_balance=%(actual_balance)s, status=%(status)s, notes=%(notes)s, updated_at=%(updated_at)s WHERE cash_register_sessions.id = %(cash_register_sessions_id)s
2025-10-19 23:49:03,891 - sqlalchemy.engine.Engine - INFO - [cached since 53.91s ago] {'closed_at': datetime.datetime(2025, 10, 20, 6, 49, 3, 890145, tzinfo=datetime.timezone.utc), 'final_balance': 400.0, 'expected_balance': Decimal('500.00'), 'actual_balance': 400.0, 'status': 'CLOSED', 'notes': 'Session closed by Admin User', 'updated_at': datetime.datetime(2025, 10, 20, 6, 49, 3, 891119, tzinfo=datetime.timezone.utc), 'cash_register_sessions_id': 12}
2025-10-19 23:49:03,895 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-19 23:49:03,901 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:03,902 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at, cash_register_sessions.closed_at, cash_register_sessions.opened_by_user_id, cash_register_sessions.cashier_id, cash_register_sessions.initial_balance, cash_register_sessions.final_balance, cash_register_sessions.expected_balance, cash_register_sessions.actual_balance, cash_register_sessions.status, cash_register_sessions.notes, cash_register_sessions.id, cash_register_sessions.created_at, cash_register_sessions.updated_at, cash_register_sessions.deleted_at, users_1.email, users_1.hashed_password, users_1.full_name, users_1.`role`, users_1.staff_type, users_1.is_active, users_1.restaurant_id, users_1.id AS id_1, users_1.created_at AS created_at_1, users_1.updated_at AS updated_at_1, users_1.deleted_at AS deleted_at_1, cash_transactions_1.session_id, cash_transactions_1.transaction_type, cash_transactions_1.amount, cash_transactions_1.description, cash_transactions_1.order_id, cash_transactions_1.created_by_user_id, cash_transactions_1.payment_method, cash_transactions_1.category, cash_transactions_1.id AS id_2, cash_transactions_1.created_at AS created_at_2, cash_transactions_1.updated_at AS updated_at_2, cash_transactions_1.deleted_at AS deleted_at_2, cash_register_reports_1.session_id AS session_id_1, cash_register_reports_1.report_type, cash_register_reports_1.data, cash_register_reports_1.generated_at, cash_register_reports_1.id AS id_3, cash_register_reports_1.created_at AS created_at_3, cash_register_reports_1.updated_at AS updated_at_3, cash_register_reports_1.deleted_at AS deleted_at_3 
FROM cash_register_sessions LEFT OUTER JOIN users AS users_1 ON users_1.id = cash_register_sessions.opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON cash_register_sessions.id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON cash_register_sessions.id = cash_register_reports_1.session_id 
WHERE cash_register_sessions.id = %(pk_1)s
2025-10-19 23:49:03,906 - sqlalchemy.engine.Engine - INFO - [cached since 53.91s ago] {'pk_1': 12}
2025-10-19 23:49:03,911 - app.services.cash_register - INFO - Closed cash register session 12
2025-10-19 23:49:03,916 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:03,919 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:03,930 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:03,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:03,932 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:03,934 - sqlalchemy.engine.Engine - INFO - [cached since 75.87s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:03,937 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:03,937 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:03,939 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:03,941 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:49:03,941 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:49:03,943 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:03,944 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:03,945 - sqlalchemy.engine.Engine - INFO - [cached since 75.84s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:49:03,947 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:49:03,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:03,951 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:49:03,954 - sqlalchemy.engine.Engine - INFO - [cached since 68.06s ago] {'opened_by_user_id_1': 3, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:49:03,963 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:03,966 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:05,390 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:05,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:05,393 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:05,395 - sqlalchemy.engine.Engine - INFO - [cached since 77.33s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:05,397 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:05,397 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:05,400 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:05,402 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA4OTksInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.6w4e7idhtym_N8F9qCFL6J90YBCZyak7c7GrqVEuNL0
2025-10-19 23:49:05,404 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990899, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-19 23:49:05,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:05,406 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:05,407 - sqlalchemy.engine.Engine - INFO - [cached since 77.3s ago] {'id_1': 3, 'param_1': 1}
2025-10-19 23:49:05,410 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-19 23:49:05,413 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:05,413 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:49:05,415 - sqlalchemy.engine.Engine - INFO - [cached since 54.01s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-19 23:49:05,420 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:49:05,420 - sqlalchemy.engine.Engine - INFO - [cached since 55.45s ago] {'session_id_1': 12}
2025-10-19 23:49:05,424 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:49:05,424 - sqlalchemy.engine.Engine - INFO - [cached since 55.46s ago] {'session_id_1': 10}
2025-10-19 23:49:05,429 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:49:05,430 - sqlalchemy.engine.Engine - INFO - [cached since 55.46s ago] {'session_id_1': 11}
2025-10-19 23:49:05,436 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:05,438 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,008 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,009 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,009 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,011 - sqlalchemy.engine.Engine - INFO - [cached since 84.94s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,012 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,013 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,014 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:13,015 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:49:13,015 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:49:13,015 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:49:13,015 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:49:13,015 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:49:13,015 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:49:13,016 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:49:13,016 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:49:13,017 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:49:13,017 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:49:13,017 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:49:13,017 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:49:13,017 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:49:13,017 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:49:13,017 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:49:13,017 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:49:13,020 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,021 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:13,022 - sqlalchemy.engine.Engine - INFO - [cached since 81.65s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:49:13,418 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,419 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,422 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,423 - sqlalchemy.engine.Engine - INFO - [cached since 85.36s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,425 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,425 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,430 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,435 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,435 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,438 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,439 - sqlalchemy.engine.Engine - INFO - [cached since 85.37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,441 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,441 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,442 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:13,445 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NTMsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.A9EBlJy2yJ_X7LoHgoPvLYadYpvjWSs9RzSIcMNoZ84
2025-10-19 23:49:13,446 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990953, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:13,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,449 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:13,454 - sqlalchemy.engine.Engine - INFO - [cached since 85.35s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:13,457 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:13,459 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,517 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,520 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,521 - sqlalchemy.engine.Engine - INFO - [cached since 85.46s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,525 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,525 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,527 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:13,536 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,541 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,543 - sqlalchemy.engine.Engine - INFO - [cached since 85.48s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,547 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,547 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,549 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:13,553 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NTMsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.A9EBlJy2yJ_X7LoHgoPvLYadYpvjWSs9RzSIcMNoZ84
2025-10-19 23:49:13,554 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990953, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:13,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,556 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:13,558 - sqlalchemy.engine.Engine - INFO - [cached since 85.45s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:13,560 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:13,561 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,563 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,563 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,565 - sqlalchemy.engine.Engine - INFO - [cached since 85.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,569 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,570 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,574 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,575 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:49:13,588 - sqlalchemy.engine.Engine - INFO - [cached since 81.21s ago] {'restaurant_id_1': 1}
2025-10-19 23:49:13,604 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,611 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,618 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,623 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,625 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,629 - sqlalchemy.engine.Engine - INFO - [cached since 85.56s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,633 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,633 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,639 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:13,645 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,645 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,648 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,653 - sqlalchemy.engine.Engine - INFO - [cached since 85.59s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,657 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,658 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,663 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:13,670 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,670 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,671 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,675 - sqlalchemy.engine.Engine - INFO - [cached since 85.61s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,682 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,682 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,687 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:13,693 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,695 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,695 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,697 - sqlalchemy.engine.Engine - INFO - [cached since 85.63s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,698 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,699 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,701 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:13,703 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NTMsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.A9EBlJy2yJ_X7LoHgoPvLYadYpvjWSs9RzSIcMNoZ84
2025-10-19 23:49:13,704 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990953, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:13,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,705 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:13,706 - sqlalchemy.engine.Engine - INFO - [cached since 85.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:13,708 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:13,709 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:13,710 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,710 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:13,711 - sqlalchemy.engine.Engine - INFO - [cached since 85.65s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:13,715 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:13,715 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,722 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:13,724 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:49:13,725 - sqlalchemy.engine.Engine - INFO - [cached since 81.2s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:49:13,741 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:13,744 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:14,820 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:14,821 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:14,823 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:14,824 - sqlalchemy.engine.Engine - INFO - [cached since 86.76s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:14,826 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:14,827 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:14,828 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:14,832 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NTMsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.A9EBlJy2yJ_X7LoHgoPvLYadYpvjWSs9RzSIcMNoZ84
2025-10-19 23:49:14,832 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990953, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:14,833 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:14,835 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:14,835 - sqlalchemy.engine.Engine - INFO - [cached since 86.73s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:14,839 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:14,841 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:14,842 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:49:14,845 - sqlalchemy.engine.Engine - INFO - [cached since 78.95s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:49:14,854 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:14,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:16,264 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:16,265 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:16,267 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:16,268 - sqlalchemy.engine.Engine - INFO - [cached since 88.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:16,271 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:16,271 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:16,272 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:16,274 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NTMsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.A9EBlJy2yJ_X7LoHgoPvLYadYpvjWSs9RzSIcMNoZ84
2025-10-19 23:49:16,276 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990953, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:16,277 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:16,278 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:16,279 - sqlalchemy.engine.Engine - INFO - [cached since 88.18s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:16,281 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:16,284 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:16,285 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-19 23:49:16,287 - sqlalchemy.engine.Engine - INFO - [cached since 64.88s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-19 23:49:16,290 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:49:16,291 - sqlalchemy.engine.Engine - INFO - [cached since 66.32s ago] {'session_id_1': 12}
2025-10-19 23:49:16,292 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:49:16,294 - sqlalchemy.engine.Engine - INFO - [cached since 66.32s ago] {'session_id_1': 10}
2025-10-19 23:49:16,299 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-19 23:49:16,301 - sqlalchemy.engine.Engine - INFO - [cached since 66.33s ago] {'session_id_1': 11}
2025-10-19 23:49:16,311 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:16,314 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:33,997 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:34,001 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:34,002 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:34,004 - sqlalchemy.engine.Engine - INFO - [cached since 105.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:34,007 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:34,007 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:34,010 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:34,011 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:34,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:34,014 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:34,015 - sqlalchemy.engine.Engine - INFO - [cached since 105.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:34,021 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:34,022 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:34,025 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:34,028 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NTMsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.A9EBlJy2yJ_X7LoHgoPvLYadYpvjWSs9RzSIcMNoZ84
2025-10-19 23:49:34,029 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990953, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:34,030 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:34,032 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:34,034 - sqlalchemy.engine.Engine - INFO - [cached since 105.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:34,038 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:34,039 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NTMsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.A9EBlJy2yJ_X7LoHgoPvLYadYpvjWSs9RzSIcMNoZ84
2025-10-19 23:49:34,040 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990953, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:34,042 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:34,045 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:34,047 - sqlalchemy.engine.Engine - INFO - [cached since 105.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:34,168 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:34,172 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:34,175 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:34,177 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:34,179 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:34,183 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:34,184 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:34,187 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:34,189 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:34,191 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:34,192 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:34,194 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:34,197 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:34,198 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:34,204 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NTMsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.A9EBlJy2yJ_X7LoHgoPvLYadYpvjWSs9RzSIcMNoZ84
2025-10-19 23:49:34,203 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:34,207 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990953, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:34,206 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:34,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:34,211 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:34,213 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:34,216 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:34,224 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:34,229 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:49:34,232 - sqlalchemy.engine.Engine - INFO - [cached since 98.33s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:49:34,241 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:34,244 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:37,606 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:37,607 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:37,608 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:37,609 - sqlalchemy.engine.Engine - INFO - [cached since 109.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:37,611 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:37,611 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:37,613 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:37,613 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:49:37,614 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:49:37,614 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:49:37,614 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:49:37,614 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:49:37,614 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:49:37,614 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:49:37,615 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:49:37,615 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:49:37,615 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:49:37,617 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:49:37,617 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:49:37,617 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:49:37,617 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:49:37,617 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:49:37,618 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:49:37,620 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:37,621 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:37,622 - sqlalchemy.engine.Engine - INFO - [cached since 106.3s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:49:38,012 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:38,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,016 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:38,017 - sqlalchemy.engine.Engine - INFO - [cached since 110s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:38,018 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:38,020 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,025 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,030 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:38,032 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,032 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:38,034 - sqlalchemy.engine.Engine - INFO - [cached since 110s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:38,035 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:38,037 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,039 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:38,041 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.SBDhdbsnmtrjOG29Pxmwcz5mfJ2UaX-uaTqrx-vJMtA
2025-10-19 23:49:38,041 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990978, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:38,042 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,042 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:38,045 - sqlalchemy.engine.Engine - INFO - [cached since 109.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:38,047 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:38,051 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,105 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:38,106 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,107 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:38,108 - sqlalchemy.engine.Engine - INFO - [cached since 110s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:38,110 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:38,110 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,111 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:38,116 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.SBDhdbsnmtrjOG29Pxmwcz5mfJ2UaX-uaTqrx-vJMtA
2025-10-19 23:49:38,117 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990978, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:38,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,119 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:38,121 - sqlalchemy.engine.Engine - INFO - [cached since 110s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:38,123 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:38,124 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:38,125 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,125 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:38,127 - sqlalchemy.engine.Engine - INFO - [cached since 110.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:38,135 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:38,136 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,152 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,157 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:49:38,160 - sqlalchemy.engine.Engine - INFO - [cached since 105.8s ago] {'restaurant_id_1': 1}
2025-10-19 23:49:38,170 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,171 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,177 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:38,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,183 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:38,187 - sqlalchemy.engine.Engine - INFO - [cached since 110.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:38,194 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:38,194 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,197 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:38,203 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:38,205 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,207 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:38,209 - sqlalchemy.engine.Engine - INFO - [cached since 110.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:38,211 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:38,211 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,215 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:38,218 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.SBDhdbsnmtrjOG29Pxmwcz5mfJ2UaX-uaTqrx-vJMtA
2025-10-19 23:49:38,218 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990978, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:38,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,222 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:38,224 - sqlalchemy.engine.Engine - INFO - [cached since 110.1s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:38,229 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:38,230 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:38,232 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,232 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:38,232 - sqlalchemy.engine.Engine - INFO - [cached since 110.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:38,235 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:38,236 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,239 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:38,239 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:49:38,241 - sqlalchemy.engine.Engine - INFO - [cached since 105.7s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:49:38,263 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:38,265 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:39,624 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:39,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:39,629 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:39,631 - sqlalchemy.engine.Engine - INFO - [cached since 111.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:39,634 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:39,634 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:39,637 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:39,641 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.SBDhdbsnmtrjOG29Pxmwcz5mfJ2UaX-uaTqrx-vJMtA
2025-10-19 23:49:39,643 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990978, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:39,645 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:39,647 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:39,649 - sqlalchemy.engine.Engine - INFO - [cached since 111.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:39,653 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:39,658 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:39,660 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:49:39,664 - sqlalchemy.engine.Engine - INFO - [cached since 103.8s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:49:39,678 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:39,682 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:41,131 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:41,132 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:41,133 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:41,134 - sqlalchemy.engine.Engine - INFO - [cached since 113.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:41,137 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:41,137 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:41,139 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:41,140 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:41,142 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:41,143 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:41,145 - sqlalchemy.engine.Engine - INFO - [cached since 113.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:41,149 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:41,149 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:41,151 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:49:41,153 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.SBDhdbsnmtrjOG29Pxmwcz5mfJ2UaX-uaTqrx-vJMtA
2025-10-19 23:49:41,154 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990978, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:41,156 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:41,157 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:41,159 - sqlalchemy.engine.Engine - INFO - [cached since 113.1s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:41,161 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:41,162 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTA5NzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.SBDhdbsnmtrjOG29Pxmwcz5mfJ2UaX-uaTqrx-vJMtA
2025-10-19 23:49:41,163 - app.services.user - DEBUG - Decoded payload: {'exp': 1760990978, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:49:41,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:41,165 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:49:41,165 - sqlalchemy.engine.Engine - INFO - [cached since 113.1s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:49:41,169 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:49:41,171 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:41,172 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:41,174 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:41,175 - sqlalchemy.engine.Engine - INFO - [cached since 113.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:41,178 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:41,178 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:41,180 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:41,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:41,301 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:49:41,302 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:49:41,302 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:49:41,304 - sqlalchemy.engine.Engine - INFO - [cached since 113.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:49:41,305 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:49:41,306 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:49:41,306 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:06,500 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:06,502 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,503 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:06,503 - sqlalchemy.engine.Engine - INFO - [cached since 138.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:06,505 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:06,506 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,507 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:06,508 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:50:06,508 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:50:06,508 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:50:06,509 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:50:06,509 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:50:06,509 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:50:06,509 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:50:06,509 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:50:06,509 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:50:06,510 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:50:06,510 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:50:06,510 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:50:06,511 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:50:06,511 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:50:06,511 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:50:06,511 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:50:06,513 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,514 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:50:06,515 - sqlalchemy.engine.Engine - INFO - [cached since 135.1s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:50:06,852 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:06,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,855 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:06,855 - sqlalchemy.engine.Engine - INFO - [cached since 138.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:06,858 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:06,859 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,863 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,868 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:06,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,870 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:06,871 - sqlalchemy.engine.Engine - INFO - [cached since 138.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:06,874 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:06,874 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,877 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:06,879 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEwMDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.skE4toZQs1SpgPSEohlDAY1ldGFi7db5sZ1VoESlOzU
2025-10-19 23:50:06,880 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991006, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:50:06,880 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,882 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:50:06,882 - sqlalchemy.engine.Engine - INFO - [cached since 138.8s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:50:06,885 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:50:06,890 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,954 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:06,957 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,958 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:06,959 - sqlalchemy.engine.Engine - INFO - [cached since 138.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:06,961 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:06,961 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,963 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:06,965 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEwMDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.skE4toZQs1SpgPSEohlDAY1ldGFi7db5sZ1VoESlOzU
2025-10-19 23:50:06,966 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991006, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:50:06,966 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,967 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:50:06,968 - sqlalchemy.engine.Engine - INFO - [cached since 138.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:50:06,969 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:50:06,971 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:06,971 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,972 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:06,974 - sqlalchemy.engine.Engine - INFO - [cached since 138.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:06,976 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:06,976 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,979 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:06,980 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:50:06,982 - sqlalchemy.engine.Engine - INFO - [cached since 134.6s ago] {'restaurant_id_1': 1}
2025-10-19 23:50:06,989 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,992 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:06,999 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:07,001 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:07,002 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:07,002 - sqlalchemy.engine.Engine - INFO - [cached since 138.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:07,004 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:07,004 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:07,006 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:07,013 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:07,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:07,015 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:07,016 - sqlalchemy.engine.Engine - INFO - [cached since 138.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:07,018 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:07,018 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:07,019 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:07,022 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEwMDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.skE4toZQs1SpgPSEohlDAY1ldGFi7db5sZ1VoESlOzU
2025-10-19 23:50:07,022 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991006, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:50:07,023 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:07,023 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:50:07,025 - sqlalchemy.engine.Engine - INFO - [cached since 138.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:50:07,026 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:50:07,027 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:07,028 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:07,029 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:07,029 - sqlalchemy.engine.Engine - INFO - [cached since 139s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:07,032 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:07,032 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:07,035 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:07,036 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:50:07,037 - sqlalchemy.engine.Engine - INFO - [cached since 134.5s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:50:07,056 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:07,058 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:09,948 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:09,951 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:09,952 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:09,955 - sqlalchemy.engine.Engine - INFO - [cached since 141.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:09,958 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:09,958 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:09,961 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:09,966 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEwMDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.skE4toZQs1SpgPSEohlDAY1ldGFi7db5sZ1VoESlOzU
2025-10-19 23:50:09,967 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991006, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:50:09,968 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:09,972 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:50:09,973 - sqlalchemy.engine.Engine - INFO - [cached since 141.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:50:09,976 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:50:09,979 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:09,982 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:50:09,985 - sqlalchemy.engine.Engine - INFO - [cached since 134.1s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:50:09,992 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:09,996 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:20,258 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:20,259 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:20,260 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:20,260 - sqlalchemy.engine.Engine - INFO - [cached since 152.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:20,261 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:20,263 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:20,263 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:20,265 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEwMDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.skE4toZQs1SpgPSEohlDAY1ldGFi7db5sZ1VoESlOzU
2025-10-19 23:50:20,266 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991006, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:50:20,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:20,267 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:50:20,268 - sqlalchemy.engine.Engine - INFO - [cached since 152.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:50:20,270 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:50:20,275 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:20,278 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:20,279 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:20,280 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:20,280 - sqlalchemy.engine.Engine - INFO - [cached since 152.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:20,283 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:20,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:20,285 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:20,288 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEwMDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.skE4toZQs1SpgPSEohlDAY1ldGFi7db5sZ1VoESlOzU
2025-10-19 23:50:20,288 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991006, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:50:20,290 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:20,290 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:50:20,291 - sqlalchemy.engine.Engine - INFO - [cached since 152.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:50:20,294 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:50:20,295 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:20,296 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:20,297 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:20,298 - sqlalchemy.engine.Engine - INFO - [cached since 152.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:20,301 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:20,301 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:20,303 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:20,322 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:50:20,324 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:20,324 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:50:20,326 - sqlalchemy.engine.Engine - INFO - [cached since 152.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:50:20,328 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:50:20,328 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:20,329 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:50:20,331 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEwMDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.skE4toZQs1SpgPSEohlDAY1ldGFi7db5sZ1VoESlOzU
2025-10-19 23:50:20,332 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991006, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:50:20,334 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:20,335 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:50:20,338 - sqlalchemy.engine.Engine - INFO - [cached since 152.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:50:20,341 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:50:20,342 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:50:20,344 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-19 23:50:20,346 - sqlalchemy.engine.Engine - INFO - [cached since 144.4s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-19 23:50:20,353 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:50:20,355 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:02,509 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:02,525 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:02,526 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:02,527 - sqlalchemy.engine.Engine - INFO - [cached since 314.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:02,530 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:02,531 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:02,533 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:02,534 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:53:02,535 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:53:02,535 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:53:02,535 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:53:02,535 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:53:02,536 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:53:02,537 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:53:02,537 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:53:02,538 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:53:02,538 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:53:02,539 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:53:02,539 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:53:02,540 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:53:02,540 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:53:02,540 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:53:02,541 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:53:02,549 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:02,550 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:02,552 - sqlalchemy.engine.Engine - INFO - [cached since 311.2s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:53:02,942 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:02,970 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:02,971 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:02,972 - sqlalchemy.engine.Engine - INFO - [cached since 314.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:02,976 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:02,976 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:02,985 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:02,991 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:02,998 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,000 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:03,004 - sqlalchemy.engine.Engine - INFO - [cached since 314.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:03,010 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:03,010 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,012 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:03,013 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTExODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.F7dF8SyRCLaiRlKmgT_gO3Dx1OJBUMS0UHBMFZp-EQc
2025-10-19 23:53:03,014 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991182, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:03,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,017 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:03,018 - sqlalchemy.engine.Engine - INFO - [cached since 314.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:03,023 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:03,027 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,089 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:03,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,090 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:03,091 - sqlalchemy.engine.Engine - INFO - [cached since 315s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:03,094 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:03,095 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,096 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:03,098 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTExODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.F7dF8SyRCLaiRlKmgT_gO3Dx1OJBUMS0UHBMFZp-EQc
2025-10-19 23:53:03,098 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991182, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:03,099 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,100 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:03,101 - sqlalchemy.engine.Engine - INFO - [cached since 315s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:03,103 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:03,104 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:03,106 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,108 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:03,109 - sqlalchemy.engine.Engine - INFO - [cached since 315s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:03,112 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:03,112 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,114 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,116 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:53:03,116 - sqlalchemy.engine.Engine - INFO - [cached since 310.7s ago] {'restaurant_id_1': 1}
2025-10-19 23:53:03,126 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,128 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,134 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:03,135 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,135 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:03,137 - sqlalchemy.engine.Engine - INFO - [cached since 315.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:03,140 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:03,140 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,143 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:03,158 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:03,159 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,159 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:03,161 - sqlalchemy.engine.Engine - INFO - [cached since 315.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:03,162 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:03,162 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,163 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:03,166 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTExODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.F7dF8SyRCLaiRlKmgT_gO3Dx1OJBUMS0UHBMFZp-EQc
2025-10-19 23:53:03,166 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991182, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:03,167 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,168 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:03,171 - sqlalchemy.engine.Engine - INFO - [cached since 315.1s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:03,174 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:03,175 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:03,176 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,177 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:03,178 - sqlalchemy.engine.Engine - INFO - [cached since 315.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:03,180 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:03,180 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:03,184 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:53:03,187 - sqlalchemy.engine.Engine - INFO - [cached since 310.7s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:53:03,214 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:03,215 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:05,350 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:05,352 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:05,353 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:05,354 - sqlalchemy.engine.Engine - INFO - [cached since 317.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:05,356 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:05,356 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:05,357 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:05,358 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:05,360 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:05,360 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:05,360 - sqlalchemy.engine.Engine - INFO - [cached since 317.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:05,363 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:05,363 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:05,364 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:05,366 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTExODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.F7dF8SyRCLaiRlKmgT_gO3Dx1OJBUMS0UHBMFZp-EQc
2025-10-19 23:53:05,366 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991182, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:05,367 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:05,369 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:05,370 - sqlalchemy.engine.Engine - INFO - [cached since 317.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:05,372 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:05,373 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTExODIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.F7dF8SyRCLaiRlKmgT_gO3Dx1OJBUMS0UHBMFZp-EQc
2025-10-19 23:53:05,374 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991182, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:05,374 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:05,375 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:05,376 - sqlalchemy.engine.Engine - INFO - [cached since 317.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:05,378 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:05,381 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:05,382 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:05,383 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:05,384 - sqlalchemy.engine.Engine - INFO - [cached since 317.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:05,387 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:05,387 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:05,390 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:05,392 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:05,520 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:05,520 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:05,522 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:05,522 - sqlalchemy.engine.Engine - INFO - [cached since 317.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:05,525 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:05,525 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:05,526 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:30,284 - app.main - INFO - Shutting down background tasks...
2025-10-19 23:53:33,794 - app.main - INFO - ==================================================
2025-10-19 23:53:33,795 - app.main - INFO - Application starting - Logging initialized
2025-10-19 23:53:33,795 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-19 23:53:33,796 - app.main - INFO - ==================================================
2025-10-19 23:53:34,663 - app.main - INFO - Starting background tasks...
2025-10-19 23:53:39,023 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:39,138 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-19 23:53:39,140 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:53:39,142 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-19 23:53:39,142 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:53:39,144 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-19 23:53:39,144 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:53:39,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:39,152 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:39,155 - sqlalchemy.engine.Engine - INFO - [generated in 0.00202s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:39,160 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:39,160 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:39,161 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:39,164 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:53:39,164 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:53:39,164 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:53:39,164 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:53:39,164 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:53:39,166 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:53:39,166 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:53:39,166 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:53:39,166 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:53:39,166 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:53:39,166 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:53:39,166 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:53:39,166 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:53:39,167 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:53:39,167 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:53:39,167 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:53:39,171 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:39,176 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:39,177 - sqlalchemy.engine.Engine - INFO - [generated in 0.00118s] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:53:39,182 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-19 23:53:39,182 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-19 23:53:39,637 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:39,666 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:39,666 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:39,668 - sqlalchemy.engine.Engine - INFO - [cached since 0.5149s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:39,670 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:39,671 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:39,682 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:39,689 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:39,690 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:39,693 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:39,694 - sqlalchemy.engine.Engine - INFO - [cached since 0.5407s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:39,696 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:39,697 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:39,698 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:39,700 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEyMTksInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.lgRCr5QfYRoddo-NRQf-ZpDO7R6zONujgV1djepZPRI
2025-10-19 23:53:39,701 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991219, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:39,702 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:39,705 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:39,707 - sqlalchemy.engine.Engine - INFO - [generated in 0.00165s] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:39,712 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:39,727 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,324 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:40,325 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,326 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:40,326 - sqlalchemy.engine.Engine - INFO - [cached since 1.174s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:40,329 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:40,329 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,331 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:40,333 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEyMTksInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.lgRCr5QfYRoddo-NRQf-ZpDO7R6zONujgV1djepZPRI
2025-10-19 23:53:40,334 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991219, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:40,334 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,335 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:40,336 - sqlalchemy.engine.Engine - INFO - [cached since 0.6315s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:40,338 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:40,338 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:40,340 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,341 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:40,342 - sqlalchemy.engine.Engine - INFO - [cached since 1.19s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:40,345 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:40,346 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,348 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,350 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:53:40,351 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] {'restaurant_id_1': 1}
2025-10-19 23:53:40,356 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,358 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,364 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:40,364 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,366 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:40,366 - sqlalchemy.engine.Engine - INFO - [cached since 1.213s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:40,368 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:40,369 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,371 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:40,384 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:40,385 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,386 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:40,387 - sqlalchemy.engine.Engine - INFO - [cached since 1.234s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:40,390 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:40,390 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,392 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:40,394 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEyMTksInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.lgRCr5QfYRoddo-NRQf-ZpDO7R6zONujgV1djepZPRI
2025-10-19 23:53:40,395 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991219, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:40,396 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,397 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:40,398 - sqlalchemy.engine.Engine - INFO - [cached since 0.6927s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:40,399 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:40,401 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:40,402 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,402 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:40,403 - sqlalchemy.engine.Engine - INFO - [cached since 1.25s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:40,405 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:40,405 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:40,425 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:53:40,426 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:53:40,447 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:40,449 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:42,818 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:42,819 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:42,820 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:42,821 - sqlalchemy.engine.Engine - INFO - [cached since 3.668s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:42,822 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:42,822 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:42,824 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:42,825 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:42,826 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:42,827 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:42,828 - sqlalchemy.engine.Engine - INFO - [cached since 3.675s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:42,830 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:42,830 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:42,832 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:53:42,834 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEyMTksInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.lgRCr5QfYRoddo-NRQf-ZpDO7R6zONujgV1djepZPRI
2025-10-19 23:53:42,835 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991219, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:42,835 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:42,837 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:42,838 - sqlalchemy.engine.Engine - INFO - [cached since 3.133s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:42,840 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:42,841 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTEyMTksInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.lgRCr5QfYRoddo-NRQf-ZpDO7R6zONujgV1djepZPRI
2025-10-19 23:53:42,841 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991219, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:53:42,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:42,842 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:53:42,844 - sqlalchemy.engine.Engine - INFO - [cached since 3.139s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:53:42,847 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:53:42,849 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:42,852 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:42,854 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:42,854 - sqlalchemy.engine.Engine - INFO - [cached since 3.702s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:42,858 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:42,858 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:42,862 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:42,862 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:42,916 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:53:42,917 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:53:42,918 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:53:42,919 - sqlalchemy.engine.Engine - INFO - [cached since 3.766s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:53:42,921 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:53:42,921 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:53:42,922 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:39,358 - app.main - INFO - Shutting down background tasks...
2025-10-19 23:56:42,193 - app.main - INFO - ==================================================
2025-10-19 23:56:42,193 - app.main - INFO - Application starting - Logging initialized
2025-10-19 23:56:42,194 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-19 23:56:42,194 - app.main - INFO - ==================================================
2025-10-19 23:56:42,955 - app.main - INFO - Starting background tasks...
2025-10-19 23:56:47,846 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:47,938 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-19 23:56:47,939 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:56:47,941 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-19 23:56:47,943 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:56:47,944 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-19 23:56:47,945 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-19 23:56:47,948 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:47,955 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:47,955 - sqlalchemy.engine.Engine - INFO - [generated in 0.00149s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:47,960 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:47,960 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:47,962 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:47,963 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:56:47,963 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:56:47,964 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:56:47,964 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:56:47,964 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:56:47,964 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:56:47,964 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:56:47,964 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:56:47,965 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:56:47,965 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:56:47,965 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:56:47,965 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:56:47,966 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:56:47,966 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:56:47,966 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:56:47,966 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:56:47,970 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:47,974 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:56:47,975 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:56:47,978 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-19 23:56:47,978 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-19 23:56:48,370 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:48,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,377 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:48,378 - sqlalchemy.engine.Engine - INFO - [cached since 0.4235s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:48,380 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:48,380 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,393 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,399 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:48,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,401 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:48,401 - sqlalchemy.engine.Engine - INFO - [cached since 0.4468s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:48,403 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:48,403 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,404 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:48,406 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0MDgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.qHWpSrtNGfBHyDYSSOqd4fsSe2tWT4LidchUpCTakiM
2025-10-19 23:56:48,406 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991408, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:56:48,408 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,409 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:56:48,411 - sqlalchemy.engine.Engine - INFO - [generated in 0.00188s] {'id_1': 8, 'param_1': 1}
2025-10-19 23:56:48,413 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:56:48,425 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,901 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:48,904 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,905 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:48,908 - sqlalchemy.engine.Engine - INFO - [cached since 0.9537s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:48,913 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:48,913 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,917 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:48,922 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0MDgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.qHWpSrtNGfBHyDYSSOqd4fsSe2tWT4LidchUpCTakiM
2025-10-19 23:56:48,924 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991408, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:56:48,926 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,928 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:56:48,930 - sqlalchemy.engine.Engine - INFO - [cached since 0.52s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:56:48,932 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:56:48,935 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:48,937 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,938 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:48,941 - sqlalchemy.engine.Engine - INFO - [cached since 0.9869s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:48,945 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:48,946 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,954 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:56:48,956 - sqlalchemy.engine.Engine - INFO - [generated in 0.00183s] {'restaurant_id_1': 1}
2025-10-19 23:56:48,966 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,969 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,974 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:48,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,977 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:48,978 - sqlalchemy.engine.Engine - INFO - [cached since 1.024s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:48,981 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:48,981 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,983 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:48,992 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:48,994 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:48,994 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:48,995 - sqlalchemy.engine.Engine - INFO - [cached since 1.041s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:48,998 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:48,998 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:48,999 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:49,002 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0MDgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.qHWpSrtNGfBHyDYSSOqd4fsSe2tWT4LidchUpCTakiM
2025-10-19 23:56:49,003 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991408, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:56:49,004 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:49,007 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:56:49,008 - sqlalchemy.engine.Engine - INFO - [cached since 0.5979s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:56:49,010 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:56:49,011 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:49,012 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:49,013 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:49,014 - sqlalchemy.engine.Engine - INFO - [cached since 1.06s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:49,016 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:49,016 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:49,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:49,035 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:56:49,036 - sqlalchemy.engine.Engine - INFO - [generated in 0.00134s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:56:49,062 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:49,065 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,376 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:50,378 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,379 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:50,380 - sqlalchemy.engine.Engine - INFO - [cached since 2.425s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:50,382 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:50,382 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,384 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:50,385 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:50,385 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,387 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:50,389 - sqlalchemy.engine.Engine - INFO - [cached since 2.434s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:50,390 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:50,390 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,393 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:50,395 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0MDgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.qHWpSrtNGfBHyDYSSOqd4fsSe2tWT4LidchUpCTakiM
2025-10-19 23:56:50,395 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991408, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:56:50,396 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,397 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:56:50,398 - sqlalchemy.engine.Engine - INFO - [cached since 1.988s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:56:50,399 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:56:50,400 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0MDgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.qHWpSrtNGfBHyDYSSOqd4fsSe2tWT4LidchUpCTakiM
2025-10-19 23:56:50,400 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991408, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:56:50,401 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,402 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:56:50,403 - sqlalchemy.engine.Engine - INFO - [cached since 1.994s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:56:50,405 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:56:50,407 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:50,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,434 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:50,435 - sqlalchemy.engine.Engine - INFO - [cached since 2.481s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:50,437 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:50,437 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,441 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,442 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,446 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:50,447 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,448 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:50,448 - sqlalchemy.engine.Engine - INFO - [cached since 2.494s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:50,450 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:50,450 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,452 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:56:50,454 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0MDgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.qHWpSrtNGfBHyDYSSOqd4fsSe2tWT4LidchUpCTakiM
2025-10-19 23:56:50,454 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991408, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:56:50,455 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,456 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:56:50,457 - sqlalchemy.engine.Engine - INFO - [cached since 2.048s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:56:50,459 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:56:50,460 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:56:50,461 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,462 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:56:50,463 - sqlalchemy.engine.Engine - INFO - [cached since 2.509s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:56:50,466 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:56:50,466 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,468 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:56:50,470 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:56:50,470 - sqlalchemy.engine.Engine - INFO - [cached since 1.517s ago] {'restaurant_id_1': 1}
2025-10-19 23:56:50,476 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:56:50,478 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:55,877 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:55,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:55,880 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:55,882 - sqlalchemy.engine.Engine - INFO - [cached since 67.93s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:55,886 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:55,887 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:55,888 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:57:55,890 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:57:55,890 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:57:55,890 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:57:55,890 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:57:55,890 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:57:55,890 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:57:55,893 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:57:55,894 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:57:55,894 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:57:55,894 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:57:55,894 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:57:55,895 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:57:55,895 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:57:55,895 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:57:55,895 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:57:55,896 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:57:55,901 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:55,902 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:57:55,903 - sqlalchemy.engine.Engine - INFO - [cached since 67.93s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:57:56,252 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:56,253 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,254 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:56,255 - sqlalchemy.engine.Engine - INFO - [cached since 68.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:56,258 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:56,258 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,262 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,265 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:56,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,266 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:56,267 - sqlalchemy.engine.Engine - INFO - [cached since 68.31s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:56,269 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:56,270 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,271 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:57:56,272 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0NzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8HtMdA4On4iVW9XIrFqgfz4T84UsUbpDQ5ciA0_N-Kc
2025-10-19 23:57:56,272 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991476, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:57:56,274 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,274 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:57:56,275 - sqlalchemy.engine.Engine - INFO - [cached since 67.87s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:57:56,277 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:57:56,279 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,320 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:56,321 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,322 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:56,323 - sqlalchemy.engine.Engine - INFO - [cached since 68.37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:56,325 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:56,326 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,326 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:57:56,329 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0NzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8HtMdA4On4iVW9XIrFqgfz4T84UsUbpDQ5ciA0_N-Kc
2025-10-19 23:57:56,329 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991476, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:57:56,330 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,331 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:57:56,332 - sqlalchemy.engine.Engine - INFO - [cached since 67.92s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:57:56,335 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:57:56,336 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:56,337 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,337 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:56,339 - sqlalchemy.engine.Engine - INFO - [cached since 68.38s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:56,340 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:56,341 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,343 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,344 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:57:56,344 - sqlalchemy.engine.Engine - INFO - [cached since 67.39s ago] {'restaurant_id_1': 1}
2025-10-19 23:57:56,349 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,351 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,358 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:56,359 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,361 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:56,362 - sqlalchemy.engine.Engine - INFO - [cached since 68.41s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:56,365 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:56,366 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,367 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:57:56,373 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:56,374 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,375 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:56,377 - sqlalchemy.engine.Engine - INFO - [cached since 68.42s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:56,379 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:56,379 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,381 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:57:56,384 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0NzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8HtMdA4On4iVW9XIrFqgfz4T84UsUbpDQ5ciA0_N-Kc
2025-10-19 23:57:56,385 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991476, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:57:56,386 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,388 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:57:56,388 - sqlalchemy.engine.Engine - INFO - [cached since 67.98s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:57:56,391 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:57:56,391 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:56,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,393 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:56,394 - sqlalchemy.engine.Engine - INFO - [cached since 68.44s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:56,396 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:56,397 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:56,401 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:57:56,401 - sqlalchemy.engine.Engine - INFO - [cached since 67.37s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:57:56,420 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:56,422 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,427 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:57,428 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,429 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:57,430 - sqlalchemy.engine.Engine - INFO - [cached since 69.48s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:57,432 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:57,432 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,434 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:57:57,435 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:57,435 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,436 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:57,438 - sqlalchemy.engine.Engine - INFO - [cached since 69.48s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:57,439 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:57,439 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,442 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:57:57,444 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0NzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8HtMdA4On4iVW9XIrFqgfz4T84UsUbpDQ5ciA0_N-Kc
2025-10-19 23:57:57,445 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991476, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:57:57,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,447 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:57:57,447 - sqlalchemy.engine.Engine - INFO - [cached since 69.04s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:57:57,449 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:57:57,449 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0NzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8HtMdA4On4iVW9XIrFqgfz4T84UsUbpDQ5ciA0_N-Kc
2025-10-19 23:57:57,450 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991476, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:57:57,450 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,451 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:57:57,452 - sqlalchemy.engine.Engine - INFO - [cached since 69.04s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:57:57,454 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:57:57,454 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:57,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,458 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:57,459 - sqlalchemy.engine.Engine - INFO - [cached since 69.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:57,461 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:57,461 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,464 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,465 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,471 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:57,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,472 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:57,473 - sqlalchemy.engine.Engine - INFO - [cached since 69.52s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:57,475 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:57,475 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,477 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:57:57,479 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0NzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8HtMdA4On4iVW9XIrFqgfz4T84UsUbpDQ5ciA0_N-Kc
2025-10-19 23:57:57,479 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991476, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:57:57,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,481 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:57:57,482 - sqlalchemy.engine.Engine - INFO - [cached since 69.07s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:57:57,484 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:57:57,485 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:57:57,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,487 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:57:57,488 - sqlalchemy.engine.Engine - INFO - [cached since 69.53s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:57:57,491 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:57:57,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,494 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:57:57,495 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:57:57,495 - sqlalchemy.engine.Engine - INFO - [cached since 68.54s ago] {'restaurant_id_1': 1}
2025-10-19 23:57:57,501 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:57:57,503 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,058 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:01,059 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,061 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:01,061 - sqlalchemy.engine.Engine - INFO - [cached since 73.11s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:01,063 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:01,063 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,064 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:01,065 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-19 23:58:01,067 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:58:01,069 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-19 23:58:01,069 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-19 23:58:01,069 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-19 23:58:01,069 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-19 23:58:01,071 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,073 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-19 23:58:01,074 - sqlalchemy.engine.Engine - INFO - [cached since 73.1s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-19 23:58:01,452 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:01,453 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,454 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:01,454 - sqlalchemy.engine.Engine - INFO - [cached since 73.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:01,457 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:01,457 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,461 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,470 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:01,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,471 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:01,472 - sqlalchemy.engine.Engine - INFO - [cached since 73.52s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:01,474 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:01,475 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,476 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:01,477 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0ODEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.LcI960KNVfGjx9xlpccR4aBQlbpJ1eyf67ewdt6-Lw8
2025-10-19 23:58:01,478 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991481, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:58:01,479 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,480 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:58:01,480 - sqlalchemy.engine.Engine - INFO - [cached since 73.07s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:58:01,484 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:58:01,486 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,545 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:01,546 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,549 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:01,550 - sqlalchemy.engine.Engine - INFO - [cached since 73.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:01,554 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:01,554 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,556 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:01,559 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0ODEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.LcI960KNVfGjx9xlpccR4aBQlbpJ1eyf67ewdt6-Lw8
2025-10-19 23:58:01,559 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991481, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:58:01,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,563 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:58:01,565 - sqlalchemy.engine.Engine - INFO - [cached since 73.16s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:58:01,569 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:58:01,570 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:01,573 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,574 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:01,576 - sqlalchemy.engine.Engine - INFO - [cached since 73.62s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:01,579 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:01,579 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,582 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,583 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-19 23:58:01,583 - sqlalchemy.engine.Engine - INFO - [cached since 72.63s ago] {'restaurant_id_1': 1}
2025-10-19 23:58:01,589 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,591 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,596 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:01,597 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,598 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:01,599 - sqlalchemy.engine.Engine - INFO - [cached since 73.64s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:01,600 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:01,600 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,602 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:01,618 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:01,619 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,621 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:01,621 - sqlalchemy.engine.Engine - INFO - [cached since 73.67s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:01,623 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:01,624 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,625 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:01,627 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0ODEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.LcI960KNVfGjx9xlpccR4aBQlbpJ1eyf67ewdt6-Lw8
2025-10-19 23:58:01,627 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991481, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:58:01,628 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,629 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:58:01,630 - sqlalchemy.engine.Engine - INFO - [cached since 73.22s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:58:01,632 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:58:01,633 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:01,634 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,635 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:01,636 - sqlalchemy.engine.Engine - INFO - [cached since 73.68s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:01,638 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:01,638 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:01,642 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-19 23:58:01,642 - sqlalchemy.engine.Engine - INFO - [cached since 72.61s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-19 23:58:01,658 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:01,659 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:04,204 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:04,205 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:04,206 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:04,207 - sqlalchemy.engine.Engine - INFO - [cached since 76.25s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:04,208 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:04,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:04,210 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:04,216 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:04,217 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:04,218 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:04,220 - sqlalchemy.engine.Engine - INFO - [cached since 76.27s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:04,223 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:04,223 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:04,224 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:04,235 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:04,235 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:04,237 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:04,238 - sqlalchemy.engine.Engine - INFO - [cached since 76.28s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:04,240 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:04,240 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:04,241 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:04,246 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:04,247 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:04,248 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:04,249 - sqlalchemy.engine.Engine - INFO - [cached since 76.29s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:04,250 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:04,250 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:04,253 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:04,253 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0ODEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.LcI960KNVfGjx9xlpccR4aBQlbpJ1eyf67ewdt6-Lw8
2025-10-19 23:58:04,254 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991481, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:58:04,254 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:04,256 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:58:04,256 - sqlalchemy.engine.Engine - INFO - [cached since 75.85s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:58:04,259 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:58:04,259 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:04,260 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:04,262 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:04,263 - sqlalchemy.engine.Engine - INFO - [cached since 76.31s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:04,264 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:04,264 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:04,267 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:04,283 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-19 23:58:04,286 - sqlalchemy.engine.Engine - INFO - [generated in 0.00304s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-19 23:58:04,313 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,315 - sqlalchemy.engine.Engine - INFO - [generated in 0.00196s] {'pk_1': 9}
2025-10-19 23:58:04,318 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,320 - sqlalchemy.engine.Engine - INFO - [cached since 0.007245s ago] {'pk_1': 16}
2025-10-19 23:58:04,323 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,325 - sqlalchemy.engine.Engine - INFO - [cached since 0.01141s ago] {'pk_1': 15}
2025-10-19 23:58:04,328 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,330 - sqlalchemy.engine.Engine - INFO - [cached since 0.01605s ago] {'pk_1': 13}
2025-10-19 23:58:04,333 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,334 - sqlalchemy.engine.Engine - INFO - [cached since 0.02037s ago] {'pk_1': 14}
2025-10-19 23:58:04,337 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,338 - sqlalchemy.engine.Engine - INFO - [cached since 0.0242s ago] {'pk_1': 18}
2025-10-19 23:58:04,340 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,341 - sqlalchemy.engine.Engine - INFO - [cached since 0.02762s ago] {'pk_1': 21}
2025-10-19 23:58:04,343 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,345 - sqlalchemy.engine.Engine - INFO - [cached since 0.03082s ago] {'pk_1': 19}
2025-10-19 23:58:04,347 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,348 - sqlalchemy.engine.Engine - INFO - [cached since 0.03449s ago] {'pk_1': 22}
2025-10-19 23:58:04,351 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,352 - sqlalchemy.engine.Engine - INFO - [cached since 0.03869s ago] {'pk_1': 7}
2025-10-19 23:58:04,355 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,356 - sqlalchemy.engine.Engine - INFO - [cached since 0.04239s ago] {'pk_1': 5}
2025-10-19 23:58:04,359 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,360 - sqlalchemy.engine.Engine - INFO - [cached since 0.0459s ago] {'pk_1': 6}
2025-10-19 23:58:04,362 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-19 23:58:04,363 - sqlalchemy.engine.Engine - INFO - [cached since 0.04944s ago] {'pk_1': 8}
2025-10-19 23:58:04,374 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:04,376 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:29,013 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:29,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:29,014 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:29,016 - sqlalchemy.engine.Engine - INFO - [cached since 101.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:29,017 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:29,017 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:29,019 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:29,022 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:29,023 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:29,024 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:29,024 - sqlalchemy.engine.Engine - INFO - [cached since 101.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:29,027 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:29,027 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:29,028 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:29,029 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0ODEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.LcI960KNVfGjx9xlpccR4aBQlbpJ1eyf67ewdt6-Lw8
2025-10-19 23:58:29,029 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991481, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:58:29,031 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:29,032 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:58:29,033 - sqlalchemy.engine.Engine - INFO - [cached since 100.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:58:29,035 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:58:29,036 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:29,037 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:29,037 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:29,039 - sqlalchemy.engine.Engine - INFO - [cached since 101.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:29,041 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:29,042 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:29,044 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:29,050 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:29,051 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:29,052 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:29,053 - sqlalchemy.engine.Engine - INFO - [cached since 101.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:29,055 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:29,055 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:29,056 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-19 23:58:29,058 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE0ODEsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.LcI960KNVfGjx9xlpccR4aBQlbpJ1eyf67ewdt6-Lw8
2025-10-19 23:58:29,059 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991481, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-19 23:58:29,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:29,061 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-19 23:58:29,062 - sqlalchemy.engine.Engine - INFO - [cached since 100.7s ago] {'id_1': 8, 'param_1': 1}
2025-10-19 23:58:29,063 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-19 23:58:29,067 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:29,090 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-19 23:58:29,091 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-19 23:58:29,093 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-19 23:58:29,093 - sqlalchemy.engine.Engine - INFO - [cached since 101.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-19 23:58:29,095 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-19 23:58:29,095 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-19 23:58:29,096 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:25,625 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:00:30,282 - app.main - INFO - ==================================================
2025-10-20 00:00:30,282 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:00:30,282 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:00:30,282 - app.main - INFO - ==================================================
2025-10-20 00:00:31,537 - app.main - INFO - Starting background tasks...
2025-10-20 00:00:35,779 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:35,872 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:00:35,873 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:00:35,875 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:00:35,876 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:00:35,878 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:00:35,879 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:00:35,881 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:35,889 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:35,889 - sqlalchemy.engine.Engine - INFO - [generated in 0.00126s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:35,892 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:35,893 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:35,895 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:35,896 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:00:35,896 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:00:35,896 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:00:35,897 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:00:35,897 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:00:35,897 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:00:35,898 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:00:35,898 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:00:35,898 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:00:35,898 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:00:35,898 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:00:35,898 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:00:35,898 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:00:35,898 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:00:35,899 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:00:35,899 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:00:35,901 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:35,905 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:35,906 - sqlalchemy.engine.Engine - INFO - [generated in 0.00119s] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:00:35,910 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-20 00:00:35,910 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-20 00:00:36,285 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,292 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,294 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,295 - sqlalchemy.engine.Engine - INFO - [cached since 0.4069s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,298 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,298 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,309 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,315 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,317 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,318 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,319 - sqlalchemy.engine.Engine - INFO - [cached since 0.4309s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,322 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,322 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,323 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:36,325 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2MzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.fySuqXk7w5FDCCB8YGWMHUfc8pITPtT3OywKAcbETzM
2025-10-20 00:00:36,325 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991636, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:36,326 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,328 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:36,329 - sqlalchemy.engine.Engine - INFO - [generated in 0.00134s] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:36,332 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:36,345 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,773 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,774 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,775 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,776 - sqlalchemy.engine.Engine - INFO - [cached since 0.8877s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,778 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,778 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,780 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:36,784 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,785 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,786 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,788 - sqlalchemy.engine.Engine - INFO - [cached since 0.8991s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,789 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,790 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,791 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:36,793 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2MzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.fySuqXk7w5FDCCB8YGWMHUfc8pITPtT3OywKAcbETzM
2025-10-20 00:00:36,793 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991636, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:36,794 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,795 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:36,796 - sqlalchemy.engine.Engine - INFO - [cached since 0.4677s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:36,798 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:36,799 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,800 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,801 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,802 - sqlalchemy.engine.Engine - INFO - [cached since 0.9142s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,804 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,805 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,807 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,809 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:00:36,810 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] {'restaurant_id_1': 1}
2025-10-20 00:00:36,816 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,833 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,835 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,836 - sqlalchemy.engine.Engine - INFO - [cached since 0.9477s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,838 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,838 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,839 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:36,856 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,857 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,858 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,859 - sqlalchemy.engine.Engine - INFO - [cached since 0.9712s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,861 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,861 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,863 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:36,868 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,870 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,871 - sqlalchemy.engine.Engine - INFO - [cached since 0.9827s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,874 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,875 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,875 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:36,880 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,880 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,882 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,882 - sqlalchemy.engine.Engine - INFO - [cached since 0.9945s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,884 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,884 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,885 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:36,887 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2MzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.fySuqXk7w5FDCCB8YGWMHUfc8pITPtT3OywKAcbETzM
2025-10-20 00:00:36,888 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991636, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:36,889 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,890 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:36,891 - sqlalchemy.engine.Engine - INFO - [cached since 0.5623s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:36,892 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:36,894 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:36,894 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,895 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:36,896 - sqlalchemy.engine.Engine - INFO - [cached since 1.008s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:36,897 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:36,897 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,901 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:36,916 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:00:36,917 - sqlalchemy.engine.Engine - INFO - [generated in 0.00163s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:00:36,941 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:36,942 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,625 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:37,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,630 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:37,630 - sqlalchemy.engine.Engine - INFO - [cached since 1.742s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:37,633 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:37,634 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,635 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:37,635 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:37,637 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,637 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:37,639 - sqlalchemy.engine.Engine - INFO - [cached since 1.75s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:37,641 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:37,641 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,643 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:37,646 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2MzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.fySuqXk7w5FDCCB8YGWMHUfc8pITPtT3OywKAcbETzM
2025-10-20 00:00:37,646 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991636, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:37,647 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,648 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:37,650 - sqlalchemy.engine.Engine - INFO - [cached since 1.321s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:37,651 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:37,652 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:37,654 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,656 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:37,656 - sqlalchemy.engine.Engine - INFO - [cached since 1.768s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:37,658 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:37,659 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,659 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:37,662 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2MzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.fySuqXk7w5FDCCB8YGWMHUfc8pITPtT3OywKAcbETzM
2025-10-20 00:00:37,662 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991636, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:37,664 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,665 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:37,666 - sqlalchemy.engine.Engine - INFO - [cached since 1.337s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:37,666 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:37,669 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:37,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,689 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:37,691 - sqlalchemy.engine.Engine - INFO - [cached since 1.802s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:37,693 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:37,694 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,696 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,697 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,701 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:37,703 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,708 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:37,709 - sqlalchemy.engine.Engine - INFO - [cached since 1.821s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:37,712 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:37,712 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,714 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:37,718 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2MzYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.fySuqXk7w5FDCCB8YGWMHUfc8pITPtT3OywKAcbETzM
2025-10-20 00:00:37,719 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991636, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:37,720 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,721 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:37,724 - sqlalchemy.engine.Engine - INFO - [cached since 1.396s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:37,726 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:37,728 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:37,729 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,730 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:37,731 - sqlalchemy.engine.Engine - INFO - [cached since 1.843s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:37,734 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:37,734 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,737 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:37,737 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:00:37,739 - sqlalchemy.engine.Engine - INFO - [cached since 0.9296s ago] {'restaurant_id_1': 1}
2025-10-20 00:00:37,745 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:37,748 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,310 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:54,312 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,314 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:54,316 - sqlalchemy.engine.Engine - INFO - [cached since 18.43s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:54,318 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:54,319 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,321 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:54,323 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:00:54,323 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:00:54,323 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:00:54,324 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:00:54,324 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:00:54,324 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:00:54,324 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:00:54,324 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:00:54,324 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:00:54,324 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:00:54,326 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:00:54,326 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:00:54,327 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:00:54,327 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:00:54,328 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:00:54,328 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:00:54,331 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,333 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:54,335 - sqlalchemy.engine.Engine - INFO - [cached since 18.43s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:00:54,756 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:54,757 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,760 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:54,761 - sqlalchemy.engine.Engine - INFO - [cached since 18.87s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:54,765 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:54,765 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,774 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,782 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:54,785 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,785 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:54,788 - sqlalchemy.engine.Engine - INFO - [cached since 18.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:54,794 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:54,794 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,799 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:54,802 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jd4QdHzGg7nAuF8i8HOvzSMsZQso-Bb1l-oCfjAGbtI
2025-10-20 00:00:54,802 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991654, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:54,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,805 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:54,806 - sqlalchemy.engine.Engine - INFO - [cached since 18.48s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:54,808 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:54,812 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,861 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:54,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,864 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:54,866 - sqlalchemy.engine.Engine - INFO - [cached since 18.98s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:54,869 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:54,870 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,872 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:54,874 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jd4QdHzGg7nAuF8i8HOvzSMsZQso-Bb1l-oCfjAGbtI
2025-10-20 00:00:54,874 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991654, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:54,875 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,877 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:54,878 - sqlalchemy.engine.Engine - INFO - [cached since 18.55s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:54,880 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:54,882 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:54,883 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,884 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:54,884 - sqlalchemy.engine.Engine - INFO - [cached since 19s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:54,887 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:54,887 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,888 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,889 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:00:54,890 - sqlalchemy.engine.Engine - INFO - [cached since 18.08s ago] {'restaurant_id_1': 1}
2025-10-20 00:00:54,896 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,899 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,904 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:54,904 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,906 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:54,908 - sqlalchemy.engine.Engine - INFO - [cached since 19.02s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:54,913 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:54,914 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,917 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:54,937 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:54,940 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,941 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:54,942 - sqlalchemy.engine.Engine - INFO - [cached since 19.05s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:54,946 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:54,946 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,949 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:54,951 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jd4QdHzGg7nAuF8i8HOvzSMsZQso-Bb1l-oCfjAGbtI
2025-10-20 00:00:54,951 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991654, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:54,953 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,954 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:54,954 - sqlalchemy.engine.Engine - INFO - [cached since 18.63s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:54,958 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:54,960 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:54,961 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,963 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:54,964 - sqlalchemy.engine.Engine - INFO - [cached since 19.08s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:54,969 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:54,970 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:54,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:54,976 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:00:54,979 - sqlalchemy.engine.Engine - INFO - [cached since 18.06s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:00:55,009 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:55,012 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:56,764 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:56,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:56,766 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:56,767 - sqlalchemy.engine.Engine - INFO - [cached since 20.88s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:56,769 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:56,770 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:56,771 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:56,776 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:56,777 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:56,780 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:56,780 - sqlalchemy.engine.Engine - INFO - [cached since 20.89s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:56,782 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:56,782 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:56,784 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:56,786 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jd4QdHzGg7nAuF8i8HOvzSMsZQso-Bb1l-oCfjAGbtI
2025-10-20 00:00:56,786 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991654, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:56,787 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:56,787 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:56,789 - sqlalchemy.engine.Engine - INFO - [cached since 20.46s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:56,790 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:56,792 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:56,792 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:56,794 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:56,795 - sqlalchemy.engine.Engine - INFO - [cached since 20.91s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:56,797 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:56,797 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:56,801 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:56,817 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:00:56,818 - sqlalchemy.engine.Engine - INFO - [generated in 0.00176s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:00:56,838 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,839 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] {'pk_1': 9}
2025-10-20 00:00:56,842 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,842 - sqlalchemy.engine.Engine - INFO - [cached since 0.004442s ago] {'pk_1': 16}
2025-10-20 00:00:56,845 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,846 - sqlalchemy.engine.Engine - INFO - [cached since 0.008034s ago] {'pk_1': 15}
2025-10-20 00:00:56,849 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,849 - sqlalchemy.engine.Engine - INFO - [cached since 0.01156s ago] {'pk_1': 13}
2025-10-20 00:00:56,851 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,852 - sqlalchemy.engine.Engine - INFO - [cached since 0.01441s ago] {'pk_1': 14}
2025-10-20 00:00:56,855 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,856 - sqlalchemy.engine.Engine - INFO - [cached since 0.01732s ago] {'pk_1': 18}
2025-10-20 00:00:56,858 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,858 - sqlalchemy.engine.Engine - INFO - [cached since 0.02031s ago] {'pk_1': 21}
2025-10-20 00:00:56,862 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,863 - sqlalchemy.engine.Engine - INFO - [cached since 0.02429s ago] {'pk_1': 19}
2025-10-20 00:00:56,866 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,866 - sqlalchemy.engine.Engine - INFO - [cached since 0.02784s ago] {'pk_1': 22}
2025-10-20 00:00:56,870 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,870 - sqlalchemy.engine.Engine - INFO - [cached since 0.03211s ago] {'pk_1': 7}
2025-10-20 00:00:56,873 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,873 - sqlalchemy.engine.Engine - INFO - [cached since 0.03467s ago] {'pk_1': 5}
2025-10-20 00:00:56,875 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,876 - sqlalchemy.engine.Engine - INFO - [cached since 0.03766s ago] {'pk_1': 6}
2025-10-20 00:00:56,878 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:56,879 - sqlalchemy.engine.Engine - INFO - [cached since 0.04053s ago] {'pk_1': 8}
2025-10-20 00:00:56,889 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:56,890 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,231 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:58,233 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,235 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:58,236 - sqlalchemy.engine.Engine - INFO - [cached since 22.35s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:58,242 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:58,244 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,247 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:58,250 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jd4QdHzGg7nAuF8i8HOvzSMsZQso-Bb1l-oCfjAGbtI
2025-10-20 00:00:58,250 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991654, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:58,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,254 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:58,256 - sqlalchemy.engine.Engine - INFO - [cached since 21.93s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:58,258 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:58,263 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,268 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:58,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,271 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:58,272 - sqlalchemy.engine.Engine - INFO - [cached since 22.38s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:58,279 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:58,280 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,283 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:58,286 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jd4QdHzGg7nAuF8i8HOvzSMsZQso-Bb1l-oCfjAGbtI
2025-10-20 00:00:58,287 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991654, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:58,288 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,290 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:58,291 - sqlalchemy.engine.Engine - INFO - [cached since 21.96s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:58,294 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:58,295 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:58,297 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,299 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:58,301 - sqlalchemy.engine.Engine - INFO - [cached since 22.41s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:58,305 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:58,305 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,308 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,314 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:58,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,316 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:58,318 - sqlalchemy.engine.Engine - INFO - [cached since 22.43s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:58,321 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:58,321 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,322 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:58,338 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:58,339 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,340 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:58,344 - sqlalchemy.engine.Engine - INFO - [cached since 22.46s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:58,346 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:58,347 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,349 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:00:58,350 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jd4QdHzGg7nAuF8i8HOvzSMsZQso-Bb1l-oCfjAGbtI
2025-10-20 00:00:58,351 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991654, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:00:58,352 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,353 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:00:58,354 - sqlalchemy.engine.Engine - INFO - [cached since 22.03s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:00:58,356 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:00:58,358 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:00:58,358 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,359 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:00:58,360 - sqlalchemy.engine.Engine - INFO - [cached since 22.47s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:00:58,363 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:00:58,363 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,366 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:00:58,366 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:00:58,368 - sqlalchemy.engine.Engine - INFO - [cached since 1.552s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:00:58,387 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,388 - sqlalchemy.engine.Engine - INFO - [cached since 1.549s ago] {'pk_1': 9}
2025-10-20 00:00:58,390 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,390 - sqlalchemy.engine.Engine - INFO - [cached since 1.553s ago] {'pk_1': 16}
2025-10-20 00:00:58,393 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,395 - sqlalchemy.engine.Engine - INFO - [cached since 1.556s ago] {'pk_1': 15}
2025-10-20 00:00:58,397 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,398 - sqlalchemy.engine.Engine - INFO - [cached since 1.56s ago] {'pk_1': 13}
2025-10-20 00:00:58,400 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,401 - sqlalchemy.engine.Engine - INFO - [cached since 1.562s ago] {'pk_1': 14}
2025-10-20 00:00:58,402 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,404 - sqlalchemy.engine.Engine - INFO - [cached since 1.565s ago] {'pk_1': 18}
2025-10-20 00:00:58,406 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,406 - sqlalchemy.engine.Engine - INFO - [cached since 1.569s ago] {'pk_1': 21}
2025-10-20 00:00:58,410 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,410 - sqlalchemy.engine.Engine - INFO - [cached since 1.572s ago] {'pk_1': 19}
2025-10-20 00:00:58,412 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,414 - sqlalchemy.engine.Engine - INFO - [cached since 1.575s ago] {'pk_1': 22}
2025-10-20 00:00:58,417 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,418 - sqlalchemy.engine.Engine - INFO - [cached since 1.579s ago] {'pk_1': 7}
2025-10-20 00:00:58,419 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,420 - sqlalchemy.engine.Engine - INFO - [cached since 1.582s ago] {'pk_1': 5}
2025-10-20 00:00:58,422 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,423 - sqlalchemy.engine.Engine - INFO - [cached since 1.585s ago] {'pk_1': 6}
2025-10-20 00:00:58,427 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:00:58,429 - sqlalchemy.engine.Engine - INFO - [cached since 1.591s ago] {'pk_1': 8}
2025-10-20 00:00:58,438 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:00:58,440 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,483 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:06,484 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,484 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:06,485 - sqlalchemy.engine.Engine - INFO - [cached since 30.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:06,486 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:06,487 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,488 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:01:06,489 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:01:06,489 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:01:06,489 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:01:06,490 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:01:06,490 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:01:06,490 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:01:06,490 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:01:06,490 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:01:06,490 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:01:06,490 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:01:06,491 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:01:06,491 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:01:06,491 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:01:06,491 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:01:06,491 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:01:06,491 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:01:06,494 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,496 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:01:06,496 - sqlalchemy.engine.Engine - INFO - [cached since 30.59s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:01:06,815 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:06,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,817 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:06,819 - sqlalchemy.engine.Engine - INFO - [cached since 30.93s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:06,821 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:06,822 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,827 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,835 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:06,837 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,837 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:06,840 - sqlalchemy.engine.Engine - INFO - [cached since 30.95s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:06,843 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:06,844 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,846 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:01:06,847 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.hAQZr-yYj-rNXMVtuKYaEDI2VGkx5QRhALfX1I1EPuA
2025-10-20 00:01:06,847 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991666, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:01:06,849 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,850 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:01:06,851 - sqlalchemy.engine.Engine - INFO - [cached since 30.52s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:01:06,853 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:01:06,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,924 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:06,926 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,927 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:06,928 - sqlalchemy.engine.Engine - INFO - [cached since 31.04s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:06,930 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:06,932 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,933 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:01:06,936 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.hAQZr-yYj-rNXMVtuKYaEDI2VGkx5QRhALfX1I1EPuA
2025-10-20 00:01:06,936 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991666, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:01:06,938 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,938 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:01:06,939 - sqlalchemy.engine.Engine - INFO - [cached since 30.61s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:01:06,941 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:01:06,942 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:06,944 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,945 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:06,946 - sqlalchemy.engine.Engine - INFO - [cached since 31.06s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:06,948 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:06,949 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,951 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,951 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:01:06,952 - sqlalchemy.engine.Engine - INFO - [cached since 30.14s ago] {'restaurant_id_1': 1}
2025-10-20 00:01:06,956 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,958 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,966 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:06,967 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,968 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:06,968 - sqlalchemy.engine.Engine - INFO - [cached since 31.08s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:06,970 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:06,971 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,972 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:01:06,978 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:06,979 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,980 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:06,981 - sqlalchemy.engine.Engine - INFO - [cached since 31.09s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:06,982 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:06,982 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:06,986 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:01:06,989 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.hAQZr-yYj-rNXMVtuKYaEDI2VGkx5QRhALfX1I1EPuA
2025-10-20 00:01:06,989 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991666, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:01:06,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,990 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:01:06,992 - sqlalchemy.engine.Engine - INFO - [cached since 30.66s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:01:06,995 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:01:06,995 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:06,997 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:06,998 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:06,999 - sqlalchemy.engine.Engine - INFO - [cached since 31.11s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:07,001 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:07,001 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:07,004 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:07,004 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:01:07,006 - sqlalchemy.engine.Engine - INFO - [cached since 30.09s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:01:07,025 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:07,028 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:12,054 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:12,054 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:12,056 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:12,056 - sqlalchemy.engine.Engine - INFO - [cached since 36.17s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:12,059 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:12,059 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:12,060 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:01:12,061 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.hAQZr-yYj-rNXMVtuKYaEDI2VGkx5QRhALfX1I1EPuA
2025-10-20 00:01:12,062 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991666, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:01:12,063 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:12,064 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:01:12,065 - sqlalchemy.engine.Engine - INFO - [cached since 35.74s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:01:12,066 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:01:12,069 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:12,072 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:12,073 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:12,078 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:12,079 - sqlalchemy.engine.Engine - INFO - [cached since 36.19s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:12,081 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:12,081 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:12,082 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:01:12,083 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE2NjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.hAQZr-yYj-rNXMVtuKYaEDI2VGkx5QRhALfX1I1EPuA
2025-10-20 00:01:12,084 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991666, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:01:12,085 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:12,086 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:01:12,087 - sqlalchemy.engine.Engine - INFO - [cached since 35.76s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:01:12,089 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:01:12,090 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:01:12,091 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:01:12,093 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:01:12,094 - sqlalchemy.engine.Engine - INFO - [cached since 36.21s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:01:12,096 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:01:12,096 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:01:12,099 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,026 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:26,028 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,029 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:26,031 - sqlalchemy.engine.Engine - INFO - [cached since 110.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:26,035 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:26,036 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,038 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:02:26,040 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:02:26,040 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:02:26,040 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:02:26,041 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:02:26,041 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:02:26,042 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:02:26,042 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:02:26,043 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:02:26,043 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:02:26,043 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:02:26,044 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:02:26,045 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:02:26,045 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:02:26,045 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:02:26,045 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:02:26,045 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:02:26,050 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,052 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:02:26,053 - sqlalchemy.engine.Engine - INFO - [cached since 110.1s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:02:26,477 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:26,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,481 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:26,482 - sqlalchemy.engine.Engine - INFO - [cached since 110.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:26,484 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:26,485 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,497 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:26,499 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,499 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:26,501 - sqlalchemy.engine.Engine - INFO - [cached since 110.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:26,504 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:26,505 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,507 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:02:26,508 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE3NDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.onmi3IF021e37R5RzNf276lkoxMZ_S6EMdR_KgswvWg
2025-10-20 00:02:26,508 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991746, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:02:26,509 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,510 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:02:26,512 - sqlalchemy.engine.Engine - INFO - [cached since 110.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:02:26,514 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:02:26,517 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,589 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:26,590 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,592 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:26,594 - sqlalchemy.engine.Engine - INFO - [cached since 110.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:26,598 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:26,599 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,601 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:02:26,602 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE3NDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.onmi3IF021e37R5RzNf276lkoxMZ_S6EMdR_KgswvWg
2025-10-20 00:02:26,604 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991746, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:02:26,605 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,606 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:02:26,607 - sqlalchemy.engine.Engine - INFO - [cached since 110.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:02:26,611 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:02:26,613 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:26,614 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,615 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:26,618 - sqlalchemy.engine.Engine - INFO - [cached since 110.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:26,620 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:26,621 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,624 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,624 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:02:26,626 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'restaurant_id_1': 1}
2025-10-20 00:02:26,632 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,636 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,644 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:26,645 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,646 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:26,647 - sqlalchemy.engine.Engine - INFO - [cached since 110.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:26,652 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:26,653 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,655 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:02:26,661 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:26,661 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,664 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:26,666 - sqlalchemy.engine.Engine - INFO - [cached since 110.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:26,669 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:26,670 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,671 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:02:26,673 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE3NDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.onmi3IF021e37R5RzNf276lkoxMZ_S6EMdR_KgswvWg
2025-10-20 00:02:26,675 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991746, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:02:26,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,678 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:02:26,678 - sqlalchemy.engine.Engine - INFO - [cached since 110.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:02:26,682 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:02:26,684 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:26,684 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,687 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:26,690 - sqlalchemy.engine.Engine - INFO - [cached since 110.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:26,693 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:26,693 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,697 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:26,698 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:02:26,699 - sqlalchemy.engine.Engine - INFO - [cached since 109.8s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:02:26,718 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:26,720 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:27,780 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:27,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:27,782 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:27,782 - sqlalchemy.engine.Engine - INFO - [cached since 111.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:27,786 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:27,787 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:27,789 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:02:27,790 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE3NDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.onmi3IF021e37R5RzNf276lkoxMZ_S6EMdR_KgswvWg
2025-10-20 00:02:27,791 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991746, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:02:27,791 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:27,792 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:02:27,794 - sqlalchemy.engine.Engine - INFO - [cached since 111.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:02:27,795 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:02:27,797 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:02:27,798 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:02:27,798 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:02:27,800 - sqlalchemy.engine.Engine - INFO - [cached since 111.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:02:27,802 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:02:27,802 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:02:27,804 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,154 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:27,156 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,158 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:27,159 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:27,161 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:27,161 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,161 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:03:27,164 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:03:27,164 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:03:27,164 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:03:27,164 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:03:27,164 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:03:27,164 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:03:27,166 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:03:27,166 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:03:27,167 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:03:27,167 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:03:27,167 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:03:27,167 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:03:27,167 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:03:27,167 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:03:27,167 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:03:27,167 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:03:27,170 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,170 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:03:27,172 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:03:27,495 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:27,496 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,497 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:27,497 - sqlalchemy.engine.Engine - INFO - [cached since 171.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:27,500 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:27,500 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,504 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,509 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:27,510 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,511 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:27,512 - sqlalchemy.engine.Engine - INFO - [cached since 171.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:27,514 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:27,514 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,516 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:03:27,518 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE4MDcsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8Z9tPZ31WGZ89jxe65zQ5Q_lA_f8MdsTt5E8VfeepNA
2025-10-20 00:03:27,518 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991807, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:03:27,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,519 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:03:27,521 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:03:27,523 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:03:27,525 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,601 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:27,603 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,605 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:27,607 - sqlalchemy.engine.Engine - INFO - [cached since 171.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:27,609 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:27,610 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,612 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:03:27,614 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE4MDcsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8Z9tPZ31WGZ89jxe65zQ5Q_lA_f8MdsTt5E8VfeepNA
2025-10-20 00:03:27,616 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991807, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:03:27,617 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,619 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:03:27,620 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:03:27,622 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:03:27,624 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:27,625 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,626 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:27,627 - sqlalchemy.engine.Engine - INFO - [cached since 171.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:27,630 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:27,630 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,633 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,634 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:03:27,635 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {'restaurant_id_1': 1}
2025-10-20 00:03:27,641 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,644 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,655 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:27,656 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,658 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:27,659 - sqlalchemy.engine.Engine - INFO - [cached since 171.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:27,662 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:27,662 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,664 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:03:27,670 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:27,672 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,673 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:27,676 - sqlalchemy.engine.Engine - INFO - [cached since 171.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:27,680 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:27,680 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,682 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:03:27,685 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE4MDcsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8Z9tPZ31WGZ89jxe65zQ5Q_lA_f8MdsTt5E8VfeepNA
2025-10-20 00:03:27,687 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991807, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:03:27,689 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,690 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:03:27,691 - sqlalchemy.engine.Engine - INFO - [cached since 171.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:03:27,693 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:03:27,695 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:27,696 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,697 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:27,698 - sqlalchemy.engine.Engine - INFO - [cached since 171.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:27,700 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:27,700 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,703 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:27,703 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:03:27,705 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:03:27,728 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:27,730 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:40,800 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:40,801 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:40,802 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:40,802 - sqlalchemy.engine.Engine - INFO - [cached since 184.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:40,804 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:40,805 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:40,806 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:03:40,808 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE4MDcsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.8Z9tPZ31WGZ89jxe65zQ5Q_lA_f8MdsTt5E8VfeepNA
2025-10-20 00:03:40,809 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991807, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:03:40,810 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:40,811 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:03:40,811 - sqlalchemy.engine.Engine - INFO - [cached since 184.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:03:40,814 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:03:40,815 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:03:40,816 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:03:40,817 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:03:40,820 - sqlalchemy.engine.Engine - INFO - [cached since 184.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:03:40,824 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:03:40,824 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:03:40,827 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:06,495 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:06,497 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:06,498 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:06,501 - sqlalchemy.engine.Engine - INFO - [cached since 270.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:06,504 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:06,504 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:06,506 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:06,508 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:05:06,509 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:05:06,509 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:05:06,509 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:05:06,509 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:05:06,509 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:05:06,509 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:05:06,509 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:05:06,509 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:05:06,511 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:05:06,511 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:05:06,511 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:05:06,511 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:05:06,511 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:05:06,512 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:05:06,512 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:05:06,514 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:06,516 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:06,517 - sqlalchemy.engine.Engine - INFO - [cached since 270.6s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:05:06,863 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:06,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:06,865 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:06,865 - sqlalchemy.engine.Engine - INFO - [cached since 271s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:06,869 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:06,869 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:06,875 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:06,879 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:06,880 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:06,882 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:06,883 - sqlalchemy.engine.Engine - INFO - [cached since 271s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:06,886 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:06,886 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:06,887 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:06,888 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE5MDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.5SlVmorfShm1RsTpYfuH3XLNYvtdLeIo8tG7Y_eW5B4
2025-10-20 00:05:06,889 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991906, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:05:06,890 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:06,892 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:06,893 - sqlalchemy.engine.Engine - INFO - [cached since 270.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:05:06,896 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:05:06,900 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:06,957 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:06,959 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:06,963 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:06,970 - sqlalchemy.engine.Engine - INFO - [cached since 271.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:06,981 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:06,981 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:06,986 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:06,988 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE5MDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.5SlVmorfShm1RsTpYfuH3XLNYvtdLeIo8tG7Y_eW5B4
2025-10-20 00:05:06,989 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991906, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:05:06,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:06,995 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:07,000 - sqlalchemy.engine.Engine - INFO - [cached since 270.7s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:05:07,010 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:05:07,011 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:07,012 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:07,017 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:07,020 - sqlalchemy.engine.Engine - INFO - [cached since 271.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:07,026 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:07,026 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:07,036 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:07,039 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:05:07,042 - sqlalchemy.engine.Engine - INFO - [cached since 270.2s ago] {'restaurant_id_1': 1}
2025-10-20 00:05:07,049 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:07,051 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:07,058 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:07,059 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:07,061 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:07,061 - sqlalchemy.engine.Engine - INFO - [cached since 271.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:07,064 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:07,064 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:07,070 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:07,078 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:07,079 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:07,081 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:07,082 - sqlalchemy.engine.Engine - INFO - [cached since 271.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:07,084 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:07,084 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:07,084 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:07,088 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE5MDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.5SlVmorfShm1RsTpYfuH3XLNYvtdLeIo8tG7Y_eW5B4
2025-10-20 00:05:07,088 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991906, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:05:07,089 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:07,089 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:07,090 - sqlalchemy.engine.Engine - INFO - [cached since 270.8s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:05:07,092 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:05:07,092 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:07,094 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:07,095 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:07,096 - sqlalchemy.engine.Engine - INFO - [cached since 271.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:07,097 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:07,098 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:07,099 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:07,100 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:05:07,102 - sqlalchemy.engine.Engine - INFO - [cached since 270.2s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:05:07,119 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:07,121 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:08,186 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:08,187 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:08,188 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:08,188 - sqlalchemy.engine.Engine - INFO - [cached since 272.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:08,190 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:08,191 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:08,192 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:08,194 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE5MDYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.5SlVmorfShm1RsTpYfuH3XLNYvtdLeIo8tG7Y_eW5B4
2025-10-20 00:05:08,194 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991906, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:05:08,196 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:08,197 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:08,197 - sqlalchemy.engine.Engine - INFO - [cached since 271.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:05:08,199 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:05:08,200 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:08,202 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:08,203 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:08,204 - sqlalchemy.engine.Engine - INFO - [cached since 272.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:08,206 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:08,207 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:08,208 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:16,794 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:05:19,802 - app.main - INFO - ==================================================
2025-10-20 00:05:19,802 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:05:19,804 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:05:19,804 - app.main - INFO - ==================================================
2025-10-20 00:05:21,091 - app.main - INFO - Starting background tasks...
2025-10-20 00:05:26,499 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:26,608 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:05:26,609 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:05:26,611 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:05:26,612 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:05:26,614 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:05:26,615 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:05:26,617 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:26,632 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:26,637 - sqlalchemy.engine.Engine - INFO - [generated in 0.00541s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:26,647 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:26,649 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:26,654 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:26,656 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:05:26,657 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:05:26,658 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:05:26,658 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:05:26,658 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:05:26,658 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:05:26,658 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:05:26,660 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:05:26,664 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:26,667 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:26,668 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:05:26,671 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-20 00:05:26,672 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-20 00:05:27,090 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:27,097 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,099 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:27,099 - sqlalchemy.engine.Engine - INFO - [cached since 0.4681s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:27,101 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:27,101 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,131 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,138 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:27,139 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,142 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:27,145 - sqlalchemy.engine.Engine - INFO - [cached since 0.5137s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:27,152 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:27,152 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,157 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:27,159 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE5MjcsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.P-zQxuAbAL5o-ouzrHQxJYgwJrFjSa1qKmgUqUQJWIw
2025-10-20 00:05:27,159 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991927, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:05:27,160 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,164 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:27,167 - sqlalchemy.engine.Engine - INFO - [generated in 0.00325s] {'id_1': 8, 'param_1': 1}
2025-10-20 00:05:27,173 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:05:27,189 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,687 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:27,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,689 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:27,690 - sqlalchemy.engine.Engine - INFO - [cached since 1.059s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:27,692 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:27,692 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,694 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:27,695 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE5MjcsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.P-zQxuAbAL5o-ouzrHQxJYgwJrFjSa1qKmgUqUQJWIw
2025-10-20 00:05:27,696 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991927, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:05:27,697 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,698 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:27,699 - sqlalchemy.engine.Engine - INFO - [cached since 0.5355s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:05:27,701 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:05:27,701 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:27,703 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,704 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:27,704 - sqlalchemy.engine.Engine - INFO - [cached since 1.073s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:27,707 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:27,708 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,710 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,713 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:05:27,714 - sqlalchemy.engine.Engine - INFO - [generated in 0.00118s] {'restaurant_id_1': 1}
2025-10-20 00:05:27,719 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,721 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,729 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:27,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,731 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:27,732 - sqlalchemy.engine.Engine - INFO - [cached since 1.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:27,734 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:27,734 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,735 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:27,742 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:27,742 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,744 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:27,745 - sqlalchemy.engine.Engine - INFO - [cached since 1.113s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:27,748 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:27,748 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,750 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:27,751 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE5MjcsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.P-zQxuAbAL5o-ouzrHQxJYgwJrFjSa1qKmgUqUQJWIw
2025-10-20 00:05:27,751 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991927, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:05:27,752 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,754 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:27,754 - sqlalchemy.engine.Engine - INFO - [cached since 0.5907s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:05:27,756 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:05:27,757 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:27,758 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,758 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:27,759 - sqlalchemy.engine.Engine - INFO - [cached since 1.128s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:27,762 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:27,762 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,766 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:27,779 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:05:27,780 - sqlalchemy.engine.Engine - INFO - [generated in 0.00140s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:05:27,804 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:27,806 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:33,584 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:33,586 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:33,587 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:33,588 - sqlalchemy.engine.Engine - INFO - [cached since 6.956s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:33,589 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:33,590 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:33,591 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:05:33,593 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTE5MjcsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.P-zQxuAbAL5o-ouzrHQxJYgwJrFjSa1qKmgUqUQJWIw
2025-10-20 00:05:33,593 - app.services.user - DEBUG - Decoded payload: {'exp': 1760991927, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:05:33,595 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:33,596 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:05:33,599 - sqlalchemy.engine.Engine - INFO - [cached since 6.435s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:05:33,602 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:05:33,603 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:05:33,604 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:05:33,605 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:05:33,606 - sqlalchemy.engine.Engine - INFO - [cached since 6.974s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:05:33,608 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:05:33,608 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:05:33,610 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:41,693 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:41,695 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:41,697 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:41,698 - sqlalchemy.engine.Engine - INFO - [cached since 135.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:41,700 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:41,701 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:41,704 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:07:41,705 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:07:41,705 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:07:41,706 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:07:41,707 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:07:41,707 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:07:41,707 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:07:41,707 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:07:41,708 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:07:41,710 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:41,715 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:07:41,716 - sqlalchemy.engine.Engine - INFO - [cached since 135s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:07:42,057 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:42,059 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,059 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:42,060 - sqlalchemy.engine.Engine - INFO - [cached since 135.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:42,063 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:42,064 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,068 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,073 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:42,074 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,075 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:42,076 - sqlalchemy.engine.Engine - INFO - [cached since 135.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:42,078 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:42,078 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,080 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:07:42,081 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIwNjIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.gYOkNTqItFao6Vb2OYLdMNp-DPmC2n1iA-22ISsTFD4
2025-10-20 00:07:42,081 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992062, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:07:42,082 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,083 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:07:42,085 - sqlalchemy.engine.Engine - INFO - [cached since 134.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:07:42,087 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:07:42,090 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,153 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:42,154 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,156 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:42,156 - sqlalchemy.engine.Engine - INFO - [cached since 135.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:42,158 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:42,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,160 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:07:42,161 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIwNjIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.gYOkNTqItFao6Vb2OYLdMNp-DPmC2n1iA-22ISsTFD4
2025-10-20 00:07:42,161 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992062, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:07:42,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,163 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:07:42,165 - sqlalchemy.engine.Engine - INFO - [cached since 135s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:07:42,166 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:07:42,167 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:42,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,169 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:42,170 - sqlalchemy.engine.Engine - INFO - [cached since 135.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:42,172 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:42,172 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,173 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,174 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:07:42,174 - sqlalchemy.engine.Engine - INFO - [cached since 134.5s ago] {'restaurant_id_1': 1}
2025-10-20 00:07:42,180 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,188 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:42,188 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,190 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:42,191 - sqlalchemy.engine.Engine - INFO - [cached since 135.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:42,192 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:42,192 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,195 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:07:42,200 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:42,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,201 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:42,201 - sqlalchemy.engine.Engine - INFO - [cached since 135.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:42,204 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:42,204 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,205 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:07:42,207 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIwNjIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.gYOkNTqItFao6Vb2OYLdMNp-DPmC2n1iA-22ISsTFD4
2025-10-20 00:07:42,207 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992062, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:07:42,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,209 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:07:42,209 - sqlalchemy.engine.Engine - INFO - [cached since 135s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:07:42,211 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:07:42,212 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:42,213 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,214 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:42,218 - sqlalchemy.engine.Engine - INFO - [cached since 135.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:42,220 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:42,220 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,223 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:42,224 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:07:42,224 - sqlalchemy.engine.Engine - INFO - [cached since 134.4s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:07:42,244 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:42,246 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:43,414 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:43,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:43,416 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:43,417 - sqlalchemy.engine.Engine - INFO - [cached since 136.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:43,419 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:43,419 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:43,421 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:07:43,422 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIwNjIsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.gYOkNTqItFao6Vb2OYLdMNp-DPmC2n1iA-22ISsTFD4
2025-10-20 00:07:43,422 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992062, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:07:43,423 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:43,424 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:07:43,424 - sqlalchemy.engine.Engine - INFO - [cached since 136.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:07:43,426 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:07:43,427 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:07:43,428 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:07:43,429 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:07:43,430 - sqlalchemy.engine.Engine - INFO - [cached since 136.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:07:43,433 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:07:43,434 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:07:43,439 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,254 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:24,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,257 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:24,258 - sqlalchemy.engine.Engine - INFO - [cached since 177.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:24,261 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:24,261 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,263 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:08:24,265 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:08:24,266 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:08:24,266 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:08:24,266 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:08:24,267 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:08:24,268 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:08:24,268 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:08:24,268 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:08:24,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,272 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:08:24,272 - sqlalchemy.engine.Engine - INFO - [cached since 177.6s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:08:24,604 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:24,606 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,607 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:24,607 - sqlalchemy.engine.Engine - INFO - [cached since 178s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:24,610 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:24,611 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,613 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,620 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:24,621 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,621 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:24,622 - sqlalchemy.engine.Engine - INFO - [cached since 178s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:24,626 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:24,626 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,628 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:08:24,629 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxMDQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.DAxbmkeEfRsIiNRR_SJdlA02LZP0GJMN8Ay9MhJkJso
2025-10-20 00:08:24,629 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992104, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:08:24,631 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,632 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:08:24,633 - sqlalchemy.engine.Engine - INFO - [cached since 177.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:08:24,634 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:08:24,638 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,715 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:24,717 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,718 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:24,721 - sqlalchemy.engine.Engine - INFO - [cached since 178.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:24,724 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:24,724 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,727 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:08:24,731 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxMDQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.DAxbmkeEfRsIiNRR_SJdlA02LZP0GJMN8Ay9MhJkJso
2025-10-20 00:08:24,732 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992104, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:08:24,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,734 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:08:24,735 - sqlalchemy.engine.Engine - INFO - [cached since 177.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:08:24,739 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:08:24,740 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:24,741 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,742 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:24,743 - sqlalchemy.engine.Engine - INFO - [cached since 178.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:24,745 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:24,745 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,748 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,749 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:08:24,751 - sqlalchemy.engine.Engine - INFO - [cached since 177s ago] {'restaurant_id_1': 1}
2025-10-20 00:08:24,756 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,758 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,771 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:24,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,773 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:24,774 - sqlalchemy.engine.Engine - INFO - [cached since 178.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:24,777 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:24,777 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,779 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:08:24,788 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:24,788 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,789 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:24,791 - sqlalchemy.engine.Engine - INFO - [cached since 178.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:24,792 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:24,793 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,794 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:08:24,796 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxMDQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.DAxbmkeEfRsIiNRR_SJdlA02LZP0GJMN8Ay9MhJkJso
2025-10-20 00:08:24,796 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992104, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:08:24,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,799 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:08:24,800 - sqlalchemy.engine.Engine - INFO - [cached since 177.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:08:24,803 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:08:24,803 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:24,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,804 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:24,807 - sqlalchemy.engine.Engine - INFO - [cached since 178.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:24,808 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:24,808 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:24,811 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:08:24,813 - sqlalchemy.engine.Engine - INFO - [cached since 177s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:08:24,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:24,832 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,582 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:31,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:31,586 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:31,588 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:31,591 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:31,591 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,593 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:08:31,596 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxMDQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.DAxbmkeEfRsIiNRR_SJdlA02LZP0GJMN8Ay9MhJkJso
2025-10-20 00:08:31,596 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992104, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:08:31,597 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:31,599 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:08:31,601 - sqlalchemy.engine.Engine - INFO - [cached since 184.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:08:31,602 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:08:31,604 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:31,604 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:31,606 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:31,607 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:31,609 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:31,609 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,612 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,619 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:31,620 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:31,622 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:31,622 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:31,625 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:31,625 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,628 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:08:31,631 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxMDQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.DAxbmkeEfRsIiNRR_SJdlA02LZP0GJMN8Ay9MhJkJso
2025-10-20 00:08:31,631 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992104, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:08:31,632 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:31,632 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:08:31,634 - sqlalchemy.engine.Engine - INFO - [cached since 184.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:08:31,637 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:08:31,638 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:31,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:31,641 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:31,643 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:31,646 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:31,646 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,647 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:31,650 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:08:31,650 - sqlalchemy.engine.Engine - INFO - [cached since 183.9s ago] {'restaurant_id_1': 1}
2025-10-20 00:08:31,656 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,659 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,718 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:08:31,720 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:08:31,721 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:08:31,722 - sqlalchemy.engine.Engine - INFO - [cached since 185.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:08:31,724 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:08:31,724 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:08:31,725 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:15,709 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:09:18,258 - app.main - INFO - ==================================================
2025-10-20 00:09:18,258 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:09:18,259 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:09:18,260 - app.main - INFO - ==================================================
2025-10-20 00:09:18,962 - app.main - INFO - Starting background tasks...
2025-10-20 00:09:24,746 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:24,843 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:09:24,844 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:09:24,846 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:09:24,847 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:09:24,848 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:09:24,849 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:09:24,851 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:24,857 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:24,859 - sqlalchemy.engine.Engine - INFO - [generated in 0.00205s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:24,861 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:24,862 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:24,862 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:24,864 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:09:24,865 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:09:24,865 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:09:24,865 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:09:24,865 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:09:24,866 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:09:24,866 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:09:24,866 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:09:24,866 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:09:24,866 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:09:24,867 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:09:24,867 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:09:24,867 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:09:24,867 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:09:24,868 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:09:24,868 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:09:24,871 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:24,875 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:24,876 - sqlalchemy.engine.Engine - INFO - [generated in 0.00133s] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:09:24,880 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-20 00:09:24,880 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-20 00:09:25,332 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:25,340 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,341 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:25,343 - sqlalchemy.engine.Engine - INFO - [cached since 0.4861s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:25,345 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:25,345 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,359 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,364 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:25,365 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,366 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:25,367 - sqlalchemy.engine.Engine - INFO - [cached since 0.5115s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:25,371 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:25,371 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,373 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:25,378 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:25,380 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,380 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:25,382 - sqlalchemy.engine.Engine - INFO - [cached since 0.5254s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:25,384 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:25,385 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,387 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:25,388 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNjUsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.p4BYiiv9ML05B23WTtfCcgtzCVWJv43w2SektWV6Q_M
2025-10-20 00:09:25,388 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992165, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:09:25,389 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,390 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:25,392 - sqlalchemy.engine.Engine - INFO - [generated in 0.00086s] {'id_1': 8, 'param_1': 1}
2025-10-20 00:09:25,394 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:09:25,407 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,902 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:25,904 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,906 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:25,907 - sqlalchemy.engine.Engine - INFO - [cached since 1.051s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:25,911 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:25,911 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,911 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:25,916 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNjUsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.p4BYiiv9ML05B23WTtfCcgtzCVWJv43w2SektWV6Q_M
2025-10-20 00:09:25,916 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992165, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:09:25,917 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,921 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:25,922 - sqlalchemy.engine.Engine - INFO - [cached since 0.5309s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:09:25,924 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:09:25,925 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:25,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,929 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:25,930 - sqlalchemy.engine.Engine - INFO - [cached since 1.074s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:25,932 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:25,934 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,937 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,942 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:09:25,942 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] {'restaurant_id_1': 1}
2025-10-20 00:09:25,948 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,952 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,960 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:25,961 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,963 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:25,963 - sqlalchemy.engine.Engine - INFO - [cached since 1.107s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:25,967 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:25,968 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,970 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:25,977 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:25,979 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,980 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:25,983 - sqlalchemy.engine.Engine - INFO - [cached since 1.126s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:25,988 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:25,988 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:25,989 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:25,992 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNjUsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.p4BYiiv9ML05B23WTtfCcgtzCVWJv43w2SektWV6Q_M
2025-10-20 00:09:25,993 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992165, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:09:25,994 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:25,995 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:25,997 - sqlalchemy.engine.Engine - INFO - [cached since 0.6062s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:09:26,001 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:09:26,002 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:26,004 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:26,005 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:26,006 - sqlalchemy.engine.Engine - INFO - [cached since 1.149s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:26,008 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:26,008 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:26,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:26,036 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:09:26,039 - sqlalchemy.engine.Engine - INFO - [generated in 0.00303s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:09:26,071 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:26,073 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:34,076 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:34,077 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:34,078 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:34,079 - sqlalchemy.engine.Engine - INFO - [cached since 9.223s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:34,081 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:34,082 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:34,082 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:34,085 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNjUsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.p4BYiiv9ML05B23WTtfCcgtzCVWJv43w2SektWV6Q_M
2025-10-20 00:09:34,085 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992165, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:09:34,086 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:34,087 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:34,087 - sqlalchemy.engine.Engine - INFO - [cached since 8.697s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:09:34,090 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:09:34,092 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:34,092 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:34,094 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:34,095 - sqlalchemy.engine.Engine - INFO - [cached since 9.238s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:34,097 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:34,097 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:34,100 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,129 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:38,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,130 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:38,130 - sqlalchemy.engine.Engine - INFO - [cached since 13.27s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:38,132 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:38,134 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,135 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:38,137 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:09:38,137 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:09:38,137 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:09:38,138 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:09:38,138 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:09:38,138 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:09:38,138 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:09:38,138 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:09:38,138 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:09:38,139 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:09:38,139 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:09:38,139 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:09:38,140 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:09:38,140 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:09:38,140 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:09:38,140 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:09:38,143 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,144 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:38,145 - sqlalchemy.engine.Engine - INFO - [cached since 13.27s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:09:38,608 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:38,609 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,611 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:38,611 - sqlalchemy.engine.Engine - INFO - [cached since 13.76s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:38,613 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:38,614 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,617 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,625 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:38,626 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,626 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:38,627 - sqlalchemy.engine.Engine - INFO - [cached since 13.77s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:38,630 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:38,630 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,631 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:38,632 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.kEb2s3OawZoMTuH6x2iS71xQKTU-bbyPCjY3z9fZT60
2025-10-20 00:09:38,632 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992178, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:09:38,634 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,635 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:38,636 - sqlalchemy.engine.Engine - INFO - [cached since 13.25s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:09:38,639 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:09:38,642 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,692 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:38,693 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,695 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:38,695 - sqlalchemy.engine.Engine - INFO - [cached since 13.84s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:38,699 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:38,699 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,700 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:38,703 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.kEb2s3OawZoMTuH6x2iS71xQKTU-bbyPCjY3z9fZT60
2025-10-20 00:09:38,704 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992178, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:09:38,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,706 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:38,706 - sqlalchemy.engine.Engine - INFO - [cached since 13.32s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:09:38,708 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:09:38,708 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:38,709 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,711 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:38,711 - sqlalchemy.engine.Engine - INFO - [cached since 13.86s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:38,713 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:38,713 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,716 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,717 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:09:38,717 - sqlalchemy.engine.Engine - INFO - [cached since 12.78s ago] {'restaurant_id_1': 1}
2025-10-20 00:09:38,722 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,724 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,732 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:38,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,734 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:38,735 - sqlalchemy.engine.Engine - INFO - [cached since 13.88s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:38,737 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:38,738 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,739 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:38,754 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:38,755 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,757 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:38,758 - sqlalchemy.engine.Engine - INFO - [cached since 13.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:38,761 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:38,761 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,763 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:09:38,767 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.kEb2s3OawZoMTuH6x2iS71xQKTU-bbyPCjY3z9fZT60
2025-10-20 00:09:38,768 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992178, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:09:38,769 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,771 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:09:38,772 - sqlalchemy.engine.Engine - INFO - [cached since 13.38s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:09:38,774 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:09:38,775 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:09:38,776 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,778 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:09:38,778 - sqlalchemy.engine.Engine - INFO - [cached since 13.92s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:09:38,780 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:09:38,781 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,785 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:09:38,786 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:09:38,788 - sqlalchemy.engine.Engine - INFO - [cached since 12.75s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:09:38,816 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:09:38,817 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:36,971 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:10:36,973 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:10:36,975 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:10:36,976 - sqlalchemy.engine.Engine - INFO - [cached since 72.12s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:10:36,979 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:10:36,979 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:36,980 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:10:36,982 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.kEb2s3OawZoMTuH6x2iS71xQKTU-bbyPCjY3z9fZT60
2025-10-20 00:10:36,982 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992178, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:10:36,985 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:10:36,986 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:10:36,987 - sqlalchemy.engine.Engine - INFO - [cached since 71.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:10:36,989 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:10:36,990 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:10:36,991 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:10:36,992 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:10:36,992 - sqlalchemy.engine.Engine - INFO - [cached since 72.14s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:10:36,995 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:10:36,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:36,996 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:37,001 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:10:37,002 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:10:37,005 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:10:37,007 - sqlalchemy.engine.Engine - INFO - [cached since 72.15s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:10:37,009 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:10:37,009 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:37,010 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:10:37,013 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIxNzgsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.kEb2s3OawZoMTuH6x2iS71xQKTU-bbyPCjY3z9fZT60
2025-10-20 00:10:37,013 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992178, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:10:37,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:10:37,016 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:10:37,017 - sqlalchemy.engine.Engine - INFO - [cached since 71.63s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:10:37,019 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:10:37,021 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:10:37,022 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:10:37,025 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:10:37,026 - sqlalchemy.engine.Engine - INFO - [cached since 72.17s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:10:37,029 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:10:37,029 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:37,031 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:10:37,031 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:10:37,033 - sqlalchemy.engine.Engine - INFO - [cached since 71.09s ago] {'restaurant_id_1': 1}
2025-10-20 00:10:37,038 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:37,040 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:37,094 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:10:37,095 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:10:37,096 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:10:37,097 - sqlalchemy.engine.Engine - INFO - [cached since 72.24s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:10:37,099 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:10:37,099 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:10:37,100 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:10,422 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,423 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,425 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,426 - sqlalchemy.engine.Engine - INFO - [cached since 105.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,429 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,429 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,431 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:10,433 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:11:10,433 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:11:10,433 - multipart.multipart - DEBUG - Calling on_field_data with data[9:31]
2025-10-20 00:11:10,434 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:11:10,434 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:11:10,434 - multipart.multipart - DEBUG - Calling on_field_name with data[32:40]
2025-10-20 00:11:10,434 - multipart.multipart - DEBUG - Calling on_field_data with data[41:49]
2025-10-20 00:11:10,434 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:11:10,434 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:11:10,435 - multipart.multipart - DEBUG - Calling on_field_name with data[50:60]
2025-10-20 00:11:10,435 - multipart.multipart - DEBUG - Calling on_field_data with data[61:69]
2025-10-20 00:11:10,436 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:11:10,436 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:11:10,436 - multipart.multipart - DEBUG - Calling on_field_name with data[70:75]
2025-10-20 00:11:10,436 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:11:10,436 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:11:10,439 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,440 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:11:10,441 - sqlalchemy.engine.Engine - INFO - [cached since 105.6s ago] {'email_1': 'admin@coffeeshop.com', 'param_1': 1}
2025-10-20 00:11:10,808 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,809 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,811 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,811 - sqlalchemy.engine.Engine - INFO - [cached since 106s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,815 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,815 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,826 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,828 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,830 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,832 - sqlalchemy.engine.Engine - INFO - [cached since 106s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,835 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,836 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,839 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:10,841 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:11:10,841 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:11:10,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,844 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:11:10,845 - sqlalchemy.engine.Engine - INFO - [cached since 105.5s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:11:10,849 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:11:10,852 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,917 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,918 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,919 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,920 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,923 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,923 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,924 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:10,930 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,931 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,932 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,934 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,934 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,937 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:10,938 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:11:10,939 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:11:10,940 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,941 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:11:10,943 - sqlalchemy.engine.Engine - INFO - [cached since 105.6s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:11:10,945 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:11:10,946 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,947 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,947 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,948 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,950 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,950 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,952 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,954 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:11:10,955 - sqlalchemy.engine.Engine - INFO - [cached since 105s ago] {'restaurant_id_1': 1}
2025-10-20 00:11:10,959 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,961 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,967 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,969 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,970 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,970 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,973 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,974 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,976 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:10,981 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,983 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,984 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,984 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,987 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,987 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:10,989 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:10,994 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:10,995 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:10,996 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:10,996 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:10,999 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:10,999 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:11,001 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:11,011 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:11,012 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:11,013 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:11,013 - sqlalchemy.engine.Engine - INFO - [cached since 106.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:11,016 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:11,016 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:11,017 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:11,019 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:11:11,020 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:11:11,022 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:11,022 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:11:11,023 - sqlalchemy.engine.Engine - INFO - [cached since 105.6s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:11:11,024 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:11:11,025 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:11,025 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:11,027 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:11,028 - sqlalchemy.engine.Engine - INFO - [cached since 106.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:11,029 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:11,029 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:11,032 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:11,032 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:11:11,034 - sqlalchemy.engine.Engine - INFO - [cached since 105s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:11:11,051 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:11,054 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:13,962 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:13,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:13,965 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:13,966 - sqlalchemy.engine.Engine - INFO - [cached since 109.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:13,967 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:13,967 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:13,969 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:13,973 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:13,975 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:13,976 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:13,977 - sqlalchemy.engine.Engine - INFO - [cached since 109.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:13,980 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:13,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:13,982 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:13,984 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:11:13,984 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:11:13,988 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:13,990 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:11:13,991 - sqlalchemy.engine.Engine - INFO - [cached since 108.6s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:11:13,993 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:11:13,995 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:13,996 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:13,997 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:13,997 - sqlalchemy.engine.Engine - INFO - [cached since 109.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:14,000 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:14,000 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,004 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,010 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:11:14,010 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:11:14,014 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:11:14,016 - sqlalchemy.engine.Engine - INFO - [cached since 0.006806s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:11:14,024 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:11:14,025 - sqlalchemy.engine.Engine - INFO - [generated in 0.00143s] {'pk_1': 4}
2025-10-20 00:11:14,033 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:11:14,034 - sqlalchemy.engine.Engine - INFO - [generated in 0.00155s] {'param_1': 12}
2025-10-20 00:11:14,044 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:11:14,044 - sqlalchemy.engine.Engine - INFO - [generated in 0.00102s] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:11:14,048 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:11:14,049 - sqlalchemy.engine.Engine - INFO - [cached since 0.005048s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:11:14,051 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:11:14,053 - sqlalchemy.engine.Engine - INFO - [cached since 0.009006s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:11:14,056 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:11:14,056 - sqlalchemy.engine.Engine - INFO - [cached since 0.01272s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:11:14,058 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:14,060 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:11:14,061 - sqlalchemy.engine.Engine - INFO - [cached since 0.01726s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:11:14,066 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:11:14,067 - sqlalchemy.engine.Engine - INFO - [generated in 0.00118s] {'restaurant_id_1': 1}
2025-10-20 00:11:14,069 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,069 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:14,074 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:11:14,074 - sqlalchemy.engine.Engine - INFO - [cached since 109.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:14,075 - sqlalchemy.engine.Engine - INFO - [generated in 0.00150s] {'restaurant_id_1': 1}
2025-10-20 00:11:14,077 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:14,080 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:11:14,081 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,081 - sqlalchemy.engine.Engine - INFO - [generated in 0.00115s] {'restaurant_id_1': 1}
2025-10-20 00:11:14,083 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:14,087 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:11:14,087 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:11:14,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,090 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:11:14,091 - sqlalchemy.engine.Engine - INFO - [cached since 108.7s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:11:14,093 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:11:14,094 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,095 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:14,099 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,100 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:14,101 - sqlalchemy.engine.Engine - INFO - [cached since 109.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:14,104 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:14,104 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,106 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,107 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:11:14,108 - sqlalchemy.engine.Engine - INFO - [cached since 108.2s ago] {'restaurant_id_1': 1}
2025-10-20 00:11:14,112 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,113 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,116 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,123 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:14,124 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,125 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:14,125 - sqlalchemy.engine.Engine - INFO - [cached since 109.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:14,127 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:14,127 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,128 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:14,137 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:14,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,139 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:14,139 - sqlalchemy.engine.Engine - INFO - [cached since 109.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:14,142 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:14,142 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,143 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:11:14,144 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:11:14,145 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:11:14,145 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,146 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:11:14,147 - sqlalchemy.engine.Engine - INFO - [cached since 108.8s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:11:14,150 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:11:14,151 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:11:14,153 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,154 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:11:14,155 - sqlalchemy.engine.Engine - INFO - [cached since 109.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:11:14,158 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:11:14,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,160 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:11:14,161 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:11:14,161 - sqlalchemy.engine.Engine - INFO - [cached since 108.1s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:11:14,183 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:11:14,184 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:23,954 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:23,955 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:23,955 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:23,956 - sqlalchemy.engine.Engine - INFO - [cached since 179.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:23,957 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:23,957 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:23,958 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:23,960 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:12:23,960 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:12:23,961 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:23,962 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:23,962 - sqlalchemy.engine.Engine - INFO - [cached since 178.6s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:12:23,963 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:12:23,964 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:23,964 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:23,964 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:23,965 - sqlalchemy.engine.Engine - INFO - [cached since 179.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:23,966 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:23,966 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:23,969 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:23,969 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:12:23,970 - sqlalchemy.engine.Engine - INFO - [cached since 69.96s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:12:23,971 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:12:23,973 - sqlalchemy.engine.Engine - INFO - [cached since 69.96s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:12:23,974 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:12:23,975 - sqlalchemy.engine.Engine - INFO - [cached since 69.95s ago] {'pk_1': 4}
2025-10-20 00:12:23,977 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:12:23,977 - sqlalchemy.engine.Engine - INFO - [cached since 69.95s ago] {'param_1': 12}
2025-10-20 00:12:23,980 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:12:23,981 - sqlalchemy.engine.Engine - INFO - [cached since 69.94s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:12:23,982 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:12:23,983 - sqlalchemy.engine.Engine - INFO - [cached since 69.94s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:12:23,985 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:12:23,985 - sqlalchemy.engine.Engine - INFO - [cached since 69.94s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:12:23,987 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:12:23,988 - sqlalchemy.engine.Engine - INFO - [cached since 69.94s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:12:23,989 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:12:23,990 - sqlalchemy.engine.Engine - INFO - [cached since 69.95s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:12:23,991 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:12:23,991 - sqlalchemy.engine.Engine - INFO - [cached since 69.92s ago] {'restaurant_id_1': 1}
2025-10-20 00:12:23,994 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:12:23,994 - sqlalchemy.engine.Engine - INFO - [cached since 69.92s ago] {'restaurant_id_1': 1}
2025-10-20 00:12:23,996 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:12:23,997 - sqlalchemy.engine.Engine - INFO - [cached since 69.92s ago] {'restaurant_id_1': 1}
2025-10-20 00:12:23,999 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,001 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,002 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:24,003 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,004 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:24,005 - sqlalchemy.engine.Engine - INFO - [cached since 179.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:24,006 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:24,006 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,007 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:24,008 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:12:24,008 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:12:24,009 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,009 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:24,009 - sqlalchemy.engine.Engine - INFO - [cached since 178.6s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:12:24,010 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:12:24,011 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:24,012 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,012 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:24,013 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:24,014 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:24,014 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,016 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,016 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:12:24,017 - sqlalchemy.engine.Engine - INFO - [cached since 178.1s ago] {'restaurant_id_1': 1}
2025-10-20 00:12:24,021 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,022 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,041 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:24,043 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,044 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:24,044 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:24,045 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:24,045 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,047 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:24,053 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:24,054 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,054 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:24,054 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:24,056 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:24,056 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,058 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:24,058 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIyNzAsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.tyHQdXmI1Fs22-mybcKyMCyqfluTtZdAdb97Lj2Wtp4
2025-10-20 00:12:24,059 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992270, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:12:24,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,060 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:24,060 - sqlalchemy.engine.Engine - INFO - [cached since 178.7s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:12:24,061 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:12:24,062 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:24,063 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,063 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:24,063 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:24,064 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:24,065 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,067 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:24,068 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:12:24,068 - sqlalchemy.engine.Engine - INFO - [cached since 178s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:12:24,078 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:24,080 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,371 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:46,372 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,372 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:46,374 - sqlalchemy.engine.Engine - INFO - [cached since 201.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:46,376 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:46,376 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,378 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:46,380 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:12:46,380 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:12:46,380 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:12:46,380 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:12:46,380 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:12:46,380 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:12:46,381 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:12:46,381 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:12:46,381 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:12:46,383 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:12:46,383 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:12:46,384 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:12:46,384 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:12:46,384 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:12:46,384 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:12:46,385 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:12:46,387 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,388 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:46,390 - sqlalchemy.engine.Engine - INFO - [cached since 201.5s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:12:46,765 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:46,767 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,768 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:46,770 - sqlalchemy.engine.Engine - INFO - [cached since 201.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:46,772 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:46,772 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,775 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,779 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:46,780 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,782 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:46,783 - sqlalchemy.engine.Engine - INFO - [cached since 201.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:46,785 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:46,785 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,788 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:46,789 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:12:46,790 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:12:46,791 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,792 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:46,794 - sqlalchemy.engine.Engine - INFO - [cached since 201.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:12:46,796 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:12:46,799 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,819 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:46,820 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,821 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:46,822 - sqlalchemy.engine.Engine - INFO - [cached since 202s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:46,824 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:46,824 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,825 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:46,832 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:46,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,834 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:46,834 - sqlalchemy.engine.Engine - INFO - [cached since 202s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:46,836 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:46,836 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,838 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:46,840 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:12:46,840 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:12:46,841 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,841 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:46,842 - sqlalchemy.engine.Engine - INFO - [cached since 201.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:12:46,845 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:12:46,845 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:46,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,847 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:46,847 - sqlalchemy.engine.Engine - INFO - [cached since 202s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:46,849 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:46,849 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:46,853 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:12:46,854 - sqlalchemy.engine.Engine - INFO - [cached since 200.8s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:12:46,879 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:46,882 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,264 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:51,265 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,266 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:51,267 - sqlalchemy.engine.Engine - INFO - [cached since 206.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:51,269 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:51,270 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,271 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:51,271 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:12:51,272 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:12:51,272 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,273 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:51,274 - sqlalchemy.engine.Engine - INFO - [cached since 205.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:12:51,276 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:12:51,277 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:51,278 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,278 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:51,280 - sqlalchemy.engine.Engine - INFO - [cached since 206.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:51,282 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:51,282 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,342 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:51,342 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,344 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:51,345 - sqlalchemy.engine.Engine - INFO - [cached since 206.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:51,347 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:51,347 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,348 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:51,350 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:12:51,351 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:12:51,352 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,352 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:51,352 - sqlalchemy.engine.Engine - INFO - [cached since 206s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:12:51,355 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:12:51,355 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:51,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,358 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:51,358 - sqlalchemy.engine.Engine - INFO - [cached since 206.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:51,360 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:51,360 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,362 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,362 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:12:51,364 - sqlalchemy.engine.Engine - INFO - [cached since 205.4s ago] {'restaurant_id_1': 1}
2025-10-20 00:12:51,369 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,373 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,377 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:51,379 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,379 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:51,380 - sqlalchemy.engine.Engine - INFO - [cached since 206.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:51,383 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:51,383 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,384 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:51,391 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:51,393 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,394 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:51,395 - sqlalchemy.engine.Engine - INFO - [cached since 206.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:51,398 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:51,398 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,401 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:12:51,402 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:12:51,404 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:12:51,406 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,408 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:12:51,409 - sqlalchemy.engine.Engine - INFO - [cached since 206s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:12:51,412 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:12:51,414 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:12:51,417 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,418 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:12:51,421 - sqlalchemy.engine.Engine - INFO - [cached since 206.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:12:51,425 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:12:51,425 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,432 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:12:51,432 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:12:51,434 - sqlalchemy.engine.Engine - INFO - [cached since 205.4s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:12:51,464 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:12:51,467 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:37,459 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:37,496 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:37,498 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:37,501 - sqlalchemy.engine.Engine - INFO - [cached since 312.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:37,508 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:37,508 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:37,510 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:14:37,521 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:37,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:37,525 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:37,527 - sqlalchemy.engine.Engine - INFO - [cached since 312.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:37,531 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:37,532 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:37,534 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:14:37,549 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:37,571 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:37,575 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:37,578 - sqlalchemy.engine.Engine - INFO - [cached since 312.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:37,582 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:37,583 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:37,587 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:14:37,598 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:37,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:37,603 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:37,604 - sqlalchemy.engine.Engine - INFO - [cached since 312.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:37,609 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:37,610 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:37,615 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:14:37,617 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:14:37,618 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:14:37,620 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:37,623 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:14:37,625 - sqlalchemy.engine.Engine - INFO - [cached since 312.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:14:37,630 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:14:37,632 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:37,636 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:37,638 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:37,639 - sqlalchemy.engine.Engine - INFO - [cached since 312.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:37,643 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:37,644 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:37,651 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:37,688 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:14:37,692 - sqlalchemy.engine.Engine - INFO - [generated in 0.00369s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:14:37,738 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,741 - sqlalchemy.engine.Engine - INFO - [generated in 0.00249s] {'pk_1': 9}
2025-10-20 00:14:37,746 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,748 - sqlalchemy.engine.Engine - INFO - [cached since 0.01028s ago] {'pk_1': 16}
2025-10-20 00:14:37,756 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.02029s ago] {'pk_1': 15}
2025-10-20 00:14:37,762 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,764 - sqlalchemy.engine.Engine - INFO - [cached since 0.02637s ago] {'pk_1': 13}
2025-10-20 00:14:37,769 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,772 - sqlalchemy.engine.Engine - INFO - [cached since 0.0331s ago] {'pk_1': 14}
2025-10-20 00:14:37,776 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,778 - sqlalchemy.engine.Engine - INFO - [cached since 0.03971s ago] {'pk_1': 18}
2025-10-20 00:14:37,783 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,787 - sqlalchemy.engine.Engine - INFO - [cached since 0.04811s ago] {'pk_1': 21}
2025-10-20 00:14:37,792 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,794 - sqlalchemy.engine.Engine - INFO - [cached since 0.05603s ago] {'pk_1': 19}
2025-10-20 00:14:37,800 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,802 - sqlalchemy.engine.Engine - INFO - [cached since 0.06452s ago] {'pk_1': 22}
2025-10-20 00:14:37,811 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,813 - sqlalchemy.engine.Engine - INFO - [cached since 0.07473s ago] {'pk_1': 7}
2025-10-20 00:14:37,818 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,822 - sqlalchemy.engine.Engine - INFO - [cached since 0.0839s ago] {'pk_1': 5}
2025-10-20 00:14:37,829 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,835 - sqlalchemy.engine.Engine - INFO - [cached since 0.09658s ago] {'pk_1': 6}
2025-10-20 00:14:37,841 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:14:37,844 - sqlalchemy.engine.Engine - INFO - [cached since 0.1063s ago] {'pk_1': 8}
2025-10-20 00:14:37,871 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:37,875 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:39,521 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:39,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:39,526 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:39,528 - sqlalchemy.engine.Engine - INFO - [cached since 314.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:39,532 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:39,532 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:39,534 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:14:39,546 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:39,549 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:39,551 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:39,554 - sqlalchemy.engine.Engine - INFO - [cached since 314.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:39,559 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:39,561 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:39,565 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:14:39,570 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:14:39,570 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:14:39,573 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:39,575 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:14:39,578 - sqlalchemy.engine.Engine - INFO - [cached since 314.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:14:39,583 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:14:39,590 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:39,623 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:14:39,628 - sqlalchemy.engine.Engine - INFO - [generated in 0.00477s] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:14:39,645 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:39,650 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:42,212 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:42,214 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:42,217 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:42,220 - sqlalchemy.engine.Engine - INFO - [cached since 317.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:42,224 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:42,225 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:42,226 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:14:42,238 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:42,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:42,243 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:42,246 - sqlalchemy.engine.Engine - INFO - [cached since 317.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:42,250 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:42,251 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:42,253 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:14:42,258 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:14:42,259 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:14:42,262 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:42,264 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:14:42,265 - sqlalchemy.engine.Engine - INFO - [cached since 316.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:14:42,270 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:14:42,271 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:14:42,273 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:42,277 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:14:42,279 - sqlalchemy.engine.Engine - INFO - [cached since 317.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:14:42,283 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:14:42,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:42,289 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:14:42,291 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:14:42,294 - sqlalchemy.engine.Engine - INFO - [cached since 316.3s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:14:42,332 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:14:42,337 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:47,750 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:47,780 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:47,782 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:47,784 - sqlalchemy.engine.Engine - INFO - [cached since 442.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:47,788 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:47,788 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:47,790 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:16:47,793 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTIzNjYsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.3cimxjNSjKx6o0Uiv6KEuHaLEd2q_tUkRV7JjhkU1gE
2025-10-20 00:16:47,793 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992366, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:16:47,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:47,797 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:16:47,798 - sqlalchemy.engine.Engine - INFO - [cached since 442.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:16:47,801 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:16:47,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:47,806 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:16:47,807 - sqlalchemy.engine.Engine - INFO - [cached since 128.2s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:16:47,814 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:47,817 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:54,179 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:54,196 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:54,197 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:54,200 - sqlalchemy.engine.Engine - INFO - [cached since 449.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:54,205 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:54,206 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:54,211 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:16:54,213 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:16:54,213 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:16:54,213 - multipart.multipart - DEBUG - Calling on_field_data with data[9:42]
2025-10-20 00:16:54,214 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:16:54,214 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:16:54,214 - multipart.multipart - DEBUG - Calling on_field_name with data[43:51]
2025-10-20 00:16:54,214 - multipart.multipart - DEBUG - Calling on_field_data with data[52:67]
2025-10-20 00:16:54,214 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:16:54,214 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:16:54,214 - multipart.multipart - DEBUG - Calling on_field_name with data[68:78]
2025-10-20 00:16:54,214 - multipart.multipart - DEBUG - Calling on_field_data with data[79:87]
2025-10-20 00:16:54,216 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:16:54,216 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:16:54,216 - multipart.multipart - DEBUG - Calling on_field_name with data[88:93]
2025-10-20 00:16:54,216 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:16:54,217 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:16:54,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:54,225 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:16:54,226 - sqlalchemy.engine.Engine - INFO - [cached since 449.4s ago] {'email_1': 'cashier-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:16:54,842 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:54,845 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:54,847 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:54,849 - sqlalchemy.engine.Engine - INFO - [cached since 450s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:54,855 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:54,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:54,865 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:54,873 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:54,877 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:54,879 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:54,880 - sqlalchemy.engine.Engine - INFO - [cached since 450s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:54,883 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:54,884 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:54,887 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:16:54,890 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:16:54,891 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:16:54,895 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:54,898 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:16:54,898 - sqlalchemy.engine.Engine - INFO - [cached since 449.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:16:54,902 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:16:54,911 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:54,947 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:54,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:54,952 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:54,952 - sqlalchemy.engine.Engine - INFO - [cached since 450.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:54,957 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:54,958 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:54,962 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:16:54,974 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:54,976 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:54,978 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:54,980 - sqlalchemy.engine.Engine - INFO - [cached since 450.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:54,984 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:54,984 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:54,986 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:16:54,991 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:16:54,991 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:16:54,994 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:54,995 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:16:54,996 - sqlalchemy.engine.Engine - INFO - [cached since 449.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:16:55,018 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:16:55,019 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:55,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:55,034 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:55,041 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:55,049 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:55,049 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:55,055 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:55,056 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:16:55,061 - sqlalchemy.engine.Engine - INFO - [cached since 449s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:16:55,095 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:55,100 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:56,374 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:56,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:56,378 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:56,381 - sqlalchemy.engine.Engine - INFO - [cached since 451.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:56,385 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:56,386 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:56,390 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:16:56,394 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:16:56,395 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:16:56,398 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:56,401 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:16:56,403 - sqlalchemy.engine.Engine - INFO - [cached since 451s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:16:56,411 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:16:56,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:56,421 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:16:56,427 - sqlalchemy.engine.Engine - INFO - [cached since 136.8s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:16:56,441 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:56,447 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:57,198 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:57,200 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:57,202 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:57,205 - sqlalchemy.engine.Engine - INFO - [cached since 452.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:57,209 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:57,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:57,212 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:16:57,222 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:16:57,225 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:57,228 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:16:57,229 - sqlalchemy.engine.Engine - INFO - [cached since 452.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:16:57,234 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:16:57,235 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:57,238 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:16:57,243 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:16:57,244 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:16:57,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:57,399 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:16:57,401 - sqlalchemy.engine.Engine - INFO - [cached since 452s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:16:57,405 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:16:57,419 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:16:57,422 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:16:57,427 - sqlalchemy.engine.Engine - INFO - [generated in 0.00297s] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-20 00:16:57,437 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:16:57,443 - sqlalchemy.engine.Engine - INFO - [generated in 0.00662s] {'session_id_1': 12}
2025-10-20 00:16:57,461 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:16:57,463 - sqlalchemy.engine.Engine - INFO - [cached since 0.02679s ago] {'session_id_1': 10}
2025-10-20 00:16:57,471 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:16:57,473 - sqlalchemy.engine.Engine - INFO - [cached since 0.03694s ago] {'session_id_1': 11}
2025-10-20 00:16:57,502 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:16:57,515 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:17:47,301 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:17:47,302 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:17:47,303 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:17:47,304 - sqlalchemy.engine.Engine - INFO - [cached since 502.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:17:47,304 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:17:47,305 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:17:47,305 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:17:47,307 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:17:47,307 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:17:47,308 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:17:47,308 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:17:47,309 - sqlalchemy.engine.Engine - INFO - [cached since 501.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:17:47,311 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:17:47,312 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:17:47,312 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:17:47,313 - sqlalchemy.engine.Engine - INFO - [cached since 187.7s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:17:47,319 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:17:47,320 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:46,083 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:18:46,084 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:46,085 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:18:46,087 - sqlalchemy.engine.Engine - INFO - [cached since 561.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:18:46,089 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:18:46,089 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:46,090 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:18:46,096 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:18:46,098 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:46,099 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:18:46,099 - sqlalchemy.engine.Engine - INFO - [cached since 561.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:18:46,101 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:18:46,102 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:46,103 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:18:46,104 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:18:46,105 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:18:46,106 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:46,108 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:18:46,108 - sqlalchemy.engine.Engine - INFO - [cached since 560.7s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:18:46,111 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:18:46,112 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:18:46,113 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:46,114 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:18:46,116 - sqlalchemy.engine.Engine - INFO - [cached since 561.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:18:46,119 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:18:46,120 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:46,122 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:46,124 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:18:46,125 - sqlalchemy.engine.Engine - INFO - [cached since 560.1s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:18:46,164 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:46,166 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,717 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:18:49,719 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,720 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:18:49,721 - sqlalchemy.engine.Engine - INFO - [cached since 564.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:18:49,724 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:18:49,725 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,727 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:18:49,729 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:18:49,730 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:18:49,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,733 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:18:49,734 - sqlalchemy.engine.Engine - INFO - [cached since 564.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:18:49,735 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:18:49,737 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:18:49,738 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,740 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:18:49,740 - sqlalchemy.engine.Engine - INFO - [cached since 564.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:18:49,743 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:18:49,743 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,747 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:18:49,748 - sqlalchemy.engine.Engine - INFO - [cached since 563.8s ago] {'restaurant_id_1': 1}
2025-10-20 00:18:49,755 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,756 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,764 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:18:49,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,766 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:18:49,767 - sqlalchemy.engine.Engine - INFO - [cached since 564.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:18:49,770 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:18:49,771 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,772 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:18:49,780 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:18:49,781 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,782 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:18:49,784 - sqlalchemy.engine.Engine - INFO - [cached since 564.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:18:49,787 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:18:49,787 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,788 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:18:49,790 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:18:49,791 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:18:49,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,795 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:18:49,796 - sqlalchemy.engine.Engine - INFO - [cached since 564.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:18:49,798 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:18:49,801 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:18:49,801 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,803 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:18:49,804 - sqlalchemy.engine.Engine - INFO - [cached since 564.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:18:49,806 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:18:49,806 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,809 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:18:49,812 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:18:49,813 - sqlalchemy.engine.Engine - INFO - [cached since 563.8s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:18:49,830 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:18:49,832 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,198 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:01,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,200 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:01,201 - sqlalchemy.engine.Engine - INFO - [cached since 696.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:01,203 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:01,203 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,204 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:01,204 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:01,206 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:01,228 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,228 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:01,230 - sqlalchemy.engine.Engine - INFO - [cached since 695.8s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:01,231 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:01,232 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:01,232 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,232 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:01,234 - sqlalchemy.engine.Engine - INFO - [cached since 696.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:01,235 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:01,236 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,260 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,261 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:21:01,261 - sqlalchemy.engine.Engine - INFO - [cached since 695.3s ago] {'restaurant_id_1': 1}
2025-10-20 00:21:01,265 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,266 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,287 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:01,287 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,289 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:01,289 - sqlalchemy.engine.Engine - INFO - [cached since 696.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:01,290 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:01,290 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,291 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:01,300 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:01,300 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,301 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:01,302 - sqlalchemy.engine.Engine - INFO - [cached since 696.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:01,305 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:01,305 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,306 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:01,307 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:01,308 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:01,308 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,309 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:01,310 - sqlalchemy.engine.Engine - INFO - [cached since 695.9s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:01,311 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:01,311 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:01,311 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,312 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:01,313 - sqlalchemy.engine.Engine - INFO - [cached since 696.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:01,314 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:01,314 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:01,317 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:21:01,318 - sqlalchemy.engine.Engine - INFO - [cached since 695.3s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:21:01,328 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:01,330 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:10,817 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:10,819 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:10,822 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:10,825 - sqlalchemy.engine.Engine - INFO - [cached since 706s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:10,844 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:10,845 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:10,848 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:10,852 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:10,853 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:10,854 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:10,857 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:10,859 - sqlalchemy.engine.Engine - INFO - [cached since 705.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:10,862 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:10,867 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:10,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:10,871 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:10,879 - sqlalchemy.engine.Engine - INFO - [cached since 706s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:10,886 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:10,887 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:10,891 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:10,894 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:21:10,896 - sqlalchemy.engine.Engine - INFO - [cached since 705s ago] {'restaurant_id_1': 1}
2025-10-20 00:21:10,905 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:10,908 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:10,914 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:10,915 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:10,917 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:10,919 - sqlalchemy.engine.Engine - INFO - [cached since 706.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:10,922 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:10,923 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:10,927 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:10,974 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:10,976 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:10,979 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:10,981 - sqlalchemy.engine.Engine - INFO - [cached since 706.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:10,985 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:10,996 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:11,011 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:11,014 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:11,015 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:11,019 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:11,024 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:11,028 - sqlalchemy.engine.Engine - INFO - [cached since 705.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:11,032 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:11,033 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:11,035 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:11,037 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:11,042 - sqlalchemy.engine.Engine - INFO - [cached since 706.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:11,048 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:11,051 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:11,054 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:11,058 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:21:11,064 - sqlalchemy.engine.Engine - INFO - [cached since 705s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:21:11,098 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:11,101 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,537 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:19,538 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,542 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:19,544 - sqlalchemy.engine.Engine - INFO - [cached since 714.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:19,547 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:19,548 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,550 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:19,557 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:19,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,560 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:19,562 - sqlalchemy.engine.Engine - INFO - [cached since 714.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:19,565 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:19,566 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,567 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:19,572 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:19,572 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:19,574 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,577 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:19,578 - sqlalchemy.engine.Engine - INFO - [cached since 714.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:19,582 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:19,583 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:19,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,587 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:19,588 - sqlalchemy.engine.Engine - INFO - [cached since 714.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:19,594 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:19,595 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,601 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:21:19,602 - sqlalchemy.engine.Engine - INFO - [cached since 713.7s ago] {'restaurant_id_1': 1}
2025-10-20 00:21:19,613 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,617 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,623 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:19,624 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,627 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:19,629 - sqlalchemy.engine.Engine - INFO - [cached since 714.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:19,632 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:19,632 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,638 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:19,644 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:19,646 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,647 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:19,648 - sqlalchemy.engine.Engine - INFO - [cached since 714.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:19,651 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:19,652 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,654 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:19,665 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:19,666 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,667 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:19,670 - sqlalchemy.engine.Engine - INFO - [cached since 714.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:19,672 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:19,672 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,676 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:19,685 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:19,687 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,688 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:19,691 - sqlalchemy.engine.Engine - INFO - [cached since 714.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:19,696 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:19,696 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,699 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:19,702 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:19,703 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:19,705 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,707 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:19,709 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:19,712 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:19,715 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:19,716 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,719 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:19,722 - sqlalchemy.engine.Engine - INFO - [cached since 714.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:19,729 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:19,729 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:19,737 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:21:19,742 - sqlalchemy.engine.Engine - INFO - [cached since 713.7s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:21:19,776 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:19,779 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:32,369 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:32,372 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:32,373 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:32,376 - sqlalchemy.engine.Engine - INFO - [cached since 727.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:32,380 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:32,380 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:32,384 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:32,396 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:32,398 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:32,400 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:32,401 - sqlalchemy.engine.Engine - INFO - [cached since 727.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:32,406 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:32,406 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:32,414 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:32,418 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:32,419 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:32,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:32,424 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:32,427 - sqlalchemy.engine.Engine - INFO - [cached since 727s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:32,431 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:32,435 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:32,437 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:32,438 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:32,441 - sqlalchemy.engine.Engine - INFO - [cached since 727.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:32,445 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:32,446 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:32,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:32,454 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:21:32,458 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:21:32,501 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,503 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 9}
2025-10-20 00:21:32,507 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,509 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 16}
2025-10-20 00:21:32,514 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,517 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 15}
2025-10-20 00:21:32,523 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,526 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 13}
2025-10-20 00:21:32,531 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,532 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 14}
2025-10-20 00:21:32,540 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,542 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 18}
2025-10-20 00:21:32,547 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,549 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 21}
2025-10-20 00:21:32,555 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,558 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 19}
2025-10-20 00:21:32,566 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,568 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 22}
2025-10-20 00:21:32,574 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,576 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 7}
2025-10-20 00:21:32,581 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,585 - sqlalchemy.engine.Engine - INFO - [cached since 414.8s ago] {'pk_1': 5}
2025-10-20 00:21:32,591 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,594 - sqlalchemy.engine.Engine - INFO - [cached since 414.9s ago] {'pk_1': 6}
2025-10-20 00:21:32,599 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:32,603 - sqlalchemy.engine.Engine - INFO - [cached since 414.9s ago] {'pk_1': 8}
2025-10-20 00:21:32,634 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:32,638 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:34,013 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:34,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:34,018 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:34,020 - sqlalchemy.engine.Engine - INFO - [cached since 729.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:34,024 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:34,025 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:34,027 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:34,031 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:34,032 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:34,035 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:34,036 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:34,039 - sqlalchemy.engine.Engine - INFO - [cached since 728.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:34,044 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:34,049 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:34,051 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:21:34,054 - sqlalchemy.engine.Engine - INFO - [cached since 414.4s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:21:34,068 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:34,071 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,428 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:35,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,433 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:35,436 - sqlalchemy.engine.Engine - INFO - [cached since 730.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:35,444 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:35,445 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,450 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:35,455 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:35,456 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:35,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,465 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:35,469 - sqlalchemy.engine.Engine - INFO - [cached since 730.1s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:35,478 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:35,483 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,485 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:21:35,488 - sqlalchemy.engine.Engine - INFO - [cached since 415.9s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:21:35,505 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,513 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,536 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:35,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,542 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:35,545 - sqlalchemy.engine.Engine - INFO - [cached since 730.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:35,551 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:35,551 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,554 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:35,558 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:35,559 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:35,560 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,563 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:35,566 - sqlalchemy.engine.Engine - INFO - [cached since 730.2s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:35,570 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:35,572 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:35,575 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,579 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:35,582 - sqlalchemy.engine.Engine - INFO - [cached since 730.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:35,587 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:35,588 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,591 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,595 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:21:35,598 - sqlalchemy.engine.Engine - INFO - [cached since 729.7s ago] {'restaurant_id_1': 1}
2025-10-20 00:21:35,613 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,618 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,629 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:35,632 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,637 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:35,638 - sqlalchemy.engine.Engine - INFO - [cached since 730.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:35,646 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:35,646 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,650 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:35,663 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:35,666 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,669 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:35,672 - sqlalchemy.engine.Engine - INFO - [cached since 730.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:35,682 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:35,683 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,689 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:35,696 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:35,697 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:35,701 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,703 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:35,706 - sqlalchemy.engine.Engine - INFO - [cached since 730.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:35,716 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:35,719 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:35,723 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,732 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:35,743 - sqlalchemy.engine.Engine - INFO - [cached since 730.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:35,754 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:35,754 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,766 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:35,772 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:21:35,782 - sqlalchemy.engine.Engine - INFO - [cached since 729.7s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:21:35,866 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:35,873 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:37,736 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:37,738 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:37,741 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:37,743 - sqlalchemy.engine.Engine - INFO - [cached since 732.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:37,747 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:37,748 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:37,751 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:37,762 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:37,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:37,767 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:37,769 - sqlalchemy.engine.Engine - INFO - [cached since 732.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:37,774 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:37,776 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:37,778 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:37,782 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:37,784 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:37,785 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:37,787 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:37,789 - sqlalchemy.engine.Engine - INFO - [cached since 732.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:37,794 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:37,798 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:37,799 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:37,802 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:37,803 - sqlalchemy.engine.Engine - INFO - [cached since 732.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:37,807 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:37,808 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:37,814 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:37,817 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:21:37,821 - sqlalchemy.engine.Engine - INFO - [cached since 420.1s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:21:37,862 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,863 - sqlalchemy.engine.Engine - INFO - [cached since 420.1s ago] {'pk_1': 9}
2025-10-20 00:21:37,871 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,873 - sqlalchemy.engine.Engine - INFO - [cached since 420.1s ago] {'pk_1': 16}
2025-10-20 00:21:37,879 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,882 - sqlalchemy.engine.Engine - INFO - [cached since 420.1s ago] {'pk_1': 15}
2025-10-20 00:21:37,888 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,889 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 13}
2025-10-20 00:21:37,897 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,899 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 14}
2025-10-20 00:21:37,904 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,906 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 18}
2025-10-20 00:21:37,913 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,916 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 21}
2025-10-20 00:21:37,920 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,923 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 19}
2025-10-20 00:21:37,931 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,934 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 22}
2025-10-20 00:21:37,940 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,942 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 7}
2025-10-20 00:21:37,948 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,950 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 5}
2025-10-20 00:21:37,954 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,958 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 6}
2025-10-20 00:21:37,964 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:21:37,966 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'pk_1': 8}
2025-10-20 00:21:37,998 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:38,002 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:38,937 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:38,939 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:38,942 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:38,946 - sqlalchemy.engine.Engine - INFO - [cached since 734.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:38,949 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:38,950 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:38,953 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:38,957 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:38,958 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:38,960 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:38,962 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:38,966 - sqlalchemy.engine.Engine - INFO - [cached since 733.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:38,970 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:38,973 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:38,977 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:21:38,980 - sqlalchemy.engine.Engine - INFO - [cached since 419.4s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:21:38,992 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:38,996 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:40,090 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:40,094 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:40,096 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:40,098 - sqlalchemy.engine.Engine - INFO - [cached since 735.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:40,102 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:40,102 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:40,105 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:40,117 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:40,119 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:40,122 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:40,126 - sqlalchemy.engine.Engine - INFO - [cached since 735.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:40,131 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:40,132 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:40,135 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:40,140 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:40,141 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:40,145 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:40,147 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:40,150 - sqlalchemy.engine.Engine - INFO - [cached since 734.8s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:40,153 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:40,156 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:40,159 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:40,160 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:40,163 - sqlalchemy.engine.Engine - INFO - [cached since 735.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:40,168 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:40,169 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:40,174 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:40,178 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:21:40,180 - sqlalchemy.engine.Engine - INFO - [cached since 734.1s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:21:40,244 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:40,252 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:46,639 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:46,644 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:46,648 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:46,650 - sqlalchemy.engine.Engine - INFO - [cached since 741.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:46,655 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:46,657 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:46,662 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:46,667 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:46,668 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:46,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:46,673 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:46,674 - sqlalchemy.engine.Engine - INFO - [cached since 741.3s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:46,679 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:46,686 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:46,696 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:21:46,703 - sqlalchemy.engine.Engine - INFO - [cached since 427.1s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:21:46,732 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:46,745 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:47,510 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:47,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:47,515 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:47,517 - sqlalchemy.engine.Engine - INFO - [cached since 742.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:47,520 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:47,522 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:47,525 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:47,530 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:47,531 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:47,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:47,533 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:47,536 - sqlalchemy.engine.Engine - INFO - [cached since 742.1s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:47,539 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:47,544 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:47,546 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:21:47,548 - sqlalchemy.engine.Engine - INFO - [cached since 290.1s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-20 00:21:47,556 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:21:47,558 - sqlalchemy.engine.Engine - INFO - [cached since 290.1s ago] {'session_id_1': 12}
2025-10-20 00:21:47,564 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:21:47,566 - sqlalchemy.engine.Engine - INFO - [cached since 290.1s ago] {'session_id_1': 10}
2025-10-20 00:21:47,573 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:21:47,576 - sqlalchemy.engine.Engine - INFO - [cached since 290.1s ago] {'session_id_1': 11}
2025-10-20 00:21:47,587 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:47,592 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:56,118 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:21:56,121 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:56,122 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:21:56,123 - sqlalchemy.engine.Engine - INFO - [cached since 751.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:21:56,124 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:21:56,126 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:56,127 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:21:56,129 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:21:56,129 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:21:56,133 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:56,134 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:21:56,135 - sqlalchemy.engine.Engine - INFO - [cached since 750.7s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:21:56,136 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:21:56,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:21:56,140 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:21:56,141 - sqlalchemy.engine.Engine - INFO - [cached since 436.5s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:21:56,145 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:21:56,147 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:04,471 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:22:04,474 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:04,476 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:22:04,476 - sqlalchemy.engine.Engine - INFO - [cached since 759.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:22:04,478 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:22:04,478 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:04,479 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:22:04,480 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:22:04,480 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:22:04,481 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:04,482 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:22:04,482 - sqlalchemy.engine.Engine - INFO - [cached since 759.1s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:22:04,484 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:22:04,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:04,486 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:22:04,487 - sqlalchemy.engine.Engine - INFO - [cached since 444.9s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:22:04,492 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:04,494 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:08,754 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:22:08,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,768 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:22:08,791 - sqlalchemy.engine.Engine - INFO - [cached since 763.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:22:08,812 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:22:08,815 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:08,824 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:22:08,846 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:22:08,847 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:22:08,849 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,856 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:22:08,868 - sqlalchemy.engine.Engine - INFO - [cached since 763.5s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:22:08,872 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:22:08,874 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:22:08,875 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,878 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:22:08,880 - sqlalchemy.engine.Engine - INFO - [cached since 764s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:22:08,882 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:22:08,882 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:08,885 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,887 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:22:08,889 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'restaurant_id_1': 1}
2025-10-20 00:22:08,898 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:08,901 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:08,905 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:22:08,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,909 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:22:08,911 - sqlalchemy.engine.Engine - INFO - [cached since 764.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:22:08,914 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:22:08,915 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:08,917 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:22:08,926 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:22:08,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,929 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:22:08,931 - sqlalchemy.engine.Engine - INFO - [cached since 764.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:22:08,936 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:22:08,936 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:08,938 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:22:08,942 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:22:08,943 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:22:08,945 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,947 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:22:08,949 - sqlalchemy.engine.Engine - INFO - [cached since 763.6s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:22:08,952 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:22:08,953 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:22:08,955 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,957 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:22:08,959 - sqlalchemy.engine.Engine - INFO - [cached since 764.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:22:08,963 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:22:08,964 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:08,969 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:22:08,971 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:22:08,973 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:22:09,011 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:22:09,013 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:26:59,748 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:27:03,479 - app.main - INFO - ==================================================
2025-10-20 00:27:03,488 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:27:03,492 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:27:03,498 - app.main - INFO - ==================================================
2025-10-20 00:27:06,201 - app.main - INFO - Starting background tasks...
2025-10-20 00:27:09,861 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,038 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:27:10,040 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:27:10,043 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:27:10,044 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:27:10,046 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:27:10,048 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:27:10,051 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,065 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,066 - sqlalchemy.engine.Engine - INFO - [generated in 0.00251s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,072 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,073 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,074 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:10,083 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,085 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,087 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,089 - sqlalchemy.engine.Engine - INFO - [cached since 0.0244s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,092 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,092 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,095 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:10,105 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,107 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,108 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,110 - sqlalchemy.engine.Engine - INFO - [cached since 0.04573s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,113 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,113 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,116 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:10,125 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,126 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,129 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,132 - sqlalchemy.engine.Engine - INFO - [cached since 0.06783s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,136 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,137 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,139 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:10,144 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:27:10,153 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:27:10,154 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,160 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:27:10,162 - sqlalchemy.engine.Engine - INFO - [generated in 0.00250s] {'id_1': 8, 'param_1': 1}
2025-10-20 00:27:10,167 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:27:10,170 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,192 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,194 - sqlalchemy.engine.Engine - INFO - [cached since 0.1305s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,199 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,260 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:27:10,263 - sqlalchemy.engine.Engine - INFO - [generated in 0.00305s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:27:10,310 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,313 - sqlalchemy.engine.Engine - INFO - [generated in 0.00346s] {'pk_1': 9}
2025-10-20 00:27:10,317 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,319 - sqlalchemy.engine.Engine - INFO - [cached since 0.009703s ago] {'pk_1': 16}
2025-10-20 00:27:10,323 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,325 - sqlalchemy.engine.Engine - INFO - [cached since 0.01544s ago] {'pk_1': 15}
2025-10-20 00:27:10,331 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,338 - sqlalchemy.engine.Engine - INFO - [cached since 0.02867s ago] {'pk_1': 13}
2025-10-20 00:27:10,352 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,353 - sqlalchemy.engine.Engine - INFO - [cached since 0.04396s ago] {'pk_1': 14}
2025-10-20 00:27:10,357 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,358 - sqlalchemy.engine.Engine - INFO - [cached since 0.04903s ago] {'pk_1': 18}
2025-10-20 00:27:10,361 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,363 - sqlalchemy.engine.Engine - INFO - [cached since 0.05403s ago] {'pk_1': 21}
2025-10-20 00:27:10,366 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,368 - sqlalchemy.engine.Engine - INFO - [cached since 0.05895s ago] {'pk_1': 19}
2025-10-20 00:27:10,372 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,374 - sqlalchemy.engine.Engine - INFO - [cached since 0.06418s ago] {'pk_1': 22}
2025-10-20 00:27:10,379 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,380 - sqlalchemy.engine.Engine - INFO - [cached since 0.07028s ago] {'pk_1': 7}
2025-10-20 00:27:10,384 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,385 - sqlalchemy.engine.Engine - INFO - [cached since 0.07588s ago] {'pk_1': 5}
2025-10-20 00:27:10,389 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,390 - sqlalchemy.engine.Engine - INFO - [cached since 0.0812s ago] {'pk_1': 6}
2025-10-20 00:27:10,394 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:27:10,395 - sqlalchemy.engine.Engine - INFO - [cached since 0.08647s ago] {'pk_1': 8}
2025-10-20 00:27:10,414 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,418 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,422 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,424 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,425 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,427 - sqlalchemy.engine.Engine - INFO - [cached since 0.3628s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,432 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,432 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,434 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:10,441 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,443 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,445 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,446 - sqlalchemy.engine.Engine - INFO - [cached since 0.3825s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,451 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,452 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,455 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:10,465 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,466 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,470 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,471 - sqlalchemy.engine.Engine - INFO - [cached since 0.4063s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,474 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,474 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,477 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:10,489 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,490 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,492 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,494 - sqlalchemy.engine.Engine - INFO - [cached since 0.4299s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,498 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,498 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,501 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:10,504 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:27:10,504 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:27:10,506 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,509 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:27:10,511 - sqlalchemy.engine.Engine - INFO - [cached since 0.3512s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:27:10,516 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:27:10,519 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:10,521 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,522 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:10,523 - sqlalchemy.engine.Engine - INFO - [cached since 0.4587s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:10,526 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:10,526 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:10,538 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:27:10,539 - sqlalchemy.engine.Engine - INFO - [generated in 0.00171s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:27:10,550 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:10,553 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:11,329 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:11,330 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:11,331 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:11,332 - sqlalchemy.engine.Engine - INFO - [cached since 1.268s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:11,335 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:11,337 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:11,339 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:11,350 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:11,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:11,353 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:11,354 - sqlalchemy.engine.Engine - INFO - [cached since 1.291s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:11,359 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:11,360 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:11,362 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:11,367 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:27:11,368 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:27:11,369 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:11,371 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:27:11,372 - sqlalchemy.engine.Engine - INFO - [cached since 1.213s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:27:11,376 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:27:11,380 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:11,409 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:27:11,413 - sqlalchemy.engine.Engine - INFO - [generated in 0.00395s] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:27:11,428 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:11,432 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:12,967 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:12,970 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:12,972 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:12,974 - sqlalchemy.engine.Engine - INFO - [cached since 2.91s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:12,979 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:12,979 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:12,982 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:12,989 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:27:12,991 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:12,993 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:27:12,994 - sqlalchemy.engine.Engine - INFO - [cached since 2.93s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:27:12,999 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:27:12,999 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:13,003 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:27:13,007 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:27:13,008 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:27:13,009 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:13,010 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:27:13,012 - sqlalchemy.engine.Engine - INFO - [cached since 2.852s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:27:13,016 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:27:13,030 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:27:13,035 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:27:13,039 - sqlalchemy.engine.Engine - INFO - [generated in 0.00318s] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-20 00:27:13,047 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:27:13,051 - sqlalchemy.engine.Engine - INFO - [generated in 0.00264s] {'session_id_1': 12}
2025-10-20 00:27:13,056 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:27:13,058 - sqlalchemy.engine.Engine - INFO - [cached since 0.01004s ago] {'session_id_1': 10}
2025-10-20 00:27:13,063 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:27:13,066 - sqlalchemy.engine.Engine - INFO - [cached since 0.01764s ago] {'session_id_1': 11}
2025-10-20 00:27:13,076 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:27:13,079 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:28,161 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:29:31,660 - app.main - INFO - ==================================================
2025-10-20 00:29:31,661 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:29:31,663 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:29:31,663 - app.main - INFO - ==================================================
2025-10-20 00:29:34,214 - app.main - INFO - Starting background tasks...
2025-10-20 00:29:37,996 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:29:38,215 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:29:38,218 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:29:38,221 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:29:38,222 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:29:38,225 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:29:38,226 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:29:38,232 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,245 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:29:38,248 - sqlalchemy.engine.Engine - INFO - [generated in 0.00282s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:29:38,254 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:29:38,254 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,258 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:29:38,277 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:29:38,279 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,282 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:29:38,285 - sqlalchemy.engine.Engine - INFO - [cached since 0.03954s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:29:38,289 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:29:38,290 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,293 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:29:38,300 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:29:38,310 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:29:38,313 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,321 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:29:38,322 - sqlalchemy.engine.Engine - INFO - [generated in 0.00231s] {'id_1': 8, 'param_1': 1}
2025-10-20 00:29:38,328 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:29:38,332 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:29:38,344 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,348 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:29:38,349 - sqlalchemy.engine.Engine - INFO - [cached since 0.1045s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:29:38,356 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:29:38,357 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,365 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,450 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:29:38,468 - sqlalchemy.engine.Engine - INFO - [generated in 0.01874s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:29:38,563 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,577 - sqlalchemy.engine.Engine - INFO - [generated in 0.01513s] {'pk_1': 9}
2025-10-20 00:29:38,596 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,608 - sqlalchemy.engine.Engine - INFO - [cached since 0.04577s ago] {'pk_1': 16}
2025-10-20 00:29:38,622 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,626 - sqlalchemy.engine.Engine - INFO - [cached since 0.06392s ago] {'pk_1': 15}
2025-10-20 00:29:38,638 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,647 - sqlalchemy.engine.Engine - INFO - [cached since 0.08418s ago] {'pk_1': 13}
2025-10-20 00:29:38,663 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,675 - sqlalchemy.engine.Engine - INFO - [cached since 0.112s ago] {'pk_1': 14}
2025-10-20 00:29:38,682 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,684 - sqlalchemy.engine.Engine - INFO - [cached since 0.1215s ago] {'pk_1': 18}
2025-10-20 00:29:38,690 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,692 - sqlalchemy.engine.Engine - INFO - [cached since 0.1291s ago] {'pk_1': 21}
2025-10-20 00:29:38,696 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,699 - sqlalchemy.engine.Engine - INFO - [cached since 0.1362s ago] {'pk_1': 19}
2025-10-20 00:29:38,703 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,704 - sqlalchemy.engine.Engine - INFO - [cached since 0.1433s ago] {'pk_1': 22}
2025-10-20 00:29:38,713 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,724 - sqlalchemy.engine.Engine - INFO - [cached since 0.1617s ago] {'pk_1': 7}
2025-10-20 00:29:38,737 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,744 - sqlalchemy.engine.Engine - INFO - [cached since 0.1815s ago] {'pk_1': 5}
2025-10-20 00:29:38,757 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,761 - sqlalchemy.engine.Engine - INFO - [cached since 0.1991s ago] {'pk_1': 6}
2025-10-20 00:29:38,770 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:29:38,772 - sqlalchemy.engine.Engine - INFO - [cached since 0.2093s ago] {'pk_1': 8}
2025-10-20 00:29:38,793 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,797 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,804 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:29:38,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,821 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:29:38,826 - sqlalchemy.engine.Engine - INFO - [cached since 0.5807s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:29:38,830 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:29:38,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,833 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:29:38,843 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:29:38,847 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,853 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:29:38,857 - sqlalchemy.engine.Engine - INFO - [cached since 0.6125s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:29:38,867 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:29:38,867 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,873 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:29:38,875 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:29:38,877 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:29:38,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,882 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:29:38,886 - sqlalchemy.engine.Engine - INFO - [cached since 0.5659s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:29:38,891 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:29:38,894 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:29:38,896 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,898 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:29:38,901 - sqlalchemy.engine.Engine - INFO - [cached since 0.6572s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:29:38,905 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:29:38,907 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,911 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:38,918 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:29:38,920 - sqlalchemy.engine.Engine - INFO - [generated in 0.00306s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:29:38,933 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:38,940 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:39,518 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:29:39,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:39,521 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:29:39,523 - sqlalchemy.engine.Engine - INFO - [cached since 1.278s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:29:39,528 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:29:39,528 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:39,532 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:29:39,538 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:29:39,539 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:29:39,540 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:39,543 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:29:39,544 - sqlalchemy.engine.Engine - INFO - [cached since 1.224s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:29:39,549 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:29:39,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:39,583 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:29:39,587 - sqlalchemy.engine.Engine - INFO - [generated in 0.00470s] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:29:39,603 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:39,608 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:41,127 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:29:41,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:41,130 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:29:41,133 - sqlalchemy.engine.Engine - INFO - [cached since 2.888s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:29:41,135 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:29:41,137 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:41,140 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:29:41,144 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:29:41,145 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:29:41,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:41,149 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:29:41,151 - sqlalchemy.engine.Engine - INFO - [cached since 2.831s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:29:41,156 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:29:41,167 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:29:41,173 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:29:41,174 - sqlalchemy.engine.Engine - INFO - [generated in 0.00239s] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-20 00:29:41,188 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:29:41,191 - sqlalchemy.engine.Engine - INFO - [generated in 0.00210s] {'session_id_1': 12}
2025-10-20 00:29:41,196 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:29:41,199 - sqlalchemy.engine.Engine - INFO - [cached since 0.01153s ago] {'session_id_1': 10}
2025-10-20 00:29:41,206 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:29:41,209 - sqlalchemy.engine.Engine - INFO - [cached since 0.02118s ago] {'session_id_1': 11}
2025-10-20 00:29:41,220 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:29:41,225 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:01,467 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:30:01,469 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:01,471 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:30:01,472 - sqlalchemy.engine.Engine - INFO - [cached since 23.23s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:30:01,475 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:30:01,475 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:01,476 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:30:01,481 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:30:01,482 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:30:01,482 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:01,484 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:30:01,486 - sqlalchemy.engine.Engine - INFO - [cached since 23.16s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:30:01,488 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:30:01,491 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:01,493 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:30:01,494 - sqlalchemy.engine.Engine - INFO - [cached since 20.32s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-20 00:30:01,497 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:01,498 - sqlalchemy.engine.Engine - INFO - [cached since 20.31s ago] {'session_id_1': 12}
2025-10-20 00:30:01,502 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:01,502 - sqlalchemy.engine.Engine - INFO - [cached since 20.31s ago] {'session_id_1': 10}
2025-10-20 00:30:01,508 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:01,508 - sqlalchemy.engine.Engine - INFO - [cached since 20.32s ago] {'session_id_1': 11}
2025-10-20 00:30:01,512 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:01,515 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:04,703 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:30:04,706 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:04,707 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:30:04,709 - sqlalchemy.engine.Engine - INFO - [cached since 26.46s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:30:04,712 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:30:04,712 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:04,714 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:30:04,717 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:30:04,717 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:30:04,719 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:04,719 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:30:04,721 - sqlalchemy.engine.Engine - INFO - [cached since 26.4s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:30:04,723 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:30:04,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:04,727 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:30:04,729 - sqlalchemy.engine.Engine - INFO - [cached since 23.56s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-20 00:30:04,733 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:04,735 - sqlalchemy.engine.Engine - INFO - [cached since 23.55s ago] {'session_id_1': 12}
2025-10-20 00:30:04,737 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:04,739 - sqlalchemy.engine.Engine - INFO - [cached since 23.55s ago] {'session_id_1': 10}
2025-10-20 00:30:04,742 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:04,744 - sqlalchemy.engine.Engine - INFO - [cached since 23.56s ago] {'session_id_1': 11}
2025-10-20 00:30:04,750 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:04,752 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:14,977 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:30:14,978 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:14,979 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:30:14,982 - sqlalchemy.engine.Engine - INFO - [cached since 36.74s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:30:14,984 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:30:14,984 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:14,984 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:30:14,987 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:30:14,988 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:30:14,989 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:14,991 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:30:14,991 - sqlalchemy.engine.Engine - INFO - [cached since 36.67s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:30:14,994 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:30:14,996 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:30:14,997 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:30:14,998 - sqlalchemy.engine.Engine - INFO - [cached since 33.83s ago] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-20 00:30:15,003 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:15,004 - sqlalchemy.engine.Engine - INFO - [cached since 33.82s ago] {'session_id_1': 12}
2025-10-20 00:30:15,007 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:15,008 - sqlalchemy.engine.Engine - INFO - [cached since 33.82s ago] {'session_id_1': 10}
2025-10-20 00:30:15,012 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:30:15,012 - sqlalchemy.engine.Engine - INFO - [cached since 33.82s ago] {'session_id_1': 11}
2025-10-20 00:30:15,020 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:30:15,023 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:32:09,192 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:32:58,349 - app.main - INFO - ==================================================
2025-10-20 00:32:58,350 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:32:58,351 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:32:58,351 - app.main - INFO - ==================================================
2025-10-20 00:33:01,089 - app.main - INFO - Starting background tasks...
2025-10-20 00:33:04,688 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:04,858 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:33:04,860 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:33:04,864 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:33:04,865 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:33:04,869 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:33:04,878 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:33:04,888 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:04,902 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:04,907 - sqlalchemy.engine.Engine - INFO - [generated in 0.00376s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:04,912 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:04,913 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:04,916 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:04,930 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:04,933 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:04,937 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:04,938 - sqlalchemy.engine.Engine - INFO - [cached since 0.03544s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:04,942 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:04,942 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:04,945 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:04,949 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:33:04,960 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:33:04,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:04,970 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:04,971 - sqlalchemy.engine.Engine - INFO - [generated in 0.00241s] {'id_1': 8, 'param_1': 1}
2025-10-20 00:33:04,977 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:33:04,981 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:05,003 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:05,005 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:05,007 - sqlalchemy.engine.Engine - INFO - [cached since 0.1046s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:05,014 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:05,015 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,026 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:05,079 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:33:05,082 - sqlalchemy.engine.Engine - INFO - [generated in 0.00356s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:33:05,132 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,135 - sqlalchemy.engine.Engine - INFO - [generated in 0.00283s] {'pk_1': 9}
2025-10-20 00:33:05,141 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,142 - sqlalchemy.engine.Engine - INFO - [cached since 0.01075s ago] {'pk_1': 16}
2025-10-20 00:33:05,150 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,153 - sqlalchemy.engine.Engine - INFO - [cached since 0.02034s ago] {'pk_1': 15}
2025-10-20 00:33:05,158 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,159 - sqlalchemy.engine.Engine - INFO - [cached since 0.02724s ago] {'pk_1': 13}
2025-10-20 00:33:05,165 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,167 - sqlalchemy.engine.Engine - INFO - [cached since 0.03584s ago] {'pk_1': 14}
2025-10-20 00:33:05,174 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,176 - sqlalchemy.engine.Engine - INFO - [cached since 0.04437s ago] {'pk_1': 18}
2025-10-20 00:33:05,180 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,182 - sqlalchemy.engine.Engine - INFO - [cached since 0.05062s ago] {'pk_1': 21}
2025-10-20 00:33:05,187 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,189 - sqlalchemy.engine.Engine - INFO - [cached since 0.05738s ago] {'pk_1': 19}
2025-10-20 00:33:05,194 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,196 - sqlalchemy.engine.Engine - INFO - [cached since 0.06388s ago] {'pk_1': 22}
2025-10-20 00:33:05,204 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,207 - sqlalchemy.engine.Engine - INFO - [cached since 0.07481s ago] {'pk_1': 7}
2025-10-20 00:33:05,213 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,215 - sqlalchemy.engine.Engine - INFO - [cached since 0.08382s ago] {'pk_1': 5}
2025-10-20 00:33:05,222 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,224 - sqlalchemy.engine.Engine - INFO - [cached since 0.09189s ago] {'pk_1': 6}
2025-10-20 00:33:05,229 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:33:05,230 - sqlalchemy.engine.Engine - INFO - [cached since 0.0988s ago] {'pk_1': 8}
2025-10-20 00:33:05,256 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,259 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,266 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:05,269 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:05,270 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:05,273 - sqlalchemy.engine.Engine - INFO - [cached since 0.3705s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:05,276 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:05,278 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,280 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:05,292 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:05,295 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:05,299 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:05,306 - sqlalchemy.engine.Engine - INFO - [cached since 0.4035s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:05,318 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:05,319 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,324 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:05,328 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:33:05,329 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:33:05,331 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:05,337 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:05,339 - sqlalchemy.engine.Engine - INFO - [cached since 0.37s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:33:05,344 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:33:05,349 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:05,352 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:05,356 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:05,359 - sqlalchemy.engine.Engine - INFO - [cached since 0.4563s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:05,363 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:05,365 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:05,386 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:33:05,393 - sqlalchemy.engine.Engine - INFO - [generated in 0.00560s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:33:05,407 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,411 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,980 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:05,983 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:05,985 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:05,987 - sqlalchemy.engine.Engine - INFO - [cached since 1.085s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:05,992 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:05,993 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:05,996 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:06,000 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:33:06,001 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:33:06,003 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:06,007 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:06,009 - sqlalchemy.engine.Engine - INFO - [cached since 1.04s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:33:06,012 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:33:06,017 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:06,053 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:33:06,057 - sqlalchemy.engine.Engine - INFO - [generated in 0.00414s] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:33:06,075 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:06,080 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:07,809 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:07,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:07,812 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:07,814 - sqlalchemy.engine.Engine - INFO - [cached since 2.911s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:07,817 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:07,817 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:07,819 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:07,823 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:33:07,824 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:33:07,825 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:07,826 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:07,827 - sqlalchemy.engine.Engine - INFO - [cached since 2.859s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:33:07,832 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:33:07,836 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:07,838 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:33:07,842 - sqlalchemy.engine.Engine - INFO - [cached since 1.788s ago] {'opened_by_user_id_1': 8, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:33:07,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:07,857 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:08,544 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:08,547 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:08,549 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:08,551 - sqlalchemy.engine.Engine - INFO - [cached since 3.648s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:08,555 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:08,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:08,559 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:08,564 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTI2MTQsInN1YiI6IjgiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.CFQlRpvc6f7e0VXIsZwVJJdbu1YZCXKzsl8O6iXGzT8
2025-10-20 00:33:08,566 - app.services.user - DEBUG - Decoded payload: {'exp': 1760992614, 'sub': '8', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:33:08,568 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:08,571 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:08,574 - sqlalchemy.engine.Engine - INFO - [cached since 3.605s ago] {'id_1': 8, 'param_1': 1}
2025-10-20 00:33:08,578 - app.services.user - DEBUG - Found user: cashier-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:33:08,595 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:08,600 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s AND cash_register_sessions.cashier_id = %(cashier_id_1)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:33:08,603 - sqlalchemy.engine.Engine - INFO - [generated in 0.00403s] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'cashier_id_1': 8, 'param_1': 0, 'param_2': 100}
2025-10-20 00:33:08,615 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:33:08,617 - sqlalchemy.engine.Engine - INFO - [generated in 0.00239s] {'session_id_1': 11}
2025-10-20 00:33:08,629 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:08,633 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:14,485 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:14,488 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:14,489 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:14,491 - sqlalchemy.engine.Engine - INFO - [cached since 9.588s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:14,494 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:14,494 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:14,496 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:14,499 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:33:14,500 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:33:14,501 - multipart.multipart - DEBUG - Calling on_field_data with data[9:31]
2025-10-20 00:33:14,502 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:33:14,502 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:33:14,502 - multipart.multipart - DEBUG - Calling on_field_name with data[32:40]
2025-10-20 00:33:14,502 - multipart.multipart - DEBUG - Calling on_field_data with data[41:49]
2025-10-20 00:33:14,502 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:33:14,502 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:33:14,505 - multipart.multipart - DEBUG - Calling on_field_name with data[50:60]
2025-10-20 00:33:14,505 - multipart.multipart - DEBUG - Calling on_field_data with data[61:69]
2025-10-20 00:33:14,505 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:33:14,506 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:33:14,506 - multipart.multipart - DEBUG - Calling on_field_name with data[70:75]
2025-10-20 00:33:14,507 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:33:14,507 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:33:14,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:14,515 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:14,517 - sqlalchemy.engine.Engine - INFO - [generated in 0.00205s] {'email_1': 'admin@coffeeshop.com', 'param_1': 1}
2025-10-20 00:33:14,522 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-20 00:33:14,524 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-20 00:33:15,176 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:15,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:15,182 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:15,184 - sqlalchemy.engine.Engine - INFO - [cached since 10.28s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:15,189 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:15,189 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:15,201 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:15,207 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:15,209 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:15,212 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:15,214 - sqlalchemy.engine.Engine - INFO - [cached since 10.31s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:15,218 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:15,219 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:15,223 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:15,232 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:15,235 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:15,237 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:15,241 - sqlalchemy.engine.Engine - INFO - [cached since 10.34s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:15,245 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:15,246 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:15,251 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:15,254 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:15,256 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:15,258 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:15,261 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:15,263 - sqlalchemy.engine.Engine - INFO - [cached since 10.29s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:15,267 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:15,295 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,053 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:16,055 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,056 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:16,057 - sqlalchemy.engine.Engine - INFO - [cached since 11.15s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:16,060 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:16,061 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,064 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:16,073 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:16,075 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,078 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:16,079 - sqlalchemy.engine.Engine - INFO - [cached since 11.18s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:16,083 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:16,084 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,087 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:16,092 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:16,093 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:16,094 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,096 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:16,098 - sqlalchemy.engine.Engine - INFO - [cached since 11.13s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:16,104 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:16,106 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:16,108 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,111 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:16,113 - sqlalchemy.engine.Engine - INFO - [cached since 11.21s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:16,118 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:16,118 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,122 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,127 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:33:16,130 - sqlalchemy.engine.Engine - INFO - [generated in 0.00244s] {'restaurant_id_1': 1}
2025-10-20 00:33:16,141 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,145 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,152 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:16,155 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,157 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:16,158 - sqlalchemy.engine.Engine - INFO - [cached since 11.26s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:16,162 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:16,162 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,164 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:16,175 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:16,176 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,179 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:16,183 - sqlalchemy.engine.Engine - INFO - [cached since 11.28s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:16,188 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:16,189 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,191 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:16,204 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:16,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,209 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:16,210 - sqlalchemy.engine.Engine - INFO - [cached since 11.31s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:16,216 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:16,216 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,220 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:16,240 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:16,241 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,243 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:16,244 - sqlalchemy.engine.Engine - INFO - [cached since 11.34s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:16,247 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:16,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,249 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:16,253 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:16,255 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:16,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,257 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:16,259 - sqlalchemy.engine.Engine - INFO - [cached since 11.29s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:16,263 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:16,265 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:16,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,267 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:16,269 - sqlalchemy.engine.Engine - INFO - [cached since 11.37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:16,272 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:16,273 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,276 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:16,294 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:33:16,295 - sqlalchemy.engine.Engine - INFO - [generated in 0.00262s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:33:16,331 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:16,336 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:25,660 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:25,661 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:25,663 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:25,665 - sqlalchemy.engine.Engine - INFO - [cached since 20.76s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:25,669 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:25,669 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:25,670 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:25,674 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:25,674 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:25,675 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:25,677 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:25,678 - sqlalchemy.engine.Engine - INFO - [cached since 20.71s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:25,680 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:25,684 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:25,685 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.cash_register_sessions_opened_at AS anon_1_cash_register_sessions_opened_at, anon_1.cash_register_sessions_closed_at AS anon_1_cash_register_sessions_closed_at, anon_1.cash_register_sessions_opened_by_user_id AS anon_1_cash_register_sessions_opened_by_user_id, anon_1.cash_register_sessions_cashier_id AS anon_1_cash_register_sessions_cashier_id, anon_1.cash_register_sessions_initial_balance AS anon_1_cash_register_sessions_initial_balance, anon_1.cash_register_sessions_final_balance AS anon_1_cash_register_sessions_final_balance, anon_1.cash_register_sessions_expected_balance AS anon_1_cash_register_sessions_expected_balance, anon_1.cash_register_sessions_actual_balance AS anon_1_cash_register_sessions_actual_balance, anon_1.cash_register_sessions_status AS anon_1_cash_register_sessions_status, anon_1.cash_register_sessions_notes AS anon_1_cash_register_sessions_notes, anon_1.cash_register_sessions_id AS anon_1_cash_register_sessions_id, anon_1.cash_register_sessions_created_at AS anon_1_cash_register_sessions_created_at, anon_1.cash_register_sessions_updated_at AS anon_1_cash_register_sessions_updated_at, anon_1.cash_register_sessions_deleted_at AS anon_1_cash_register_sessions_deleted_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, cash_transactions_1.session_id AS cash_transactions_1_session_id, cash_transactions_1.transaction_type AS cash_transactions_1_transaction_type, cash_transactions_1.amount AS cash_transactions_1_amount, cash_transactions_1.description AS cash_transactions_1_description, cash_transactions_1.order_id AS cash_transactions_1_order_id, cash_transactions_1.created_by_user_id AS cash_transactions_1_created_by_user_id, cash_transactions_1.payment_method AS cash_transactions_1_payment_method, cash_transactions_1.category AS cash_transactions_1_category, cash_transactions_1.id AS cash_transactions_1_id, cash_transactions_1.created_at AS cash_transactions_1_created_at, cash_transactions_1.updated_at AS cash_transactions_1_updated_at, cash_transactions_1.deleted_at AS cash_transactions_1_deleted_at, cash_register_reports_1.session_id AS cash_register_reports_1_session_id, cash_register_reports_1.report_type AS cash_register_reports_1_report_type, cash_register_reports_1.data AS cash_register_reports_1_data, cash_register_reports_1.generated_at AS cash_register_reports_1_generated_at, cash_register_reports_1.id AS cash_register_reports_1_id, cash_register_reports_1.created_at AS cash_register_reports_1_created_at, cash_register_reports_1.updated_at AS cash_register_reports_1_updated_at, cash_register_reports_1.deleted_at AS cash_register_reports_1_deleted_at 
FROM (SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.opened_by_user_id = %(opened_by_user_id_1)s AND cash_register_sessions.status = %(status_1)s ORDER BY cash_register_sessions.opened_at DESC 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.cash_register_sessions_opened_by_user_id LEFT OUTER JOIN cash_transactions AS cash_transactions_1 ON anon_1.cash_register_sessions_id = cash_transactions_1.session_id LEFT OUTER JOIN cash_register_reports AS cash_register_reports_1 ON anon_1.cash_register_sessions_id = cash_register_reports_1.session_id ORDER BY anon_1.cash_register_sessions_opened_at DESC
2025-10-20 00:33:25,688 - sqlalchemy.engine.Engine - INFO - [cached since 19.63s ago] {'opened_by_user_id_1': 3, 'status_1': 'OPEN', 'param_1': 1}
2025-10-20 00:33:25,696 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:25,698 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:26,811 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:26,813 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:26,815 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:26,816 - sqlalchemy.engine.Engine - INFO - [cached since 21.91s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:26,820 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:26,820 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:26,822 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:26,825 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:26,826 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:26,827 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:26,828 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:26,829 - sqlalchemy.engine.Engine - INFO - [cached since 21.86s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:26,832 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:26,833 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:26,839 - sqlalchemy.engine.Engine - INFO - SELECT cash_register_sessions.opened_at AS cash_register_sessions_opened_at, cash_register_sessions.closed_at AS cash_register_sessions_closed_at, cash_register_sessions.opened_by_user_id AS cash_register_sessions_opened_by_user_id, cash_register_sessions.cashier_id AS cash_register_sessions_cashier_id, cash_register_sessions.initial_balance AS cash_register_sessions_initial_balance, cash_register_sessions.final_balance AS cash_register_sessions_final_balance, cash_register_sessions.expected_balance AS cash_register_sessions_expected_balance, cash_register_sessions.actual_balance AS cash_register_sessions_actual_balance, cash_register_sessions.status AS cash_register_sessions_status, cash_register_sessions.notes AS cash_register_sessions_notes, cash_register_sessions.id AS cash_register_sessions_id, cash_register_sessions.created_at AS cash_register_sessions_created_at, cash_register_sessions.updated_at AS cash_register_sessions_updated_at, cash_register_sessions.deleted_at AS cash_register_sessions_deleted_at 
FROM cash_register_sessions 
WHERE cash_register_sessions.status = %(status_1)s AND cash_register_sessions.closed_at >= %(closed_at_1)s AND cash_register_sessions.closed_at <= %(closed_at_2)s ORDER BY cash_register_sessions.closed_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:33:26,840 - sqlalchemy.engine.Engine - INFO - [generated in 0.00150s] {'status_1': 'CLOSED', 'closed_at_1': datetime.datetime(2025, 10, 13, 0, 0), 'closed_at_2': datetime.datetime(2025, 10, 20, 23, 59, 59, 999999), 'param_1': 0, 'param_2': 100}
2025-10-20 00:33:26,844 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:33:26,846 - sqlalchemy.engine.Engine - INFO - [cached since 18.23s ago] {'session_id_1': 12}
2025-10-20 00:33:26,849 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:33:26,850 - sqlalchemy.engine.Engine - INFO - [cached since 18.23s ago] {'session_id_1': 10}
2025-10-20 00:33:26,853 - sqlalchemy.engine.Engine - INFO - SELECT cash_transactions.session_id AS cash_transactions_session_id, cash_transactions.transaction_type AS cash_transactions_transaction_type, cash_transactions.amount AS cash_transactions_amount, cash_transactions.description AS cash_transactions_description, cash_transactions.order_id AS cash_transactions_order_id, cash_transactions.created_by_user_id AS cash_transactions_created_by_user_id, cash_transactions.payment_method AS cash_transactions_payment_method, cash_transactions.category AS cash_transactions_category, cash_transactions.id AS cash_transactions_id, cash_transactions.created_at AS cash_transactions_created_at, cash_transactions.updated_at AS cash_transactions_updated_at, cash_transactions.deleted_at AS cash_transactions_deleted_at 
FROM cash_transactions 
WHERE cash_transactions.session_id = %(session_id_1)s ORDER BY cash_transactions.id DESC
2025-10-20 00:33:26,855 - sqlalchemy.engine.Engine - INFO - [cached since 18.24s ago] {'session_id_1': 11}
2025-10-20 00:33:26,865 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:26,872 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,741 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:38,744 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,745 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:38,747 - sqlalchemy.engine.Engine - INFO - [cached since 33.85s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:38,751 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:38,753 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,755 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:38,764 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:38,766 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,768 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:38,770 - sqlalchemy.engine.Engine - INFO - [cached since 33.87s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:38,773 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:38,773 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,775 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:38,782 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:38,783 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,787 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:38,788 - sqlalchemy.engine.Engine - INFO - [cached since 33.89s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:38,792 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:38,792 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,795 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:38,800 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:38,802 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,804 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:38,806 - sqlalchemy.engine.Engine - INFO - [cached since 33.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:38,809 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:38,810 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,814 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:38,816 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:38,818 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,821 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:38,823 - sqlalchemy.engine.Engine - INFO - [cached since 33.85s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:38,826 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:38,830 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,836 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:33:38,838 - sqlalchemy.engine.Engine - INFO - [generated in 0.00225s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:33:38,850 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,859 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:38,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,865 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:38,868 - sqlalchemy.engine.Engine - INFO - [cached since 33.96s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:38,873 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:38,873 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,876 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:38,880 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:38,880 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:38,883 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,884 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:38,889 - sqlalchemy.engine.Engine - INFO - [cached since 33.92s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:38,893 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:38,895 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:38,896 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,898 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:38,901 - sqlalchemy.engine.Engine - INFO - [cached since 34s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:38,904 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:38,905 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:38,913 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:38,923 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:33:38,925 - sqlalchemy.engine.Engine - INFO - [generated in 0.00296s] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:33:38,933 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:33:38,938 - sqlalchemy.engine.Engine - INFO - [cached since 0.01568s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:33:38,954 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:33:38,956 - sqlalchemy.engine.Engine - INFO - [generated in 0.00304s] {'pk_1': 4}
2025-10-20 00:33:38,968 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:33:38,970 - sqlalchemy.engine.Engine - INFO - [generated in 0.00224s] {'param_1': 12}
2025-10-20 00:33:38,990 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:33:38,992 - sqlalchemy.engine.Engine - INFO - [generated in 0.00203s] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:33:38,998 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:33:39,000 - sqlalchemy.engine.Engine - INFO - [cached since 0.0102s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:33:39,007 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:33:39,008 - sqlalchemy.engine.Engine - INFO - [cached since 0.01825s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:33:39,013 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:33:39,014 - sqlalchemy.engine.Engine - INFO - [cached since 0.0249s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:33:39,023 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:33:39,026 - sqlalchemy.engine.Engine - INFO - [cached since 0.03588s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:33:39,039 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:33:39,041 - sqlalchemy.engine.Engine - INFO - [generated in 0.00337s] {'restaurant_id_1': 1}
2025-10-20 00:33:39,054 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:33:39,056 - sqlalchemy.engine.Engine - INFO - [generated in 0.00243s] {'restaurant_id_1': 1}
2025-10-20 00:33:39,071 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:33:39,075 - sqlalchemy.engine.Engine - INFO - [generated in 0.00393s] {'restaurant_id_1': 1}
2025-10-20 00:33:39,090 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:39,096 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:45,116 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:45,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:45,121 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:45,122 - sqlalchemy.engine.Engine - INFO - [cached since 40.22s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:45,127 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:45,128 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:45,131 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:45,142 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:45,143 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:45,147 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:45,150 - sqlalchemy.engine.Engine - INFO - [cached since 40.25s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:45,155 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:45,155 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:45,160 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:45,164 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:45,167 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:45,170 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:45,173 - sqlalchemy.engine.Engine - INFO - [cached since 40.27s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:45,178 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:45,178 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:45,184 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:45,186 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:45,187 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:45,191 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:45,193 - sqlalchemy.engine.Engine - INFO - [cached since 40.22s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:45,198 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:45,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:45,212 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:45,217 - sqlalchemy.engine.Engine - INFO - [cached since 40.25s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:33:45,224 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:45,231 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:45,237 - app.main - CRITICAL - Unhandled exception: AttributeError: 'UserUpdate' object has no attribute 'restaurant_id'
Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\anyio\streams\memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\anyio\streams\memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\anyio\streams\memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\middleware\restaurant.py", line 139, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 84, in call_next
    raise app_exc
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\middleware\security.py", line 23, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 84, in call_next
    raise app_exc
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\api\routers\restaurant_users.py", line 194, in update_restaurant_user
    if user.restaurant_id is not None and current_user.role != UserRole.SYSADMIN:
       ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pydantic\main.py", line 761, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'UserUpdate' object has no attribute 'restaurant_id'
2025-10-20 00:33:56,493 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:56,495 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:56,496 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:56,498 - sqlalchemy.engine.Engine - INFO - [cached since 51.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:56,500 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:56,501 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:56,502 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:33:56,503 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:33:56,504 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:56,504 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:33:56,506 - sqlalchemy.engine.Engine - INFO - [cached since 51.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:33:56,507 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:33:56,508 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:56,509 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:33:56,511 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:33:56,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:56,513 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:56,514 - sqlalchemy.engine.Engine - INFO - [cached since 51.54s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:33:56,515 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:33:56,519 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:33:56,520 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:33:56,520 - sqlalchemy.engine.Engine - INFO - [cached since 51.55s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:33:56,523 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:56,527 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:33:56,530 - app.main - CRITICAL - Unhandled exception: AttributeError: 'UserUpdate' object has no attribute 'restaurant_id'
Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\anyio\streams\memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\anyio\streams\memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\anyio\streams\memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\middleware\restaurant.py", line 139, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 84, in call_next
    raise app_exc
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\middleware\security.py", line 23, in dispatch
    response: Response = await call_next(request)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 84, in call_next
    raise app_exc
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\fastapi\routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\app\api\routers\restaurant_users.py", line 194, in update_restaurant_user
    if user.restaurant_id is not None and current_user.role != UserRole.SYSADMIN:
       ^^^^^^^^^^^^^^^^^^
  File "c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\venv\Lib\site-packages\pydantic\main.py", line 761, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'UserUpdate' object has no attribute 'restaurant_id'
2025-10-20 00:34:51,522 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:34:55,483 - app.main - INFO - ==================================================
2025-10-20 00:34:55,484 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:34:55,485 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:34:55,487 - app.main - INFO - ==================================================
2025-10-20 00:34:58,039 - app.main - INFO - Starting background tasks...
2025-10-20 00:35:01,234 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:01,485 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:35:01,488 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:35:01,492 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:35:01,492 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:35:01,496 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:35:01,497 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:35:01,500 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,514 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:01,516 - sqlalchemy.engine.Engine - INFO - [generated in 0.00217s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:01,521 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:01,521 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,524 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:01,530 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:01,533 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,535 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:01,538 - sqlalchemy.engine.Engine - INFO - [cached since 0.02495s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:01,543 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:01,543 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,545 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:01,546 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:01,558 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:01,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,565 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:01,567 - sqlalchemy.engine.Engine - INFO - [generated in 0.00188s] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:01,571 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:01,574 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:01,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,582 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:01,586 - sqlalchemy.engine.Engine - INFO - [cached since 0.07295s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:01,591 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:01,592 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,603 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,613 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:35:01,615 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:01,617 - sqlalchemy.engine.Engine - INFO - [generated in 0.00393s] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:35:01,626 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:35:01,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,628 - sqlalchemy.engine.Engine - INFO - [cached since 0.01576s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:35:01,629 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:01,645 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:35:01,646 - sqlalchemy.engine.Engine - INFO - [cached since 0.1327s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:01,647 - sqlalchemy.engine.Engine - INFO - [generated in 0.00311s] {'pk_1': 4}
2025-10-20 00:35:01,653 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:01,654 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,663 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:35:01,666 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:01,665 - sqlalchemy.engine.Engine - INFO - [generated in 0.00195s] {'param_1': 12}
2025-10-20 00:35:01,686 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:01,686 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:01,684 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:01,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,688 - sqlalchemy.engine.Engine - INFO - [generated in 0.00480s] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:35:01,691 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:01,692 - sqlalchemy.engine.Engine - INFO - [cached since 0.128s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:01,695 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:01,696 - sqlalchemy.engine.Engine - INFO - [cached since 0.01237s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:35:01,698 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:01,706 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:01,704 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:01,708 - sqlalchemy.engine.Engine - INFO - [cached since 0.0233s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:35:01,711 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:01,712 - sqlalchemy.engine.Engine - INFO - [cached since 0.02788s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:35:01,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,717 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:01,718 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:01,720 - sqlalchemy.engine.Engine - INFO - [cached since 0.03483s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:35:01,720 - sqlalchemy.engine.Engine - INFO - [cached since 0.2082s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:01,736 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:01,734 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:01,737 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,739 - sqlalchemy.engine.Engine - INFO - [generated in 0.00484s] {'restaurant_id_1': 1}
2025-10-20 00:35:01,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,757 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:01,792 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:35:01,795 - sqlalchemy.engine.Engine - INFO - [generated in 0.03748s] {'restaurant_id_1': 1}
2025-10-20 00:35:01,797 - sqlalchemy.engine.Engine - INFO - [generated in 0.00389s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:35:01,807 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:01,810 - sqlalchemy.engine.Engine - INFO - [generated in 0.00351s] {'restaurant_id_1': 1}
2025-10-20 00:35:01,849 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,852 - sqlalchemy.engine.Engine - INFO - [generated in 0.00282s] {'pk_1': 9}
2025-10-20 00:35:01,859 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,861 - sqlalchemy.engine.Engine - INFO - [cached since 0.01263s ago] {'pk_1': 16}
2025-10-20 00:35:01,865 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,868 - sqlalchemy.engine.Engine - INFO - [cached since 0.01992s ago] {'pk_1': 15}
2025-10-20 00:35:01,875 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,877 - sqlalchemy.engine.Engine - INFO - [cached since 0.02801s ago] {'pk_1': 13}
2025-10-20 00:35:01,880 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,884 - sqlalchemy.engine.Engine - INFO - [cached since 0.03471s ago] {'pk_1': 14}
2025-10-20 00:35:01,887 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,889 - sqlalchemy.engine.Engine - INFO - [cached since 0.0419s ago] {'pk_1': 18}
2025-10-20 00:35:01,895 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,897 - sqlalchemy.engine.Engine - INFO - [cached since 0.04852s ago] {'pk_1': 21}
2025-10-20 00:35:01,902 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,903 - sqlalchemy.engine.Engine - INFO - [cached since 0.05512s ago] {'pk_1': 19}
2025-10-20 00:35:01,909 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,911 - sqlalchemy.engine.Engine - INFO - [cached since 0.06183s ago] {'pk_1': 22}
2025-10-20 00:35:01,916 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,917 - sqlalchemy.engine.Engine - INFO - [cached since 0.06882s ago] {'pk_1': 7}
2025-10-20 00:35:01,922 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,923 - sqlalchemy.engine.Engine - INFO - [cached since 0.07526s ago] {'pk_1': 5}
2025-10-20 00:35:01,929 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,930 - sqlalchemy.engine.Engine - INFO - [cached since 0.08207s ago] {'pk_1': 6}
2025-10-20 00:35:01,936 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:35:01,942 - sqlalchemy.engine.Engine - INFO - [cached since 0.09226s ago] {'pk_1': 8}
2025-10-20 00:35:01,966 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,968 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,970 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,971 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,974 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:01,976 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:01,978 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:01,980 - sqlalchemy.engine.Engine - INFO - [cached since 0.4668s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:01,983 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:01,983 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:01,990 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:02,002 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:02,003 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,005 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:02,006 - sqlalchemy.engine.Engine - INFO - [cached since 0.4941s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:02,010 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:02,011 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,012 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:02,016 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:02,016 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:02,018 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,020 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:02,022 - sqlalchemy.engine.Engine - INFO - [cached since 0.4569s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:02,025 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:02,028 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:02,029 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,031 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:02,032 - sqlalchemy.engine.Engine - INFO - [cached since 0.5199s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:02,037 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:02,037 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,043 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,047 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:35:02,051 - sqlalchemy.engine.Engine - INFO - [generated in 0.00424s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:35:02,069 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,073 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,357 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:02,359 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,361 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:02,363 - sqlalchemy.engine.Engine - INFO - [cached since 0.8498s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:02,367 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:02,368 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,371 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:02,373 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:02,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,378 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:02,380 - sqlalchemy.engine.Engine - INFO - [cached since 0.8668s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:02,385 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:02,386 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,388 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:02,392 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:02,393 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:02,394 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,397 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:02,399 - sqlalchemy.engine.Engine - INFO - [cached since 0.8332s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:02,403 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:02,404 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:02,407 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,410 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:02,412 - sqlalchemy.engine.Engine - INFO - [cached since 0.8986s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:02,416 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:02,417 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,422 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:02,423 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:02,426 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,427 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:02,430 - sqlalchemy.engine.Engine - INFO - [cached since 0.8647s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:02,434 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:02,435 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:02,437 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,439 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:02,442 - sqlalchemy.engine.Engine - INFO - [cached since 0.9284s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:02,446 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:02,446 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,480 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:35:02,483 - sqlalchemy.engine.Engine - INFO - [generated in 0.00231s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:35:02,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:02,516 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:35:02,517 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,519 - sqlalchemy.engine.Engine - INFO - [cached since 0.906s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:35:02,524 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,528 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:35:02,532 - sqlalchemy.engine.Engine - INFO - [cached since 0.919s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:35:02,543 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:35:02,545 - sqlalchemy.engine.Engine - INFO - [cached since 0.9002s ago] {'pk_1': 4}
2025-10-20 00:35:02,552 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:35:02,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.8924s ago] {'param_1': 12}
2025-10-20 00:35:02,561 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:02,563 - sqlalchemy.engine.Engine - INFO - [cached since 0.8783s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:35:02,569 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:02,571 - sqlalchemy.engine.Engine - INFO - [cached since 0.8864s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:35:02,576 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:02,577 - sqlalchemy.engine.Engine - INFO - [cached since 0.8931s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:35:02,583 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:02,584 - sqlalchemy.engine.Engine - INFO - [cached since 0.9002s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:35:02,592 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:02,593 - sqlalchemy.engine.Engine - INFO - [cached since 0.9091s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:35:02,598 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:02,600 - sqlalchemy.engine.Engine - INFO - [cached since 0.866s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:02,606 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:02,606 - sqlalchemy.engine.Engine - INFO - [cached since 0.8501s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:02,612 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:02,614 - sqlalchemy.engine.Engine - INFO - [cached since 0.8071s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:02,627 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:02,630 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,525 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:29,526 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,528 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:29,530 - sqlalchemy.engine.Engine - INFO - [cached since 28.02s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:29,534 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:29,534 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,537 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:29,540 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:29,542 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,544 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:29,546 - sqlalchemy.engine.Engine - INFO - [cached since 28.03s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:29,551 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:29,552 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,556 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:29,556 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:29,558 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,559 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:29,561 - sqlalchemy.engine.Engine - INFO - [cached since 28s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:29,564 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:29,568 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,571 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:29,572 - sqlalchemy.engine.Engine - INFO - [cached since 28.01s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:35:29,578 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-20 00:35:29,580 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,583 - sqlalchemy.engine.Engine - INFO - SELECT users.email, users.hashed_password, users.full_name, users.`role`, users.staff_type, users.is_active, users.restaurant_id, users.id, users.created_at, users.updated_at, users.deleted_at 
FROM users 
WHERE users.id = %(pk_1)s
2025-10-20 00:35:29,585 - sqlalchemy.engine.Engine - INFO - [generated in 0.00173s] {'pk_1': 7}
2025-10-20 00:35:29,594 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,598 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,603 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:29,605 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,607 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:29,609 - sqlalchemy.engine.Engine - INFO - [cached since 28.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:29,613 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:29,613 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,616 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:29,621 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:29,622 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,624 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:29,626 - sqlalchemy.engine.Engine - INFO - [cached since 28.11s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:29,630 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:29,630 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,634 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:29,634 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:29,637 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,638 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:29,640 - sqlalchemy.engine.Engine - INFO - [cached since 28.07s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:29,643 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:29,647 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,648 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:35:29,650 - sqlalchemy.engine.Engine - INFO - [cached since 27.17s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:35:29,702 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,721 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,727 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:29,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,742 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:29,746 - sqlalchemy.engine.Engine - INFO - [cached since 28.23s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:29,775 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:29,778 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,794 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:29,810 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:29,815 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:29,823 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,830 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:29,837 - sqlalchemy.engine.Engine - INFO - [cached since 28.27s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:29,849 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:29,856 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:29,865 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,869 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:29,871 - sqlalchemy.engine.Engine - INFO - [cached since 28.36s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:29,874 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:29,874 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,880 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:29,882 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:35:29,884 - sqlalchemy.engine.Engine - INFO - [cached since 28.27s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:35:29,889 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:35:29,890 - sqlalchemy.engine.Engine - INFO - [cached since 28.28s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:35:29,894 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:35:29,896 - sqlalchemy.engine.Engine - INFO - [cached since 28.25s ago] {'pk_1': 4}
2025-10-20 00:35:29,902 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:35:29,906 - sqlalchemy.engine.Engine - INFO - [cached since 28.24s ago] {'param_1': 12}
2025-10-20 00:35:29,910 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:29,911 - sqlalchemy.engine.Engine - INFO - [cached since 28.23s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:35:29,916 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:29,917 - sqlalchemy.engine.Engine - INFO - [cached since 28.23s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:35:29,923 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:29,924 - sqlalchemy.engine.Engine - INFO - [cached since 28.24s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:35:29,928 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:29,929 - sqlalchemy.engine.Engine - INFO - [cached since 28.24s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:35:29,932 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:29,934 - sqlalchemy.engine.Engine - INFO - [cached since 28.25s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:35:29,938 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:29,940 - sqlalchemy.engine.Engine - INFO - [cached since 28.21s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:29,942 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:29,945 - sqlalchemy.engine.Engine - INFO - [cached since 28.19s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:29,949 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:29,951 - sqlalchemy.engine.Engine - INFO - [cached since 28.14s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:29,957 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:29,961 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:39,964 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:39,966 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:39,967 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:39,970 - sqlalchemy.engine.Engine - INFO - [cached since 38.46s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:39,973 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:39,973 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:39,976 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:39,979 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:39,981 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:39,983 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:39,985 - sqlalchemy.engine.Engine - INFO - [cached since 38.47s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:39,990 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:39,990 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:39,995 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:39,996 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:39,999 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,000 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:40,002 - sqlalchemy.engine.Engine - INFO - [cached since 38.44s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:40,006 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:40,010 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,012 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:40,014 - sqlalchemy.engine.Engine - INFO - [cached since 38.45s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:35:40,019 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-20 00:35:40,022 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,023 - sqlalchemy.engine.Engine - INFO - SELECT users.email, users.hashed_password, users.full_name, users.`role`, users.staff_type, users.is_active, users.restaurant_id, users.id, users.created_at, users.updated_at, users.deleted_at 
FROM users 
WHERE users.id = %(pk_1)s
2025-10-20 00:35:40,026 - sqlalchemy.engine.Engine - INFO - [cached since 10.44s ago] {'pk_1': 7}
2025-10-20 00:35:40,034 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,038 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,046 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:40,047 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,049 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:40,050 - sqlalchemy.engine.Engine - INFO - [cached since 38.54s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:40,056 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:40,057 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,060 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:40,063 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:40,064 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,067 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:40,068 - sqlalchemy.engine.Engine - INFO - [cached since 38.56s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:40,073 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:40,074 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,079 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:40,079 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:40,080 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,083 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:40,085 - sqlalchemy.engine.Engine - INFO - [cached since 38.52s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:40,089 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:40,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,094 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:35:40,096 - sqlalchemy.engine.Engine - INFO - [cached since 37.61s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:35:40,105 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,110 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,116 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:40,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,120 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:40,122 - sqlalchemy.engine.Engine - INFO - [cached since 38.61s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:40,127 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:40,128 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,130 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:35:40,132 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:35:40,133 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:35:40,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,138 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:35:40,140 - sqlalchemy.engine.Engine - INFO - [cached since 38.57s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:35:40,142 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:35:40,144 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:35:40,145 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,147 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:35:40,149 - sqlalchemy.engine.Engine - INFO - [cached since 38.64s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:35:40,155 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:35:40,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:35:40,165 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:35:40,168 - sqlalchemy.engine.Engine - INFO - [cached since 38.56s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:35:40,174 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:35:40,177 - sqlalchemy.engine.Engine - INFO - [cached since 38.56s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:35:40,180 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:35:40,184 - sqlalchemy.engine.Engine - INFO - [cached since 38.54s ago] {'pk_1': 4}
2025-10-20 00:35:40,190 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:35:40,192 - sqlalchemy.engine.Engine - INFO - [cached since 38.53s ago] {'param_1': 12}
2025-10-20 00:35:40,195 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:40,196 - sqlalchemy.engine.Engine - INFO - [cached since 38.51s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:35:40,202 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:40,204 - sqlalchemy.engine.Engine - INFO - [cached since 38.52s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:35:40,208 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:40,210 - sqlalchemy.engine.Engine - INFO - [cached since 38.53s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:35:40,214 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:40,217 - sqlalchemy.engine.Engine - INFO - [cached since 38.53s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:35:40,222 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:40,225 - sqlalchemy.engine.Engine - INFO - [cached since 38.54s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:35:40,228 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:40,230 - sqlalchemy.engine.Engine - INFO - [cached since 38.5s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:40,232 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:40,235 - sqlalchemy.engine.Engine - INFO - [cached since 38.48s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:40,241 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:35:40,242 - sqlalchemy.engine.Engine - INFO - [cached since 38.44s ago] {'restaurant_id_1': 1}
2025-10-20 00:35:40,251 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:35:40,256 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,841 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:36:59,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,844 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:36:59,846 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:36:59,849 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:36:59,849 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,850 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:36:59,854 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:36:59,855 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,856 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:36:59,857 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:36:59,859 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:36:59,859 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,863 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:36:59,863 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:36:59,864 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,866 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:36:59,866 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:36:59,868 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:36:59,871 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,871 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:36:59,873 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:36:59,878 - sqlalchemy.engine.Engine - INFO - UPDATE users SET staff_type=%(staff_type)s, updated_at=%(updated_at)s WHERE users.id = %(users_id)s
2025-10-20 00:36:59,879 - sqlalchemy.engine.Engine - INFO - [generated in 0.00134s] {'staff_type': 'waiter', 'updated_at': datetime.datetime(2025, 10, 20, 7, 36, 59, 878166, tzinfo=datetime.timezone.utc), 'users_id': 7}
2025-10-20 00:36:59,891 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-20 00:36:59,899 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,901 - sqlalchemy.engine.Engine - INFO - SELECT users.email, users.hashed_password, users.full_name, users.`role`, users.staff_type, users.is_active, users.restaurant_id, users.id, users.created_at, users.updated_at, users.deleted_at 
FROM users 
WHERE users.id = %(pk_1)s
2025-10-20 00:36:59,901 - sqlalchemy.engine.Engine - INFO - [cached since 90.32s ago] {'pk_1': 7}
2025-10-20 00:36:59,907 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,909 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,914 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:36:59,915 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,916 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:36:59,916 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:36:59,919 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:36:59,919 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,920 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:36:59,923 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:36:59,924 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,925 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:36:59,925 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:36:59,927 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:36:59,927 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,930 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:36:59,932 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:36:59,933 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,934 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:36:59,935 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:36:59,937 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:36:59,941 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,941 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:36:59,943 - sqlalchemy.engine.Engine - INFO - [cached since 117.5s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:36:59,951 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,952 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,956 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:36:59,957 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,959 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:36:59,959 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:36:59,962 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:36:59,962 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,964 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:36:59,965 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM1OTUsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.YicisyYoPp1fjCjw9v16--zS0qAnI-UN5pjJJomLMPs
2025-10-20 00:36:59,966 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993595, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:36:59,967 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,968 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:36:59,969 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:36:59,971 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:36:59,973 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:36:59,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,975 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:36:59,977 - sqlalchemy.engine.Engine - INFO - [cached since 118.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:36:59,979 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:36:59,979 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:36:59,985 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:36:59,987 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:36:59,989 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:36:59,992 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:36:59,994 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:36:59,997 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:36:59,999 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'pk_1': 4}
2025-10-20 00:37:00,001 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:37:00,003 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'param_1': 12}
2025-10-20 00:37:00,007 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:37:00,008 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:37:00,011 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:37:00,013 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:37:00,016 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:37:00,017 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:37:00,020 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:37:00,022 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:37:00,025 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:37:00,026 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:37:00,028 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:37:00,030 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'restaurant_id_1': 1}
2025-10-20 00:37:00,033 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:37:00,035 - sqlalchemy.engine.Engine - INFO - [cached since 118.3s ago] {'restaurant_id_1': 1}
2025-10-20 00:37:00,038 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:37:00,040 - sqlalchemy.engine.Engine - INFO - [cached since 118.2s ago] {'restaurant_id_1': 1}
2025-10-20 00:37:00,046 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:00,049 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:12,607 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:12,608 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:12,609 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:12,611 - sqlalchemy.engine.Engine - INFO - [cached since 131.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:12,614 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:12,614 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:12,615 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:12,616 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:37:12,616 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:37:12,616 - multipart.multipart - DEBUG - Calling on_field_data with data[9:41]
2025-10-20 00:37:12,616 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:37:12,616 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:37:12,616 - multipart.multipart - DEBUG - Calling on_field_name with data[42:50]
2025-10-20 00:37:12,616 - multipart.multipart - DEBUG - Calling on_field_data with data[51:66]
2025-10-20 00:37:12,617 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:37:12,617 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:37:12,617 - multipart.multipart - DEBUG - Calling on_field_name with data[67:77]
2025-10-20 00:37:12,618 - multipart.multipart - DEBUG - Calling on_field_data with data[78:86]
2025-10-20 00:37:12,618 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:37:12,618 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:37:12,618 - multipart.multipart - DEBUG - Calling on_field_name with data[87:92]
2025-10-20 00:37:12,618 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:37:12,618 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:37:12,623 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:12,625 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:37:12,627 - sqlalchemy.engine.Engine - INFO - [generated in 0.00145s] {'email_1': 'mesero-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:37:12,631 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-20 00:37:12,631 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-20 00:37:13,328 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:13,328 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:13,330 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:13,332 - sqlalchemy.engine.Engine - INFO - [cached since 131.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:13,335 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:13,335 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:13,343 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:13,351 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:13,353 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:13,356 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:13,358 - sqlalchemy.engine.Engine - INFO - [cached since 131.8s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:13,361 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:13,363 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:13,365 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:13,367 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM4MzMsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.MRnVbWpc5VtuQMZ4RPej86-KjZ50XE6QQniAP11B-sU
2025-10-20 00:37:13,367 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993833, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:37:13,369 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:13,371 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:37:13,371 - sqlalchemy.engine.Engine - INFO - [cached since 131.8s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:37:13,374 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:37:13,380 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:13,955 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:13,957 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:13,958 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:13,959 - sqlalchemy.engine.Engine - INFO - [cached since 132.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:13,961 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:13,963 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:13,965 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:13,969 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM4MzMsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.MRnVbWpc5VtuQMZ4RPej86-KjZ50XE6QQniAP11B-sU
2025-10-20 00:37:13,970 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993833, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:37:13,972 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:13,975 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:37:13,977 - sqlalchemy.engine.Engine - INFO - [cached since 132.4s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:37:13,980 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:37:13,983 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:13,985 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:13,987 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:13,989 - sqlalchemy.engine.Engine - INFO - [cached since 132.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:13,993 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:13,993 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:13,996 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:13,999 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:37:14,000 - sqlalchemy.engine.Engine - INFO - [generated in 0.00153s] {'restaurant_id_1': 1}
2025-10-20 00:37:14,011 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:14,017 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:14,023 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:14,024 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:14,027 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:14,028 - sqlalchemy.engine.Engine - INFO - [cached since 132.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:14,031 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:14,032 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:14,034 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:14,047 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:14,050 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:14,067 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:14,069 - sqlalchemy.engine.Engine - INFO - [cached since 132.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:14,083 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:14,088 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:14,091 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:14,095 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM4MzMsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.MRnVbWpc5VtuQMZ4RPej86-KjZ50XE6QQniAP11B-sU
2025-10-20 00:37:14,096 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993833, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:37:14,098 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:14,099 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:37:14,100 - sqlalchemy.engine.Engine - INFO - [cached since 132.5s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:37:14,107 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:37:14,112 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:14,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:14,123 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:14,123 - sqlalchemy.engine.Engine - INFO - [cached since 132.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:14,128 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:14,128 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:14,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:14,151 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:37:14,153 - sqlalchemy.engine.Engine - INFO - [generated in 0.00232s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:37:14,188 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:14,192 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:46,006 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:46,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:46,032 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:46,051 - sqlalchemy.engine.Engine - INFO - [cached since 164.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:46,072 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:46,078 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:46,087 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:46,112 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:46,118 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:46,126 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:46,131 - sqlalchemy.engine.Engine - INFO - [cached since 164.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:46,135 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:46,135 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:46,140 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:46,164 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:46,166 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:46,168 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:46,169 - sqlalchemy.engine.Engine - INFO - [cached since 164.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:46,172 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:46,173 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:46,177 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:46,497 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:46,508 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:46,529 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:46,545 - sqlalchemy.engine.Engine - INFO - [cached since 165s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:46,565 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:46,572 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:46,591 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:37:46,611 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM4MzMsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.MRnVbWpc5VtuQMZ4RPej86-KjZ50XE6QQniAP11B-sU
2025-10-20 00:37:46,622 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993833, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:37:46,629 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:46,641 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:37:46,649 - sqlalchemy.engine.Engine - INFO - [cached since 165.1s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:37:46,676 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:37:46,689 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:37:46,701 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:46,711 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:37:46,721 - sqlalchemy.engine.Engine - INFO - [cached since 165.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:37:46,737 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:37:46,741 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:46,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:37:46,778 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:37:46,797 - sqlalchemy.engine.Engine - INFO - [cached since 165s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:37:47,067 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,077 - sqlalchemy.engine.Engine - INFO - [cached since 165.2s ago] {'pk_1': 9}
2025-10-20 00:37:47,108 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,134 - sqlalchemy.engine.Engine - INFO - [cached since 165.3s ago] {'pk_1': 16}
2025-10-20 00:37:47,181 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,196 - sqlalchemy.engine.Engine - INFO - [cached since 165.3s ago] {'pk_1': 15}
2025-10-20 00:37:47,234 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,259 - sqlalchemy.engine.Engine - INFO - [cached since 165.4s ago] {'pk_1': 13}
2025-10-20 00:37:47,301 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,319 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 14}
2025-10-20 00:37:47,327 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,329 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 18}
2025-10-20 00:37:47,334 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,337 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 21}
2025-10-20 00:37:47,341 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,343 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 19}
2025-10-20 00:37:47,347 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,349 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 22}
2025-10-20 00:37:47,354 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,358 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 7}
2025-10-20 00:37:47,362 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,365 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 5}
2025-10-20 00:37:47,370 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,373 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 6}
2025-10-20 00:37:47,379 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:37:47,382 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'pk_1': 8}
2025-10-20 00:37:47,413 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:37:47,415 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:12,130 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:12,131 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:12,132 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:12,133 - sqlalchemy.engine.Engine - INFO - [cached since 190.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:12,135 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:12,135 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:12,137 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:38:12,146 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:12,148 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:12,149 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:12,150 - sqlalchemy.engine.Engine - INFO - [cached since 190.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:12,151 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:12,152 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:12,153 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:38:12,155 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM4MzMsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.MRnVbWpc5VtuQMZ4RPej86-KjZ50XE6QQniAP11B-sU
2025-10-20 00:38:12,155 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993833, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:38:12,156 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:12,157 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:38:12,157 - sqlalchemy.engine.Engine - INFO - [cached since 190.6s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:38:12,160 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:38:12,161 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:12,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:12,163 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:12,164 - sqlalchemy.engine.Engine - INFO - [cached since 190.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:12,165 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:12,165 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:12,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:12,169 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:38:12,170 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:38:12,188 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,188 - sqlalchemy.engine.Engine - INFO - [cached since 190.3s ago] {'pk_1': 9}
2025-10-20 00:38:12,191 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,191 - sqlalchemy.engine.Engine - INFO - [cached since 190.3s ago] {'pk_1': 16}
2025-10-20 00:38:12,194 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,195 - sqlalchemy.engine.Engine - INFO - [cached since 190.3s ago] {'pk_1': 15}
2025-10-20 00:38:12,198 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,198 - sqlalchemy.engine.Engine - INFO - [cached since 190.3s ago] {'pk_1': 13}
2025-10-20 00:38:12,200 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,201 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 14}
2025-10-20 00:38:12,203 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,204 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 18}
2025-10-20 00:38:12,206 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,207 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 21}
2025-10-20 00:38:12,209 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,210 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 19}
2025-10-20 00:38:12,211 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,212 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 22}
2025-10-20 00:38:12,215 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,215 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 7}
2025-10-20 00:38:12,217 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,218 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 5}
2025-10-20 00:38:12,220 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,220 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 6}
2025-10-20 00:38:12,222 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:38:12,223 - sqlalchemy.engine.Engine - INFO - [cached since 190.4s ago] {'pk_1': 8}
2025-10-20 00:38:12,231 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:12,232 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:29,445 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:29,447 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:29,448 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:29,449 - sqlalchemy.engine.Engine - INFO - [cached since 207.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:29,452 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:29,453 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:29,454 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:38:29,455 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_data with data[9:41]
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_name with data[42:50]
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_data with data[51:66]
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:38:29,457 - multipart.multipart - DEBUG - Calling on_field_name with data[67:77]
2025-10-20 00:38:29,458 - multipart.multipart - DEBUG - Calling on_field_data with data[78:86]
2025-10-20 00:38:29,458 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:38:29,458 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:38:29,458 - multipart.multipart - DEBUG - Calling on_field_name with data[87:92]
2025-10-20 00:38:29,459 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:38:29,459 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:38:29,464 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:29,465 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:38:29,466 - sqlalchemy.engine.Engine - INFO - [cached since 76.84s ago] {'email_1': 'mesero-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:38:30,148 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:30,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:30,150 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:30,151 - sqlalchemy.engine.Engine - INFO - [cached since 208.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:30,154 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:30,155 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:30,160 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:30,164 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:30,166 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:30,166 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:30,168 - sqlalchemy.engine.Engine - INFO - [cached since 208.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:30,172 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:30,172 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:30,174 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:38:30,174 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:38:30,175 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:38:30,175 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:30,176 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:38:30,176 - sqlalchemy.engine.Engine - INFO - [cached since 208.6s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:38:30,178 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:38:30,183 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:30,203 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:30,204 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:30,205 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:30,206 - sqlalchemy.engine.Engine - INFO - [cached since 208.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:30,208 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:30,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:30,210 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:38:30,220 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:30,221 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:30,223 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:30,225 - sqlalchemy.engine.Engine - INFO - [cached since 208.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:30,228 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:30,229 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:30,231 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:38:30,234 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:38:30,235 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:38:30,235 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:30,236 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:38:30,237 - sqlalchemy.engine.Engine - INFO - [cached since 208.7s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:38:30,239 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:38:30,240 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:38:30,241 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:30,242 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:38:30,245 - sqlalchemy.engine.Engine - INFO - [cached since 208.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:38:30,247 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:38:30,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:30,251 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:38:30,252 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:38:30,254 - sqlalchemy.engine.Engine - INFO - [cached since 76.1s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:38:30,277 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:38:30,280 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:41:55,528 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:41:55,537 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:41:55,538 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:41:55,538 - sqlalchemy.engine.Engine - INFO - [cached since 414s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:41:55,541 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:41:55,541 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:41:55,542 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:41:55,548 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:41:55,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:41:55,573 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:41:55,575 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:41:55,577 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:41:55,578 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:41:55,578 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:41:55,580 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:41:55,582 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:41:55,651 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:41:55,651 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:41:55,653 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:41:55,662 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:41:55,675 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:41:55,681 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:41:55,683 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:41:55,684 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:41:55,686 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:41:55,686 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:41:55,691 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:41:55,694 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:41:55,695 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:41:55,726 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,726 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 9}
2025-10-20 00:41:55,729 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,730 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 16}
2025-10-20 00:41:55,734 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,735 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 15}
2025-10-20 00:41:55,739 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,740 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 13}
2025-10-20 00:41:55,744 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,745 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 14}
2025-10-20 00:41:55,749 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,750 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 18}
2025-10-20 00:41:55,753 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,754 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 21}
2025-10-20 00:41:55,757 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,758 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 19}
2025-10-20 00:41:55,762 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,763 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 22}
2025-10-20 00:41:55,768 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,770 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 7}
2025-10-20 00:41:55,773 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,773 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 5}
2025-10-20 00:41:55,778 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,779 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 6}
2025-10-20 00:41:55,782 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:41:55,784 - sqlalchemy.engine.Engine - INFO - [cached since 413.9s ago] {'pk_1': 8}
2025-10-20 00:41:55,799 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:41:55,801 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:41:55,898 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:42:07,173 - app.main - INFO - ==================================================
2025-10-20 00:42:07,175 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:42:07,177 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:42:07,178 - app.main - INFO - ==================================================
2025-10-20 00:43:35,117 - app.main - INFO - ==================================================
2025-10-20 00:43:35,117 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:43:35,118 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:43:35,118 - app.main - INFO - ==================================================
2025-10-20 00:43:36,649 - app.main - INFO - Starting background tasks...
2025-10-20 00:48:00,894 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:48:05,594 - app.main - INFO - ==================================================
2025-10-20 00:48:05,596 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:48:05,599 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:48:05,600 - app.main - INFO - ==================================================
2025-10-20 00:48:09,037 - app.main - INFO - Starting background tasks...
2025-10-20 00:48:11,625 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,683 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:48:11,684 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:48:11,685 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:48:11,687 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:48:11,689 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:48:11,689 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:48:11,691 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,696 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,696 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,708 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,710 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,717 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:11,724 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,725 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,726 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,727 - sqlalchemy.engine.Engine - INFO - [cached since 0.03135s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,730 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,732 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,739 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:11,755 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,756 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,757 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.06328s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,759 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,761 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,763 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:11,782 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,784 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,785 - sqlalchemy.engine.Engine - INFO - [cached since 0.08908s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,786 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,787 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,787 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:11,789 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:11,792 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:11,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,795 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:11,796 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:11,797 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:11,798 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,826 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,827 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,828 - sqlalchemy.engine.Engine - INFO - [cached since 0.1321s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,829 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,830 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,842 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.user_id = %(user_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:48:11,843 - sqlalchemy.engine.Engine - INFO - [generated in 0.00102s] {'restaurant_id_1': 1, 'user_id_1': 7, 'param_1': 0, 'param_2': 200}
2025-10-20 00:48:11,848 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,849 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,873 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,875 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,878 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,883 - sqlalchemy.engine.Engine - INFO - [cached since 0.1872s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,893 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,893 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,900 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:11,920 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,921 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,922 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,923 - sqlalchemy.engine.Engine - INFO - [cached since 0.2272s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,924 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,924 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,925 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:11,949 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,951 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,952 - sqlalchemy.engine.Engine - INFO - [cached since 0.2567s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,954 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,954 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,956 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:11,962 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,965 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,966 - sqlalchemy.engine.Engine - INFO - [cached since 0.2701s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,968 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,968 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,969 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:11,970 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:11,971 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:11,972 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,972 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:11,973 - sqlalchemy.engine.Engine - INFO - [cached since 0.1783s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:11,975 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:11,976 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:11,977 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,977 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:11,978 - sqlalchemy.engine.Engine - INFO - [cached since 0.2832s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:11,980 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:11,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:11,984 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:48:11,984 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:48:11,989 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:11,990 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:16,741 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:16,743 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:16,749 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:16,758 - sqlalchemy.engine.Engine - INFO - [cached since 5.062s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:16,765 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:16,766 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:16,769 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:16,779 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:16,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:16,785 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:16,787 - sqlalchemy.engine.Engine - INFO - [cached since 5.092s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:16,791 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:16,791 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:16,795 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:16,799 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:16,800 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:16,802 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:16,805 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:16,806 - sqlalchemy.engine.Engine - INFO - [cached since 5.011s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:16,811 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:16,814 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:16,816 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:16,819 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:16,821 - sqlalchemy.engine.Engine - INFO - [cached since 5.125s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:16,825 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:16,826 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:16,833 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:16,835 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.user_id = %(user_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:48:16,838 - sqlalchemy.engine.Engine - INFO - [cached since 4.996s ago] {'restaurant_id_1': 1, 'user_id_1': 7, 'param_1': 0, 'param_2': 200}
2025-10-20 00:48:16,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:16,858 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:19,828 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:19,830 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:19,832 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:19,834 - sqlalchemy.engine.Engine - INFO - [cached since 8.138s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:19,836 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:19,838 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:19,840 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:19,841 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:19,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:19,845 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:19,848 - sqlalchemy.engine.Engine - INFO - [cached since 8.152s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:19,852 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:19,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:19,856 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:19,872 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:19,874 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:19,878 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:19,881 - sqlalchemy.engine.Engine - INFO - [cached since 8.185s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:19,885 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:19,885 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:19,888 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:19,898 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:19,901 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:19,903 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:19,906 - sqlalchemy.engine.Engine - INFO - [cached since 8.21s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:19,911 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:19,912 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:19,916 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:19,929 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:19,932 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:19,933 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:19,934 - sqlalchemy.engine.Engine - INFO - [cached since 8.239s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:19,939 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:19,939 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:19,943 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:19,949 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:19,951 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:19,953 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:19,956 - sqlalchemy.engine.Engine - INFO - [cached since 8.26s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:19,958 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:19,959 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:19,961 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:19,967 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:19,968 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:19,970 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:19,972 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:19,973 - sqlalchemy.engine.Engine - INFO - [cached since 8.178s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:19,977 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:19,982 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:19,984 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:19,986 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:19,988 - sqlalchemy.engine.Engine - INFO - [cached since 8.292s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:19,991 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:19,991 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:19,997 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:20,000 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:48:20,001 - sqlalchemy.engine.Engine - INFO - [cached since 8.018s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:48:20,012 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:20,017 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:20,023 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:20,025 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:20,028 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:20,032 - sqlalchemy.engine.Engine - INFO - [cached since 8.336s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:20,036 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:20,037 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:20,039 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:20,046 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:20,047 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:20,049 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:20,051 - sqlalchemy.engine.Engine - INFO - [cached since 8.356s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:20,054 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:20,055 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:20,057 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:20,062 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:20,063 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:20,066 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:20,067 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:20,069 - sqlalchemy.engine.Engine - INFO - [cached since 8.274s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:20,072 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:20,073 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:20,075 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:20,078 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:20,081 - sqlalchemy.engine.Engine - INFO - [cached since 8.386s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:20,085 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:20,087 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:20,091 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:20,112 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:48:20,116 - sqlalchemy.engine.Engine - INFO - [generated in 0.00450s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:48:20,172 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:20,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,374 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,376 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,378 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,379 - sqlalchemy.engine.Engine - INFO - [cached since 24.68s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,382 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,382 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,384 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:36,390 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,394 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,395 - sqlalchemy.engine.Engine - INFO - [cached since 24.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,399 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,399 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,401 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:36,410 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,411 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,413 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,414 - sqlalchemy.engine.Engine - INFO - [cached since 24.72s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,418 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,418 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,420 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:36,427 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,430 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,431 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,432 - sqlalchemy.engine.Engine - INFO - [cached since 24.74s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,435 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,437 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,438 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:36,441 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:36,442 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:36,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,445 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:36,445 - sqlalchemy.engine.Engine - INFO - [cached since 24.65s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:36,448 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:36,449 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,452 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,453 - sqlalchemy.engine.Engine - INFO - [cached since 24.76s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,455 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,459 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,462 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:36,464 - sqlalchemy.engine.Engine - INFO - [generated in 0.00129s] {'id_1': 6, 'param_1': 1}
2025-10-20 00:48:36,469 - sqlalchemy.engine.Engine - INFO - SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:36,470 - sqlalchemy.engine.Engine - INFO - [generated in 0.00191s] {'id_1': 32, 'param_1': 1}
2025-10-20 00:48:36,478 - sqlalchemy.engine.Engine - INFO - INSERT INTO orders (table_id, customer_name, order_type, status, notes, total_amount, user_id, is_paid, payment_method, deleted_at, restaurant_id, created_at, updated_at) VALUES (%(table_id)s, %(customer_name)s, %(order_type)s, %(status)s, %(notes)s, %(total_amount)s, %(user_id)s, %(is_paid)s, %(payment_method)s, %(deleted_at)s, %(restaurant_id)s, %(created_at)s, %(updated_at)s)
2025-10-20 00:48:36,479 - sqlalchemy.engine.Engine - INFO - [generated in 0.00203s] {'table_id': 6, 'customer_name': None, 'order_type': 'dine_in', 'status': 'PENDING', 'notes': None, 'total_amount': 0.0, 'user_id': None, 'is_paid': 0, 'payment_method': None, 'deleted_at': None, 'restaurant_id': 1, 'created_at': datetime.datetime(2025, 10, 20, 7, 48, 36, 473395, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 7, 48, 36, 473395, tzinfo=datetime.timezone.utc)}
2025-10-20 00:48:36,486 - sqlalchemy.engine.Engine - INFO - SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:36,487 - sqlalchemy.engine.Engine - INFO - [cached since 0.01843s ago] {'id_1': 32, 'param_1': 1}
2025-10-20 00:48:36,494 - sqlalchemy.engine.Engine - INFO - UPDATE orders SET total_amount=%(total_amount)s, updated_at=%(updated_at)s WHERE orders.id = %(orders_id)s
2025-10-20 00:48:36,495 - sqlalchemy.engine.Engine - INFO - [generated in 0.00156s] {'total_amount': 35.0, 'updated_at': datetime.datetime(2025, 10, 20, 7, 48, 36, 490679, tzinfo=datetime.timezone.utc), 'orders_id': 60}
2025-10-20 00:48:36,500 - sqlalchemy.engine.Engine - INFO - INSERT INTO order_items (order_id, menu_item_id, variant_id, quantity, unit_price, special_instructions, status, deleted_at, created_at, updated_at) VALUES (%(order_id)s, %(menu_item_id)s, %(variant_id)s, %(quantity)s, %(unit_price)s, %(special_instructions)s, %(status)s, %(deleted_at)s, %(created_at)s, %(updated_at)s)
2025-10-20 00:48:36,501 - sqlalchemy.engine.Engine - INFO - [generated in 0.00132s] {'order_id': 60, 'menu_item_id': 32, 'variant_id': None, 'quantity': 1, 'unit_price': 35.0, 'special_instructions': 'Tortilla: Harina | Sin cilantro', 'status': 'PENDING', 'deleted_at': None, 'created_at': datetime.datetime(2025, 10, 20, 7, 48, 36, 490679, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 7, 48, 36, 490679, tzinfo=datetime.timezone.utc)}
2025-10-20 00:48:36,506 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-20 00:48:36,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,546 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.id = %(id_1)s AND orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id
2025-10-20 00:48:36,550 - sqlalchemy.engine.Engine - INFO - [generated in 0.00417s] {'id_1': 60, 'restaurant_id_1': 1, 'param_1': 1}
2025-10-20 00:48:36,561 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:48:36,563 - sqlalchemy.engine.Engine - INFO - [generated in 0.00190s] {'pk_1': 16}
2025-10-20 00:48:36,570 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,573 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,585 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,586 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,588 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,590 - sqlalchemy.engine.Engine - INFO - [cached since 24.89s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,591 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,592 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,595 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:36,596 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,600 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,601 - sqlalchemy.engine.Engine - INFO - [cached since 24.91s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,605 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,605 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,608 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:36,615 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,617 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,619 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,621 - sqlalchemy.engine.Engine - INFO - [cached since 24.93s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,623 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,625 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,626 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:36,629 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,632 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,632 - sqlalchemy.engine.Engine - INFO - [cached since 24.94s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,637 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,637 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,641 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:36,644 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:36,645 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:36,646 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,647 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:36,648 - sqlalchemy.engine.Engine - INFO - [cached since 24.85s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:36,651 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:36,654 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:36,656 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,657 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:36,658 - sqlalchemy.engine.Engine - INFO - [cached since 24.96s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:36,661 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:36,661 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,664 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:36,666 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.user_id = %(user_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:48:36,668 - sqlalchemy.engine.Engine - INFO - [cached since 24.83s ago] {'restaurant_id_1': 1, 'user_id_1': 7, 'param_1': 0, 'param_2': 200}
2025-10-20 00:48:36,680 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:36,683 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:41,554 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:41,556 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:41,556 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:41,559 - sqlalchemy.engine.Engine - INFO - [cached since 29.86s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:41,561 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:41,562 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:41,564 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:41,571 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:41,572 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:41,574 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:41,575 - sqlalchemy.engine.Engine - INFO - [cached since 29.88s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:41,578 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:41,579 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:41,583 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:41,586 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:41,587 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:41,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:41,589 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:41,590 - sqlalchemy.engine.Engine - INFO - [cached since 29.8s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:41,597 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:41,606 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:41,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:41,619 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:41,624 - sqlalchemy.engine.Engine - INFO - [cached since 29.93s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:41,635 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:41,637 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:41,641 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:41,641 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.user_id = %(user_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:48:41,649 - sqlalchemy.engine.Engine - INFO - [cached since 29.81s ago] {'restaurant_id_1': 1, 'user_id_1': 7, 'param_1': 0, 'param_2': 200}
2025-10-20 00:48:41,669 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:41,672 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,627 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:47,629 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,630 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:47,632 - sqlalchemy.engine.Engine - INFO - [cached since 35.94s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:47,633 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:47,634 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,635 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:47,639 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:47,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,642 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:47,643 - sqlalchemy.engine.Engine - INFO - [cached since 35.95s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:47,645 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:47,645 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,647 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:47,650 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:47,650 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:47,652 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,654 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:47,655 - sqlalchemy.engine.Engine - INFO - [cached since 35.86s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:47,657 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:47,659 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:47,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,661 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:47,661 - sqlalchemy.engine.Engine - INFO - [cached since 35.97s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:47,664 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:47,665 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,668 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,669 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:48:47,671 - sqlalchemy.engine.Engine - INFO - [generated in 0.00130s] {'restaurant_id_1': 1}
2025-10-20 00:48:47,680 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,682 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,694 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:47,695 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,696 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:47,697 - sqlalchemy.engine.Engine - INFO - [cached since 36s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:47,700 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:47,700 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,702 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:47,719 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:47,719 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,720 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:47,722 - sqlalchemy.engine.Engine - INFO - [cached since 36.03s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:47,725 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:47,725 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,726 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:47,729 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:47,729 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:47,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,732 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:47,733 - sqlalchemy.engine.Engine - INFO - [cached since 35.94s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:47,735 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:47,737 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:47,737 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,740 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:47,740 - sqlalchemy.engine.Engine - INFO - [cached since 36.05s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:47,744 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:47,744 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:47,747 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:48:47,750 - sqlalchemy.engine.Engine - INFO - [cached since 27.64s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:48:47,782 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:47,785 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:48,661 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:48,663 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:48,664 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:48,667 - sqlalchemy.engine.Engine - INFO - [cached since 36.97s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:48,673 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:48,673 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:48,675 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:48,691 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:48,694 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:48,696 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:48,699 - sqlalchemy.engine.Engine - INFO - [cached since 37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:48,702 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:48,703 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:48,706 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:48:48,709 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:48:48,710 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:48:48,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:48,714 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:48:48,716 - sqlalchemy.engine.Engine - INFO - [cached since 36.92s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:48:48,718 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:48:48,721 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:48:48,723 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:48,724 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:48:48,726 - sqlalchemy.engine.Engine - INFO - [cached since 37.03s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:48:48,731 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:48:48,732 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:48,736 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:48:48,739 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.user_id = %(user_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:48:48,742 - sqlalchemy.engine.Engine - INFO - [cached since 36.9s ago] {'restaurant_id_1': 1, 'user_id_1': 7, 'param_1': 0, 'param_2': 200}
2025-10-20 00:48:48,755 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:48:48,760 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:23,132 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:50:26,565 - app.main - INFO - ==================================================
2025-10-20 00:50:26,566 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:50:26,567 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:50:26,568 - app.main - INFO - ==================================================
2025-10-20 00:50:29,466 - app.main - INFO - Starting background tasks...
2025-10-20 00:50:33,146 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:33,333 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:50:33,335 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:50:33,340 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:50:33,343 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:50:33,346 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:50:33,349 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:50:33,355 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,368 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:33,371 - sqlalchemy.engine.Engine - INFO - [generated in 0.00346s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:33,377 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:33,378 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,383 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:33,399 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:33,402 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,404 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:33,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.03788s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:33,410 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:33,410 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,415 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:33,419 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:50:33,430 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:50:33,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,440 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:33,441 - sqlalchemy.engine.Engine - INFO - [generated in 0.00200s] {'id_1': 7, 'param_1': 1}
2025-10-20 00:50:33,447 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:50:33,451 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:33,460 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,466 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:33,469 - sqlalchemy.engine.Engine - INFO - [cached since 0.101s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:33,473 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:33,474 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,486 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,540 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.user_id = %(user_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:50:33,545 - sqlalchemy.engine.Engine - INFO - [generated in 0.00509s] {'restaurant_id_1': 1, 'user_id_1': 7, 'param_1': 0, 'param_2': 200}
2025-10-20 00:50:33,571 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,575 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,585 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:33,588 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,589 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:33,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.2235s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:33,596 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:33,597 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,600 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:33,613 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:33,616 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,618 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:33,620 - sqlalchemy.engine.Engine - INFO - [cached since 0.252s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:33,625 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:33,626 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,632 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:33,637 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:50:33,638 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:50:33,641 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,644 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:33,646 - sqlalchemy.engine.Engine - INFO - [cached since 0.2061s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:50:33,649 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:50:33,653 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:33,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,657 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:33,659 - sqlalchemy.engine.Engine - INFO - [cached since 0.2912s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:33,664 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:33,665 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,673 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:33,680 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:50:33,683 - sqlalchemy.engine.Engine - INFO - [generated in 0.00330s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:50:33,698 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:33,703 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:35,129 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:35,131 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:35,132 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:35,134 - sqlalchemy.engine.Engine - INFO - [cached since 1.766s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:35,138 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:35,139 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:35,141 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:35,149 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:35,152 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:35,154 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:35,156 - sqlalchemy.engine.Engine - INFO - [cached since 1.788s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:35,159 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:35,159 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:35,162 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:35,166 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:50:35,168 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:50:35,171 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:35,174 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:35,175 - sqlalchemy.engine.Engine - INFO - [cached since 1.736s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:50:35,178 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:50:35,181 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:35,184 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:35,186 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:35,189 - sqlalchemy.engine.Engine - INFO - [cached since 1.821s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:35,192 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:35,192 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:35,198 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:35,202 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.user_id = %(user_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:50:35,205 - sqlalchemy.engine.Engine - INFO - [cached since 1.664s ago] {'restaurant_id_1': 1, 'user_id_1': 7, 'param_1': 0, 'param_2': 200}
2025-10-20 00:50:35,219 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:35,223 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,497 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:36,499 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,501 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:36,501 - sqlalchemy.engine.Engine - INFO - [cached since 3.134s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:36,505 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:36,506 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,508 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:36,509 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:36,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,514 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:36,517 - sqlalchemy.engine.Engine - INFO - [cached since 3.149s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:36,520 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:36,521 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,523 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:36,537 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:36,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,540 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:36,541 - sqlalchemy.engine.Engine - INFO - [cached since 3.174s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:36,546 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:36,546 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,550 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:36,552 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:36,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,556 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:36,557 - sqlalchemy.engine.Engine - INFO - [cached since 3.189s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:36,559 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:36,559 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,563 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:36,570 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:50:36,571 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:50:36,573 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,574 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:36,575 - sqlalchemy.engine.Engine - INFO - [cached since 3.136s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:50:36,580 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:50:36,583 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:36,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,588 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:36,591 - sqlalchemy.engine.Engine - INFO - [cached since 3.223s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:36,596 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:36,596 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,603 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,623 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:50:36,625 - sqlalchemy.engine.Engine - INFO - [generated in 0.00296s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:50:36,661 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:36,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,673 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:36,674 - sqlalchemy.engine.Engine - INFO - [cached since 3.307s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:36,677 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:36,678 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,682 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:36,690 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:50:36,687 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,691 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:50:36,694 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,696 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:36,699 - sqlalchemy.engine.Engine - INFO - [cached since 3.259s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:50:36,703 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:50:36,707 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,709 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:36,711 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,713 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:36,715 - sqlalchemy.engine.Engine - INFO - [cached since 3.348s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:36,719 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:36,719 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,723 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:36,724 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:50:36,725 - sqlalchemy.engine.Engine - INFO - [cached since 3.045s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:50:36,737 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:36,743 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,020 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:52,022 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,023 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:52,025 - sqlalchemy.engine.Engine - INFO - [cached since 18.66s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:52,027 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:52,027 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,028 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:52,038 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:52,039 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,041 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:52,043 - sqlalchemy.engine.Engine - INFO - [cached since 18.67s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:52,045 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:52,046 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,048 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:52,052 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:50:52,053 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:50:52,054 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,055 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:52,057 - sqlalchemy.engine.Engine - INFO - [cached since 18.62s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:50:52,059 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:50:52,061 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:52,064 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,065 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:52,066 - sqlalchemy.engine.Engine - INFO - [cached since 18.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:52,068 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:52,069 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,073 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,075 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:52,077 - sqlalchemy.engine.Engine - INFO - [generated in 0.00192s] {'id_1': 7, 'param_1': 1}
2025-10-20 00:50:52,084 - sqlalchemy.engine.Engine - INFO - SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:52,085 - sqlalchemy.engine.Engine - INFO - [generated in 0.00174s] {'id_1': 33, 'param_1': 1}
2025-10-20 00:50:52,093 - sqlalchemy.engine.Engine - INFO - INSERT INTO orders (table_id, customer_name, order_type, status, notes, total_amount, user_id, is_paid, payment_method, deleted_at, restaurant_id, created_at, updated_at) VALUES (%(table_id)s, %(customer_name)s, %(order_type)s, %(status)s, %(notes)s, %(total_amount)s, %(user_id)s, %(is_paid)s, %(payment_method)s, %(deleted_at)s, %(restaurant_id)s, %(created_at)s, %(updated_at)s)
2025-10-20 00:50:52,094 - sqlalchemy.engine.Engine - INFO - [generated in 0.00136s] {'table_id': 7, 'customer_name': None, 'order_type': 'dine_in', 'status': 'PENDING', 'notes': None, 'total_amount': 0.0, 'user_id': 7, 'is_paid': 0, 'payment_method': None, 'deleted_at': None, 'restaurant_id': 1, 'created_at': datetime.datetime(2025, 10, 20, 7, 50, 52, 89894, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 7, 50, 52, 89894, tzinfo=datetime.timezone.utc)}
2025-10-20 00:50:52,100 - sqlalchemy.engine.Engine - INFO - SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:52,101 - sqlalchemy.engine.Engine - INFO - [cached since 0.01745s ago] {'id_1': 33, 'param_1': 1}
2025-10-20 00:50:52,110 - sqlalchemy.engine.Engine - INFO - UPDATE orders SET total_amount=%(total_amount)s, updated_at=%(updated_at)s WHERE orders.id = %(orders_id)s
2025-10-20 00:50:52,111 - sqlalchemy.engine.Engine - INFO - [generated in 0.00181s] {'total_amount': 35.0, 'updated_at': datetime.datetime(2025, 10, 20, 7, 50, 52, 104561, tzinfo=datetime.timezone.utc), 'orders_id': 61}
2025-10-20 00:50:52,116 - sqlalchemy.engine.Engine - INFO - INSERT INTO order_items (order_id, menu_item_id, variant_id, quantity, unit_price, special_instructions, status, deleted_at, created_at, updated_at) VALUES (%(order_id)s, %(menu_item_id)s, %(variant_id)s, %(quantity)s, %(unit_price)s, %(special_instructions)s, %(status)s, %(deleted_at)s, %(created_at)s, %(updated_at)s)
2025-10-20 00:50:52,118 - sqlalchemy.engine.Engine - INFO - [generated in 0.00169s] {'order_id': 61, 'menu_item_id': 33, 'variant_id': None, 'quantity': 1, 'unit_price': 35.0, 'special_instructions': 'Tortilla: Harina', 'status': 'PENDING', 'deleted_at': None, 'created_at': datetime.datetime(2025, 10, 20, 7, 50, 52, 104561, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 7, 50, 52, 104561, tzinfo=datetime.timezone.utc)}
2025-10-20 00:50:52,121 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-20 00:50:52,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,149 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.id = %(id_1)s AND orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL 
 LIMIT %(param_1)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id
2025-10-20 00:50:52,153 - sqlalchemy.engine.Engine - INFO - [generated in 0.00390s] {'id_1': 61, 'restaurant_id_1': 1, 'param_1': 1}
2025-10-20 00:50:52,163 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:50:52,164 - sqlalchemy.engine.Engine - INFO - [generated in 0.00160s] {'pk_1': 16}
2025-10-20 00:50:52,171 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,174 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,183 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:52,184 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,186 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:52,188 - sqlalchemy.engine.Engine - INFO - [cached since 18.82s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:52,190 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:52,191 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,192 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:52,196 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:52,196 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,199 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:52,199 - sqlalchemy.engine.Engine - INFO - [cached since 18.83s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:52,201 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:52,201 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,203 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:52,212 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:52,213 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,213 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:52,215 - sqlalchemy.engine.Engine - INFO - [cached since 18.85s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:52,220 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:52,220 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,222 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:50:52,224 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTM5MTAsInN1YiI6IjciLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.iE0Qm1aU9h5ZNGk8BXrRYP0NGx9KB33JgUy30uv62HU
2025-10-20 00:50:52,225 - app.services.user - DEBUG - Decoded payload: {'exp': 1760993910, 'sub': '7', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:50:52,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,227 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:50:52,229 - sqlalchemy.engine.Engine - INFO - [cached since 18.79s ago] {'id_1': 7, 'param_1': 1}
2025-10-20 00:50:52,231 - app.services.user - DEBUG - Found user: mesero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:50:52,233 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:50:52,234 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,235 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:50:52,238 - sqlalchemy.engine.Engine - INFO - [cached since 18.87s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:50:52,240 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:50:52,241 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:50:52,245 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.user_id = %(user_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:50:52,247 - sqlalchemy.engine.Engine - INFO - [cached since 18.71s ago] {'restaurant_id_1': 1, 'user_id_1': 7, 'param_1': 0, 'param_2': 200}
2025-10-20 00:50:52,256 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:50:52,258 - sqlalchemy.engine.Engine - INFO - [generated in 0.00165s] {'pk_1': 16}
2025-10-20 00:50:52,264 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:50:52,266 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:20,659 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:20,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:20,663 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:20,665 - sqlalchemy.engine.Engine - INFO - [cached since 47.3s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:20,670 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:20,670 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:20,672 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:20,674 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:51:20,675 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:51:20,675 - multipart.multipart - DEBUG - Calling on_field_data with data[9:31]
2025-10-20 00:51:20,675 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:51:20,675 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:51:20,677 - multipart.multipart - DEBUG - Calling on_field_name with data[32:40]
2025-10-20 00:51:20,678 - multipart.multipart - DEBUG - Calling on_field_data with data[41:49]
2025-10-20 00:51:20,678 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:51:20,679 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:51:20,679 - multipart.multipart - DEBUG - Calling on_field_name with data[50:60]
2025-10-20 00:51:20,679 - multipart.multipart - DEBUG - Calling on_field_data with data[61:69]
2025-10-20 00:51:20,680 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:51:20,680 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:51:20,681 - multipart.multipart - DEBUG - Calling on_field_name with data[70:75]
2025-10-20 00:51:20,683 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:51:20,684 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:51:20,690 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:20,694 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:20,696 - sqlalchemy.engine.Engine - INFO - [generated in 0.00280s] {'email_1': 'admin@coffeeshop.com', 'param_1': 1}
2025-10-20 00:51:20,700 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-20 00:51:20,702 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-20 00:51:21,403 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:21,405 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:21,406 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:21,408 - sqlalchemy.engine.Engine - INFO - [cached since 48.04s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:21,409 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:21,411 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:21,415 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:21,419 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:21,420 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:21,421 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:21,423 - sqlalchemy.engine.Engine - INFO - [cached since 48.06s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:21,426 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:21,426 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:21,428 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:21,435 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:21,435 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:21,438 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:21,439 - sqlalchemy.engine.Engine - INFO - [cached since 48.07s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:21,441 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:21,441 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:21,442 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:21,444 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ2ODEsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.2PDEwFo5nPFnfgcnBN4FRc3p8ZL0h3dUSfGvVJZnCWw
2025-10-20 00:51:21,445 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994681, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:51:21,445 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:21,446 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:21,447 - sqlalchemy.engine.Engine - INFO - [cached since 48.01s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:51:21,449 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:51:21,471 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,148 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,150 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,152 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,153 - sqlalchemy.engine.Engine - INFO - [cached since 48.79s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,157 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,162 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:22,168 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ2ODEsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.2PDEwFo5nPFnfgcnBN4FRc3p8ZL0h3dUSfGvVJZnCWw
2025-10-20 00:51:22,170 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994681, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:51:22,172 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,175 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:22,177 - sqlalchemy.engine.Engine - INFO - [cached since 48.74s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:51:22,181 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:51:22,184 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,187 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,189 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,192 - sqlalchemy.engine.Engine - INFO - [cached since 48.82s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,195 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,204 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:51:22,206 - sqlalchemy.engine.Engine - INFO - [generated in 0.00202s] {'restaurant_id_1': 1}
2025-10-20 00:51:22,220 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,223 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,231 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,234 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,236 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,239 - sqlalchemy.engine.Engine - INFO - [cached since 48.87s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,244 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,245 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,246 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:22,259 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,262 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,265 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,268 - sqlalchemy.engine.Engine - INFO - [cached since 48.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,273 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,274 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,277 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:22,282 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ2ODEsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.2PDEwFo5nPFnfgcnBN4FRc3p8ZL0h3dUSfGvVJZnCWw
2025-10-20 00:51:22,284 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994681, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:51:22,287 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,290 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:22,292 - sqlalchemy.engine.Engine - INFO - [cached since 48.85s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:51:22,296 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:51:22,297 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,301 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,302 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,306 - sqlalchemy.engine.Engine - INFO - [cached since 48.94s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,312 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,313 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,318 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,322 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:51:22,326 - sqlalchemy.engine.Engine - INFO - [cached since 45.7s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:51:22,366 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,377 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,708 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,711 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,712 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,713 - sqlalchemy.engine.Engine - INFO - [cached since 49.35s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,719 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,720 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,723 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:22,731 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,734 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,735 - sqlalchemy.engine.Engine - INFO - [cached since 49.37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,739 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,739 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,741 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:22,748 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,749 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,751 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,753 - sqlalchemy.engine.Engine - INFO - [cached since 49.39s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,757 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,757 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,760 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:22,762 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,765 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,768 - sqlalchemy.engine.Engine - INFO - [cached since 49.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,772 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,773 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,777 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ2ODEsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.2PDEwFo5nPFnfgcnBN4FRc3p8ZL0h3dUSfGvVJZnCWw
2025-10-20 00:51:22,778 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994681, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:51:22,779 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,781 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:22,783 - sqlalchemy.engine.Engine - INFO - [cached since 49.34s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:51:22,787 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:51:22,790 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,793 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:51:22,796 - sqlalchemy.engine.Engine - INFO - [generated in 0.00299s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:51:22,807 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,811 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,829 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,833 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,836 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,838 - sqlalchemy.engine.Engine - INFO - [cached since 49.47s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,842 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,842 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,845 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:22,848 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ2ODEsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.2PDEwFo5nPFnfgcnBN4FRc3p8ZL0h3dUSfGvVJZnCWw
2025-10-20 00:51:22,849 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994681, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:51:22,852 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,854 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:22,856 - sqlalchemy.engine.Engine - INFO - [cached since 49.42s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:51:22,859 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:51:22,862 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:22,864 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,865 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:22,866 - sqlalchemy.engine.Engine - INFO - [cached since 49.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:22,870 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:22,870 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:22,878 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:22,888 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:51:22,890 - sqlalchemy.engine.Engine - INFO - [generated in 0.00249s] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:51:22,895 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:51:22,897 - sqlalchemy.engine.Engine - INFO - [cached since 0.009975s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:51:22,911 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:51:22,912 - sqlalchemy.engine.Engine - INFO - [generated in 0.00181s] {'pk_1': 4}
2025-10-20 00:51:22,923 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:51:22,925 - sqlalchemy.engine.Engine - INFO - [generated in 0.00171s] {'param_1': 12}
2025-10-20 00:51:22,940 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:22,941 - sqlalchemy.engine.Engine - INFO - [generated in 0.00206s] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:51:22,946 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:22,948 - sqlalchemy.engine.Engine - INFO - [cached since 0.008506s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:51:22,952 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:22,954 - sqlalchemy.engine.Engine - INFO - [cached since 0.01465s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:51:22,958 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:22,959 - sqlalchemy.engine.Engine - INFO - [cached since 0.0201s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:51:22,964 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:22,967 - sqlalchemy.engine.Engine - INFO - [cached since 0.02696s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:51:22,974 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:22,976 - sqlalchemy.engine.Engine - INFO - [generated in 0.00163s] {'restaurant_id_1': 1}
2025-10-20 00:51:22,988 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:22,989 - sqlalchemy.engine.Engine - INFO - [generated in 0.00176s] {'restaurant_id_1': 1}
2025-10-20 00:51:23,002 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:23,004 - sqlalchemy.engine.Engine - INFO - [generated in 0.00245s] {'restaurant_id_1': 1}
2025-10-20 00:51:23,011 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:23,016 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:55,851 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:55,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:55,855 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:55,856 - sqlalchemy.engine.Engine - INFO - [cached since 82.49s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:55,859 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:55,860 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:55,862 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:55,871 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:55,875 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:55,877 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:55,878 - sqlalchemy.engine.Engine - INFO - [cached since 82.51s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:55,882 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:55,882 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:55,884 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:55,889 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:55,892 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:55,894 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:55,897 - sqlalchemy.engine.Engine - INFO - [cached since 82.53s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:55,902 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:55,902 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:55,906 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ2ODEsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.2PDEwFo5nPFnfgcnBN4FRc3p8ZL0h3dUSfGvVJZnCWw
2025-10-20 00:51:55,907 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994681, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:51:55,908 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:55,909 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:55,911 - sqlalchemy.engine.Engine - INFO - [cached since 82.47s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:51:55,914 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:51:55,922 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:55,924 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:51:55,926 - sqlalchemy.engine.Engine - INFO - [cached since 33.04s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:51:55,930 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:51:55,934 - sqlalchemy.engine.Engine - INFO - [cached since 33.02s ago] {'pk_1': 4}
2025-10-20 00:51:55,940 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:51:55,942 - sqlalchemy.engine.Engine - INFO - [cached since 33.02s ago] {'param_1': 12}
2025-10-20 00:51:55,947 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:55,950 - sqlalchemy.engine.Engine - INFO - [cached since 33.01s ago] {'restaurant_id_1': 1, 'role_1': 'staff'}
2025-10-20 00:51:55,954 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:55,956 - sqlalchemy.engine.Engine - INFO - [cached since 35.26s ago] {'email_1': 'cocinero-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:51:55,960 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:55,962 - sqlalchemy.engine.Engine - INFO - [cached since 35.27s ago] {'email_1': 'cocinero-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:51:56,569 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (email, hashed_password, full_name, `role`, staff_type, is_active, restaurant_id, created_at, updated_at, deleted_at) VALUES (%(email)s, %(hashed_password)s, %(full_name)s, %(role)s, %(staff_type)s, %(is_active)s, %(restaurant_id)s, %(created_at)s, %(updated_at)s, %(deleted_at)s)
2025-10-20 00:51:56,571 - sqlalchemy.engine.Engine - INFO - [generated in 0.00200s] {'email': 'cocinero-default@shopacoffee.com', 'hashed_password': '$2b$12$oyFfWC5y5kbgyNTYk9gcnOeNY3CCbntAmRLQ9AdCzOt7ib6.YxebW', 'full_name': 'cocinero', 'role': 'staff', 'staff_type': 'kitchen', 'is_active': 1, 'restaurant_id': 1, 'created_at': datetime.datetime(2025, 10, 20, 7, 51, 56, 569304, tzinfo=datetime.timezone.utc), 'updated_at': datetime.datetime(2025, 10, 20, 7, 51, 56, 569304, tzinfo=datetime.timezone.utc), 'deleted_at': None}
2025-10-20 00:51:56,582 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-20 00:51:56,590 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,595 - sqlalchemy.engine.Engine - INFO - SELECT users.email, users.hashed_password, users.full_name, users.`role`, users.staff_type, users.is_active, users.restaurant_id, users.id, users.created_at, users.updated_at, users.deleted_at 
FROM users 
WHERE users.id = %(pk_1)s
2025-10-20 00:51:56,597 - sqlalchemy.engine.Engine - INFO - [generated in 0.00191s] {'pk_1': 9}
2025-10-20 00:51:56,607 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,612 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,672 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:56,674 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,677 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:56,679 - sqlalchemy.engine.Engine - INFO - [cached since 83.31s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:56,684 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:56,685 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,688 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:56,690 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:56,692 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,694 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:56,697 - sqlalchemy.engine.Engine - INFO - [cached since 83.33s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:56,701 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:56,702 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,706 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:51:56,710 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:56,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,716 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:56,718 - sqlalchemy.engine.Engine - INFO - [cached since 83.35s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:56,722 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:56,722 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,725 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ2ODEsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.2PDEwFo5nPFnfgcnBN4FRc3p8ZL0h3dUSfGvVJZnCWw
2025-10-20 00:51:56,727 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994681, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:51:56,727 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,730 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:56,731 - sqlalchemy.engine.Engine - INFO - [cached since 83.29s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:51:56,735 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:51:56,737 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ2ODEsInN1YiI6IjMiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiLCJhZG1pbiJdLCJ0eXBlIjoiYWNjZXNzIn0.2PDEwFo5nPFnfgcnBN4FRc3p8ZL0h3dUSfGvVJZnCWw
2025-10-20 00:51:56,738 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994681, 'sub': '3', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders', 'admin'], 'type': 'access'}
2025-10-20 00:51:56,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,742 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:51:56,744 - sqlalchemy.engine.Engine - INFO - [cached since 83.3s ago] {'id_1': 3, 'param_1': 1}
2025-10-20 00:51:56,746 - app.services.user - DEBUG - Found user: admin@coffeeshop.com with role: UserRole.ADMIN
2025-10-20 00:51:56,747 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:51:56,749 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,752 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:51:56,754 - sqlalchemy.engine.Engine - INFO - [cached since 83.39s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:51:56,757 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:51:56,758 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,767 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:51:56,769 - sqlalchemy.engine.Engine - INFO - [cached since 33.98s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:51:56,783 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,789 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:51:56,793 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:51:56,794 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,797 - sqlalchemy.engine.Engine - INFO - [cached since 33.91s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:51:56,809 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:51:56,811 - sqlalchemy.engine.Engine - INFO - [cached since 33.92s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:51:56,816 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:51:56,819 - sqlalchemy.engine.Engine - INFO - [cached since 33.91s ago] {'pk_1': 4}
2025-10-20 00:51:56,825 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:51:56,827 - sqlalchemy.engine.Engine - INFO - [cached since 33.9s ago] {'param_1': 12}
2025-10-20 00:51:56,834 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:56,837 - sqlalchemy.engine.Engine - INFO - [cached since 33.9s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:51:56,842 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:56,844 - sqlalchemy.engine.Engine - INFO - [cached since 33.9s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:51:56,857 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:56,865 - sqlalchemy.engine.Engine - INFO - [cached since 33.93s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:51:56,872 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:56,876 - sqlalchemy.engine.Engine - INFO - [cached since 33.94s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:51:56,883 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:56,886 - sqlalchemy.engine.Engine - INFO - [cached since 33.95s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:51:56,890 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:56,891 - sqlalchemy.engine.Engine - INFO - [cached since 33.92s ago] {'restaurant_id_1': 1}
2025-10-20 00:51:56,897 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:56,905 - sqlalchemy.engine.Engine - INFO - [cached since 33.92s ago] {'restaurant_id_1': 1}
2025-10-20 00:51:56,919 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:51:56,921 - sqlalchemy.engine.Engine - INFO - [cached since 33.92s ago] {'restaurant_id_1': 1}
2025-10-20 00:51:56,929 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:51:56,940 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:04,322 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:04,323 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:04,325 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:04,326 - sqlalchemy.engine.Engine - INFO - [cached since 90.96s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:04,329 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:04,329 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:04,332 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:52:04,334 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:52:04,334 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:52:04,334 - multipart.multipart - DEBUG - Calling on_field_data with data[9:43]
2025-10-20 00:52:04,334 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:52:04,335 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:52:04,335 - multipart.multipart - DEBUG - Calling on_field_name with data[44:52]
2025-10-20 00:52:04,335 - multipart.multipart - DEBUG - Calling on_field_data with data[53:68]
2025-10-20 00:52:04,336 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:52:04,336 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:52:04,336 - multipart.multipart - DEBUG - Calling on_field_name with data[69:79]
2025-10-20 00:52:04,336 - multipart.multipart - DEBUG - Calling on_field_data with data[80:88]
2025-10-20 00:52:04,336 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:52:04,336 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:52:04,336 - multipart.multipart - DEBUG - Calling on_field_name with data[89:94]
2025-10-20 00:52:04,336 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:52:04,337 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:52:04,338 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:04,340 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:52:04,340 - sqlalchemy.engine.Engine - INFO - [cached since 43.65s ago] {'email_1': 'cocinero-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:52:05,017 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:05,019 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:05,020 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:05,023 - sqlalchemy.engine.Engine - INFO - [cached since 91.65s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:05,027 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:05,027 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:05,033 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:05,037 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:05,038 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:05,039 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:05,040 - sqlalchemy.engine.Engine - INFO - [cached since 91.67s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:05,043 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:05,043 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:05,044 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:52:05,046 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MjUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.mPnPPcaE2VZMZ-PtL2IMtS-QW3p_GspibRumYik81Fs
2025-10-20 00:52:05,047 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994725, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:52:05,048 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:05,048 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:52:05,049 - sqlalchemy.engine.Engine - INFO - [cached since 91.61s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:52:05,054 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:52:05,056 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:05,074 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:05,074 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:05,076 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:05,078 - sqlalchemy.engine.Engine - INFO - [cached since 91.71s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:05,080 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:05,081 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:05,082 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:52:05,089 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:05,091 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:05,093 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:05,094 - sqlalchemy.engine.Engine - INFO - [cached since 91.73s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:05,097 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:05,097 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:05,098 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:52:05,101 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MjUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.mPnPPcaE2VZMZ-PtL2IMtS-QW3p_GspibRumYik81Fs
2025-10-20 00:52:05,101 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994725, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:52:05,104 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:05,105 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:52:05,107 - sqlalchemy.engine.Engine - INFO - [cached since 91.67s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:52:05,109 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:52:05,111 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:05,112 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:05,114 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:05,115 - sqlalchemy.engine.Engine - INFO - [cached since 91.75s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:05,118 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:05,120 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:05,124 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:05,124 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:52:05,126 - sqlalchemy.engine.Engine - INFO - [cached since 88.5s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:52:05,154 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:05,156 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:15,268 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:15,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:15,272 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:15,272 - sqlalchemy.engine.Engine - INFO - [cached since 101.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:15,274 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:15,274 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:15,276 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:52:15,277 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:52:15,277 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:52:15,278 - multipart.multipart - DEBUG - Calling on_field_data with data[9:43]
2025-10-20 00:52:15,278 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:52:15,278 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:52:15,279 - multipart.multipart - DEBUG - Calling on_field_name with data[44:52]
2025-10-20 00:52:15,279 - multipart.multipart - DEBUG - Calling on_field_data with data[53:68]
2025-10-20 00:52:15,279 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:52:15,279 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:52:15,279 - multipart.multipart - DEBUG - Calling on_field_name with data[69:79]
2025-10-20 00:52:15,279 - multipart.multipart - DEBUG - Calling on_field_data with data[80:88]
2025-10-20 00:52:15,279 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:52:15,280 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:52:15,280 - multipart.multipart - DEBUG - Calling on_field_name with data[89:94]
2025-10-20 00:52:15,280 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:52:15,280 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:52:15,284 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:15,284 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:52:15,286 - sqlalchemy.engine.Engine - INFO - [cached since 54.59s ago] {'email_1': 'cocinero-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:52:15,965 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:15,967 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:15,969 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:15,971 - sqlalchemy.engine.Engine - INFO - [cached since 102.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:15,973 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:15,974 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:15,981 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:15,986 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:15,987 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:15,989 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:15,991 - sqlalchemy.engine.Engine - INFO - [cached since 102.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:15,994 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:15,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:15,997 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:52:15,999 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:52:15,999 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:52:16,000 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:16,002 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:52:16,002 - sqlalchemy.engine.Engine - INFO - [cached since 102.6s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:52:16,006 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:52:16,010 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:16,028 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:16,030 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:16,032 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:16,032 - sqlalchemy.engine.Engine - INFO - [cached since 102.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:16,035 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:16,035 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:16,037 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:52:16,045 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:16,045 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:16,047 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:16,048 - sqlalchemy.engine.Engine - INFO - [cached since 102.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:16,051 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:16,051 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:16,053 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:52:16,057 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:52:16,058 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:52:16,059 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:16,061 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:52:16,061 - sqlalchemy.engine.Engine - INFO - [cached since 102.6s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:52:16,064 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:52:16,065 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:52:16,068 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:16,069 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:52:16,071 - sqlalchemy.engine.Engine - INFO - [cached since 102.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:52:16,074 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:52:16,074 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:16,078 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:52:16,078 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:52:16,081 - sqlalchemy.engine.Engine - INFO - [cached since 99.46s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:52:16,102 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:52:16,104 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:53:23,750 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:53:23,756 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:53:23,761 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:53:23,765 - sqlalchemy.engine.Engine - INFO - [cached since 170.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:53:23,776 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:53:23,778 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:53:23,786 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:53:23,825 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:53:23,831 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:53:23,837 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:53:23,842 - sqlalchemy.engine.Engine - INFO - [cached since 170.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:53:23,851 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:53:23,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:53:23,859 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:53:23,872 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:53:23,875 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:53:23,881 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:53:23,886 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:53:23,892 - sqlalchemy.engine.Engine - INFO - [cached since 170.5s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:53:23,902 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:53:23,907 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:53:23,913 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:53:23,917 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:53:23,922 - sqlalchemy.engine.Engine - INFO - [cached since 170.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:53:23,933 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:53:23,933 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:53:23,947 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:53:23,953 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:53:23,960 - sqlalchemy.engine.Engine - INFO - [cached since 167.3s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:53:24,073 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:53:24,091 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:54:58,798 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:54:58,802 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:54:58,802 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:54:58,803 - sqlalchemy.engine.Engine - INFO - [cached since 265.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:54:58,804 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:54:58,804 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:54:58,805 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:54:58,806 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:54:58,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:54:58,808 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:54:58,812 - sqlalchemy.engine.Engine - INFO - [cached since 265.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:54:58,823 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:54:58,824 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:54:58,831 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:54:58,845 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:54:58,848 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:54:58,854 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:54:58,858 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:54:58,863 - sqlalchemy.engine.Engine - INFO - [cached since 265.4s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:54:58,872 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:54:58,878 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:54:58,883 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:54:58,888 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:54:58,892 - sqlalchemy.engine.Engine - INFO - [cached since 265.5s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:54:58,907 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:54:58,908 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:54:58,920 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:54:58,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:54:58,931 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:54:58,936 - sqlalchemy.engine.Engine - INFO - [cached since 265.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:54:58,946 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:54:58,948 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:54:58,954 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:54:58,962 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:54:58,970 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:54:58,975 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:54:58,980 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:54:58,985 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:54:58,988 - sqlalchemy.engine.Engine - INFO - [cached since 265.5s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:54:58,998 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:54:59,005 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:54:59,009 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:54:59,015 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:54:59,024 - sqlalchemy.engine.Engine - INFO - [cached since 265.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:54:59,035 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:54:59,036 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:54:59,048 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:54:59,053 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:54:59,060 - sqlalchemy.engine.Engine - INFO - [cached since 262.4s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:54:59,163 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:54:59,179 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:09,989 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:09,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:09,992 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:09,993 - sqlalchemy.engine.Engine - INFO - [cached since 276.6s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:09,994 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:09,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:09,995 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:09,997 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:55:10,000 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:55:10,006 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:10,010 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:55:10,014 - sqlalchemy.engine.Engine - INFO - [cached since 276.6s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:55:10,019 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:55:10,020 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:10,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:10,021 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:10,022 - sqlalchemy.engine.Engine - INFO - [cached since 276.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:10,024 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:10,024 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:10,027 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:10,034 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:10,039 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:10,044 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:10,049 - sqlalchemy.engine.Engine - INFO - [cached since 276.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:10,052 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:10,052 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:10,053 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:10,060 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:10,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:10,061 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:10,062 - sqlalchemy.engine.Engine - INFO - [cached since 276.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:10,064 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:10,064 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:10,070 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:10,085 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:55:10,085 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:55:10,086 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:10,087 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:55:10,087 - sqlalchemy.engine.Engine - INFO - [cached since 276.6s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:55:10,089 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:55:10,090 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:10,091 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:10,092 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:10,092 - sqlalchemy.engine.Engine - INFO - [cached since 276.7s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:10,094 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:10,095 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:10,097 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:10,100 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:55:10,107 - sqlalchemy.engine.Engine - INFO - [cached since 273.5s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:55:10,131 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:10,133 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,251 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:25,253 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,255 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:25,267 - sqlalchemy.engine.Engine - INFO - [cached since 291.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:25,276 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:25,276 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,280 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:25,283 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:55:25,284 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:55:25,286 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,289 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:55:25,292 - sqlalchemy.engine.Engine - INFO - [cached since 291.9s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:55:25,304 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:55:25,310 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:25,313 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,315 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:25,318 - sqlalchemy.engine.Engine - INFO - [cached since 291.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:25,322 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:25,322 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,325 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,368 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:25,370 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,372 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:25,374 - sqlalchemy.engine.Engine - INFO - [cached since 292s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:25,378 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:25,378 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,380 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:25,384 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:55:25,385 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:55:25,387 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,389 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:55:25,391 - sqlalchemy.engine.Engine - INFO - [cached since 292s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:55:25,395 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:55:25,396 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:25,398 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,400 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:25,403 - sqlalchemy.engine.Engine - INFO - [cached since 292s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:25,412 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:25,413 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,417 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,420 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:55:25,423 - sqlalchemy.engine.Engine - INFO - [cached since 243.2s ago] {'restaurant_id_1': 1}
2025-10-20 00:55:25,442 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,453 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,484 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:25,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,489 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:25,492 - sqlalchemy.engine.Engine - INFO - [cached since 292.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:25,512 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:25,513 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,521 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:25,546 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:25,548 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,549 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:25,552 - sqlalchemy.engine.Engine - INFO - [cached since 292.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:25,556 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:25,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,557 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:25,558 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:55:25,559 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:55:25,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,559 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:55:25,561 - sqlalchemy.engine.Engine - INFO - [cached since 292.1s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:55:25,561 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:55:25,563 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:25,563 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,564 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:25,564 - sqlalchemy.engine.Engine - INFO - [cached since 292.2s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:25,566 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:25,566 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,568 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:25,568 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:55:25,569 - sqlalchemy.engine.Engine - INFO - [cached since 288.9s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:55:25,579 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:25,585 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,261 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:33,268 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,269 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:33,272 - sqlalchemy.engine.Engine - INFO - [cached since 299.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:33,285 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:33,288 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,291 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:33,294 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:55:33,294 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:55:33,296 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,298 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:55:33,300 - sqlalchemy.engine.Engine - INFO - [cached since 299.9s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:55:33,303 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:55:33,305 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:33,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,308 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:33,311 - sqlalchemy.engine.Engine - INFO - [cached since 299.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:33,314 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:33,314 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,319 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,328 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:33,330 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,331 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:33,332 - sqlalchemy.engine.Engine - INFO - [cached since 300s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:33,336 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:33,337 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,340 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:33,344 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:55:33,345 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:55:33,347 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,355 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:55:33,367 - sqlalchemy.engine.Engine - INFO - [cached since 299.9s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:55:33,377 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:55:33,390 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:33,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,405 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:33,412 - sqlalchemy.engine.Engine - INFO - [cached since 300s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:33,418 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:33,418 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,427 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,428 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:55:33,430 - sqlalchemy.engine.Engine - INFO - [cached since 251.2s ago] {'restaurant_id_1': 1}
2025-10-20 00:55:33,437 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,441 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,447 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:33,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,451 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:33,452 - sqlalchemy.engine.Engine - INFO - [cached since 300.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:33,455 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:33,455 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,458 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:33,465 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:33,466 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,468 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:33,469 - sqlalchemy.engine.Engine - INFO - [cached since 300.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:33,472 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:33,473 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,475 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:55:33,478 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:55:33,478 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:55:33,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,481 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:55:33,482 - sqlalchemy.engine.Engine - INFO - [cached since 300s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:55:33,487 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:55:33,488 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:55:33,490 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,491 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:55:33,493 - sqlalchemy.engine.Engine - INFO - [cached since 300.1s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:55:33,496 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:55:33,496 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,522 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:55:33,523 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:55:33,525 - sqlalchemy.engine.Engine - INFO - [cached since 296.9s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:55:33,569 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:55:33,573 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:56:39,751 - app.main - INFO - Shutting down background tasks...
2025-10-20 00:56:42,873 - app.main - INFO - ==================================================
2025-10-20 00:56:42,875 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:56:42,875 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:56:42,875 - app.main - INFO - ==================================================
2025-10-20 00:57:24,605 - app.main - INFO - ==================================================
2025-10-20 00:57:24,606 - app.main - INFO - Application starting - Logging initialized
2025-10-20 00:57:24,606 - app.main - INFO - Log file location: c:\Users\luisa\CascadeProjects\coffee-shop-admin\backend\logs\app.log
2025-10-20 00:57:24,607 - app.main - INFO - ==================================================
2025-10-20 00:57:25,545 - app.main - INFO - Starting background tasks...
2025-10-20 00:57:40,159 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:40,321 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-10-20 00:57:40,323 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:57:40,325 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-10-20 00:57:40,326 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:57:40,330 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-10-20 00:57:40,331 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-10-20 00:57:40,337 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,351 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:40,354 - sqlalchemy.engine.Engine - INFO - [generated in 0.00309s] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:40,359 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:40,359 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,364 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:40,372 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:40,374 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,377 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:40,378 - sqlalchemy.engine.Engine - INFO - [cached since 0.02689s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:40,381 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:40,382 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,385 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:40,386 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:57:40,398 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:40,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,407 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:40,409 - sqlalchemy.engine.Engine - INFO - [generated in 0.00225s] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:40,413 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:40,419 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:40,440 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,443 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:40,444 - sqlalchemy.engine.Engine - INFO - [cached since 0.09263s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:40,448 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:40,448 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,460 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,470 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:40,469 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:57:40,474 - sqlalchemy.engine.Engine - INFO - [generated in 0.00455s] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:57:40,486 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:57:40,489 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,502 - sqlalchemy.engine.Engine - INFO - [cached since 0.03326s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:57:40,504 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:40,506 - sqlalchemy.engine.Engine - INFO - [cached since 0.1545s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:40,518 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:57:40,522 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:40,522 - sqlalchemy.engine.Engine - INFO - [generated in 0.00487s] {'pk_1': 4}
2025-10-20 00:57:40,524 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,528 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:40,540 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:57:40,539 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:57:40,541 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:40,541 - sqlalchemy.engine.Engine - INFO - [generated in 0.00330s] {'param_1': 12}
2025-10-20 00:57:40,544 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,559 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:40,559 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:40,562 - sqlalchemy.engine.Engine - INFO - [generated in 0.00261s] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:57:40,563 - sqlalchemy.engine.Engine - INFO - [cached since 0.1561s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:40,569 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:40,568 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:40,572 - sqlalchemy.engine.Engine - INFO - [cached since 0.01275s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:57:40,574 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:40,578 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:40,579 - sqlalchemy.engine.Engine - INFO - [cached since 0.02029s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:57:40,582 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:40,585 - sqlalchemy.engine.Engine - INFO - [cached since 0.02579s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:57:40,586 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,588 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:40,590 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:40,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.2411s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:40,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.03417s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:57:40,596 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:40,605 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:40,606 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,608 - sqlalchemy.engine.Engine - INFO - [generated in 0.00227s] {'restaurant_id_1': 1}
2025-10-20 00:57:40,627 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:40,628 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,629 - sqlalchemy.engine.Engine - INFO - [generated in 0.00208s] {'restaurant_id_1': 1}
2025-10-20 00:57:40,664 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:57:40,676 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:40,677 - sqlalchemy.engine.Engine - INFO - [generated in 0.01232s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:57:40,679 - sqlalchemy.engine.Engine - INFO - [generated in 0.00298s] {'restaurant_id_1': 1}
2025-10-20 00:57:40,724 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,725 - sqlalchemy.engine.Engine - INFO - [generated in 0.00174s] {'pk_1': 16}
2025-10-20 00:57:40,729 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,732 - sqlalchemy.engine.Engine - INFO - [cached since 0.008512s ago] {'pk_1': 9}
2025-10-20 00:57:40,737 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,739 - sqlalchemy.engine.Engine - INFO - [cached since 0.01606s ago] {'pk_1': 15}
2025-10-20 00:57:40,744 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,745 - sqlalchemy.engine.Engine - INFO - [cached since 0.02131s ago] {'pk_1': 13}
2025-10-20 00:57:40,748 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,751 - sqlalchemy.engine.Engine - INFO - [cached since 0.02782s ago] {'pk_1': 14}
2025-10-20 00:57:40,757 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.03514s ago] {'pk_1': 18}
2025-10-20 00:57:40,762 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,763 - sqlalchemy.engine.Engine - INFO - [cached since 0.04092s ago] {'pk_1': 21}
2025-10-20 00:57:40,770 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,772 - sqlalchemy.engine.Engine - INFO - [cached since 0.04826s ago] {'pk_1': 19}
2025-10-20 00:57:40,775 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,777 - sqlalchemy.engine.Engine - INFO - [cached since 0.05407s ago] {'pk_1': 22}
2025-10-20 00:57:40,782 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,785 - sqlalchemy.engine.Engine - INFO - [cached since 0.06212s ago] {'pk_1': 7}
2025-10-20 00:57:40,791 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,794 - sqlalchemy.engine.Engine - INFO - [cached since 0.07008s ago] {'pk_1': 5}
2025-10-20 00:57:40,800 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,801 - sqlalchemy.engine.Engine - INFO - [cached since 0.07762s ago] {'pk_1': 6}
2025-10-20 00:57:40,806 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:40,809 - sqlalchemy.engine.Engine - INFO - [cached since 0.08512s ago] {'pk_1': 8}
2025-10-20 00:57:40,836 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,838 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,844 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,844 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,851 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:40,854 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,855 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:40,857 - sqlalchemy.engine.Engine - INFO - [cached since 0.5055s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:40,860 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:40,860 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,862 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:40,874 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:40,876 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,877 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:40,879 - sqlalchemy.engine.Engine - INFO - [cached since 0.5278s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:40,882 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:40,882 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,886 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:40,890 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:57:40,891 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:40,892 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,894 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:40,895 - sqlalchemy.engine.Engine - INFO - [cached since 0.4887s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:40,899 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:40,903 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:40,905 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,907 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:40,909 - sqlalchemy.engine.Engine - INFO - [cached since 0.5574s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:40,912 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:40,912 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,916 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:40,920 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:57:40,923 - sqlalchemy.engine.Engine - INFO - [generated in 0.00301s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:57:40,937 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:40,943 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,081 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:44,082 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,082 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:44,084 - sqlalchemy.engine.Engine - INFO - [cached since 3.733s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:44,086 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:44,086 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,088 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:44,090 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:57:44,091 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:44,092 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,093 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:44,094 - sqlalchemy.engine.Engine - INFO - [cached since 3.687s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:44,095 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:44,096 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:44,096 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,098 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:44,099 - sqlalchemy.engine.Engine - INFO - [cached since 3.748s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:44,102 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:44,102 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,105 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,106 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:57:44,106 - sqlalchemy.engine.Engine - INFO - [cached since 3.637s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:57:44,109 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:57:44,111 - sqlalchemy.engine.Engine - INFO - [cached since 3.642s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:57:44,115 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:44,113 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:57:44,117 - sqlalchemy.engine.Engine - INFO - [cached since 3.599s ago] {'pk_1': 4}
2025-10-20 00:57:44,120 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,138 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:44,166 - sqlalchemy.engine.Engine - INFO - [cached since 3.814s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:44,206 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:44,185 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:57:44,206 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,206 - sqlalchemy.engine.Engine - INFO - [cached since 3.667s ago] {'param_1': 12}
2025-10-20 00:57:44,207 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:44,209 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:44,212 - sqlalchemy.engine.Engine - INFO - [cached since 3.653s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:57:44,216 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:44,218 - sqlalchemy.engine.Engine - INFO - [cached since 3.659s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:57:44,222 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:44,221 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:44,224 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,224 - sqlalchemy.engine.Engine - INFO - [cached since 3.665s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:57:44,225 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:44,226 - sqlalchemy.engine.Engine - INFO - [cached since 3.875s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:44,228 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:44,230 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:44,231 - sqlalchemy.engine.Engine - INFO - [cached since 3.671s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:57:44,231 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,234 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:44,234 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:44,236 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:57:44,237 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:44,236 - sqlalchemy.engine.Engine - INFO - [cached since 3.677s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:57:44,238 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,238 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:44,239 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:44,239 - sqlalchemy.engine.Engine - INFO - [cached since 3.833s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:44,241 - sqlalchemy.engine.Engine - INFO - [cached since 3.636s ago] {'restaurant_id_1': 1}
2025-10-20 00:57:44,242 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:44,244 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:44,246 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:44,245 - sqlalchemy.engine.Engine - INFO - [cached since 3.619s ago] {'restaurant_id_1': 1}
2025-10-20 00:57:44,248 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,267 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:44,271 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:44,275 - sqlalchemy.engine.Engine - INFO - [cached since 3.923s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:44,275 - sqlalchemy.engine.Engine - INFO - [cached since 3.6s ago] {'restaurant_id_1': 1}
2025-10-20 00:57:44,278 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:44,279 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,284 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:57:44,285 - sqlalchemy.engine.Engine - INFO - [cached since 3.621s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:57:44,307 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,308 - sqlalchemy.engine.Engine - INFO - [cached since 3.585s ago] {'pk_1': 16}
2025-10-20 00:57:44,310 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,312 - sqlalchemy.engine.Engine - INFO - [cached since 3.589s ago] {'pk_1': 9}
2025-10-20 00:57:44,316 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,316 - sqlalchemy.engine.Engine - INFO - [cached since 3.593s ago] {'pk_1': 15}
2025-10-20 00:57:44,319 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,321 - sqlalchemy.engine.Engine - INFO - [cached since 3.597s ago] {'pk_1': 13}
2025-10-20 00:57:44,325 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,325 - sqlalchemy.engine.Engine - INFO - [cached since 3.602s ago] {'pk_1': 14}
2025-10-20 00:57:44,328 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,329 - sqlalchemy.engine.Engine - INFO - [cached since 3.606s ago] {'pk_1': 18}
2025-10-20 00:57:44,332 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,332 - sqlalchemy.engine.Engine - INFO - [cached since 3.61s ago] {'pk_1': 21}
2025-10-20 00:57:44,335 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,336 - sqlalchemy.engine.Engine - INFO - [cached since 3.613s ago] {'pk_1': 19}
2025-10-20 00:57:44,340 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,341 - sqlalchemy.engine.Engine - INFO - [cached since 3.618s ago] {'pk_1': 22}
2025-10-20 00:57:44,345 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,346 - sqlalchemy.engine.Engine - INFO - [cached since 3.622s ago] {'pk_1': 7}
2025-10-20 00:57:44,348 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,349 - sqlalchemy.engine.Engine - INFO - [cached since 3.626s ago] {'pk_1': 5}
2025-10-20 00:57:44,352 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,353 - sqlalchemy.engine.Engine - INFO - [cached since 3.629s ago] {'pk_1': 6}
2025-10-20 00:57:44,356 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:44,356 - sqlalchemy.engine.Engine - INFO - [cached since 3.634s ago] {'pk_1': 8}
2025-10-20 00:57:44,370 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,372 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,374 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,374 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,379 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:44,380 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,382 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:44,382 - sqlalchemy.engine.Engine - INFO - [cached since 4.032s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:44,385 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:44,385 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,386 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:44,392 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:44,393 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,395 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:44,396 - sqlalchemy.engine.Engine - INFO - [cached since 4.044s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:44,398 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:44,398 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,400 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:44,401 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTQ3MzUsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.jXPPNhBhdPRNS0gCPrUYmofTyVK40y6XW7-jqoE57D4
2025-10-20 00:57:44,403 - app.services.user - DEBUG - Decoded payload: {'exp': 1760994735, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:44,403 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,405 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:44,406 - sqlalchemy.engine.Engine - INFO - [cached since 3.999s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:44,408 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:44,410 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:44,411 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,413 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:44,413 - sqlalchemy.engine.Engine - INFO - [cached since 4.062s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:44,415 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:44,416 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:44,418 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-10-20 00:57:44,418 - sqlalchemy.engine.Engine - INFO - [cached since 3.499s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:57:44,425 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:44,426 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:53,113 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:53,115 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:53,118 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:53,119 - sqlalchemy.engine.Engine - INFO - [cached since 12.77s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:53,122 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:53,122 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:53,123 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:53,127 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:57:53,127 - multipart.multipart - DEBUG - Calling on_field_name with data[0:8]
2025-10-20 00:57:53,128 - multipart.multipart - DEBUG - Calling on_field_data with data[9:43]
2025-10-20 00:57:53,128 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:57:53,128 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:57:53,129 - multipart.multipart - DEBUG - Calling on_field_name with data[44:52]
2025-10-20 00:57:53,129 - multipart.multipart - DEBUG - Calling on_field_data with data[53:68]
2025-10-20 00:57:53,129 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:57:53,129 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:57:53,130 - multipart.multipart - DEBUG - Calling on_field_name with data[69:79]
2025-10-20 00:57:53,130 - multipart.multipart - DEBUG - Calling on_field_data with data[80:88]
2025-10-20 00:57:53,130 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:57:53,130 - multipart.multipart - DEBUG - Calling on_field_start with no data
2025-10-20 00:57:53,130 - multipart.multipart - DEBUG - Calling on_field_name with data[89:94]
2025-10-20 00:57:53,132 - multipart.multipart - DEBUG - Calling on_field_end with no data
2025-10-20 00:57:53,132 - multipart.multipart - DEBUG - Calling on_end with no data
2025-10-20 00:57:53,135 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:53,139 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:53,141 - sqlalchemy.engine.Engine - INFO - [generated in 0.00156s] {'email_1': 'cocinero-default@shopacoffee.com', 'param_1': 1}
2025-10-20 00:57:53,144 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '4.0.1'
2025-10-20 00:57:53,144 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-10-20 00:57:53,885 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:53,887 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:53,889 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:53,890 - sqlalchemy.engine.Engine - INFO - [cached since 13.54s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:53,892 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:53,893 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:53,898 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:53,901 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:53,902 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:53,905 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:53,906 - sqlalchemy.engine.Engine - INFO - [cached since 13.55s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:53,907 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:53,908 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:53,910 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:53,912 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:57:53,912 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:53,914 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:53,915 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:53,915 - sqlalchemy.engine.Engine - INFO - [cached since 13.51s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:53,916 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:53,932 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,676 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:54,679 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,680 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:54,680 - sqlalchemy.engine.Engine - INFO - [cached since 14.33s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:54,684 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:54,684 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,685 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:54,687 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:57:54,687 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:54,689 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,689 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:54,690 - sqlalchemy.engine.Engine - INFO - [cached since 14.28s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:54,692 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:54,693 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:54,693 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,696 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:54,697 - sqlalchemy.engine.Engine - INFO - [cached since 14.35s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:54,700 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:54,700 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,703 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,704 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.deleted_at IS NULL AND categories.restaurant_id = %(restaurant_id_1)s
2025-10-20 00:57:54,705 - sqlalchemy.engine.Engine - INFO - [generated in 0.00110s] {'restaurant_id_1': 1}
2025-10-20 00:57:54,714 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,716 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,721 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:54,724 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,725 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:54,726 - sqlalchemy.engine.Engine - INFO - [cached since 14.37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:54,729 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:54,730 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,732 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:54,740 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:54,742 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,742 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:54,744 - sqlalchemy.engine.Engine - INFO - [cached since 14.39s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:54,746 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:54,746 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,748 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:54,751 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:57:54,751 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:54,751 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,753 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:54,753 - sqlalchemy.engine.Engine - INFO - [cached since 14.35s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:54,755 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:54,759 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:54,761 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,763 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:54,766 - sqlalchemy.engine.Engine - INFO - [cached since 14.41s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:54,768 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:54,768 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,774 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:54,786 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:57:54,787 - sqlalchemy.engine.Engine - INFO - [generated in 0.00211s] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:57:54,813 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:54,815 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,530 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,534 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,534 - sqlalchemy.engine.Engine - INFO - [cached since 17.18s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,537 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,538 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,540 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,542 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:57:57,543 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:57,545 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,547 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:57,548 - sqlalchemy.engine.Engine - INFO - [cached since 17.14s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:57,551 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:57,553 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,555 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,557 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,558 - sqlalchemy.engine.Engine - INFO - [cached since 17.21s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,561 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,562 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,567 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:57:57,569 - sqlalchemy.engine.Engine - INFO - [cached since 17.1s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:57:57,575 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:57:57,577 - sqlalchemy.engine.Engine - INFO - [cached since 17.11s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:57:57,580 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:57:57,582 - sqlalchemy.engine.Engine - INFO - [cached since 17.06s ago] {'pk_1': 4}
2025-10-20 00:57:57,588 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:57:57,590 - sqlalchemy.engine.Engine - INFO - [cached since 17.05s ago] {'param_1': 12}
2025-10-20 00:57:57,594 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:57,596 - sqlalchemy.engine.Engine - INFO - [cached since 17.04s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:57:57,599 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:57,601 - sqlalchemy.engine.Engine - INFO - [cached since 17.04s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:57:57,604 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:57,606 - sqlalchemy.engine.Engine - INFO - [cached since 17.05s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:57:57,609 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:57,611 - sqlalchemy.engine.Engine - INFO - [cached since 17.05s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:57:57,616 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:57,617 - sqlalchemy.engine.Engine - INFO - [cached since 17.06s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:57:57,621 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:57,622 - sqlalchemy.engine.Engine - INFO - [cached since 17.02s ago] {'restaurant_id_1': 1}
2025-10-20 00:57:57,626 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:57,627 - sqlalchemy.engine.Engine - INFO - [cached since 17s ago] {'restaurant_id_1': 1}
2025-10-20 00:57:57,633 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:57:57,634 - sqlalchemy.engine.Engine - INFO - [cached since 16.96s ago] {'restaurant_id_1': 1}
2025-10-20 00:57:57,641 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,644 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,746 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,748 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,750 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,750 - sqlalchemy.engine.Engine - INFO - [cached since 17.4s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,754 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,755 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,756 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,761 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,763 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,764 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,765 - sqlalchemy.engine.Engine - INFO - [cached since 17.41s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,768 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,768 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,770 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,782 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,784 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,785 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,785 - sqlalchemy.engine.Engine - INFO - [cached since 17.43s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,788 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,788 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,790 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,796 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,799 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,799 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,802 - sqlalchemy.engine.Engine - INFO - [cached since 17.45s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,804 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,804 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,806 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,808 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:57:57,808 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:57,810 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,812 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:57,814 - sqlalchemy.engine.Engine - INFO - [cached since 17.41s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:57,815 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:57,817 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,820 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,821 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,822 - sqlalchemy.engine.Engine - INFO - [cached since 17.47s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,824 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,824 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,828 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,848 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.status = %(status_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:57:57,851 - sqlalchemy.engine.Engine - INFO - [generated in 0.00254s] {'restaurant_id_1': 1, 'status_1': 'PENDING', 'param_1': 0, 'param_2': 200}
2025-10-20 00:57:57,863 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:57,865 - sqlalchemy.engine.Engine - INFO - [cached since 17.14s ago] {'pk_1': 16}
2025-10-20 00:57:57,868 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:57:57,869 - sqlalchemy.engine.Engine - INFO - [cached since 17.15s ago] {'pk_1': 9}
2025-10-20 00:57:57,876 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,878 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,882 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,882 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,890 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,896 - sqlalchemy.engine.Engine - INFO - [cached since 17.54s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,904 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,904 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,906 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,912 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,913 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,915 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,916 - sqlalchemy.engine.Engine - INFO - [cached since 17.56s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,918 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,919 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,921 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,925 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,928 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,929 - sqlalchemy.engine.Engine - INFO - [cached since 17.58s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,932 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,932 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,934 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,938 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,940 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,941 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,943 - sqlalchemy.engine.Engine - INFO - [cached since 17.59s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,945 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,946 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,948 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:57:57,950 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:57:57,951 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:57:57,953 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,955 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:57:57,955 - sqlalchemy.engine.Engine - INFO - [cached since 17.55s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:57:57,958 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:57:57,960 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:57:57,961 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,963 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:57:57,965 - sqlalchemy.engine.Engine - INFO - [cached since 17.61s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:57:57,967 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:57:57,968 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,973 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:57:57,977 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.status = %(status_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:57:57,979 - sqlalchemy.engine.Engine - INFO - [cached since 0.1303s ago] {'restaurant_id_1': 1, 'status_1': 'PREPARING', 'param_1': 0, 'param_2': 200}
2025-10-20 00:57:57,991 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:57:57,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:01,689 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:01,690 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:01,691 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:01,692 - sqlalchemy.engine.Engine - INFO - [cached since 21.34s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:01,693 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:01,695 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:01,695 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:01,704 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:01,706 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:01,706 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:01,708 - sqlalchemy.engine.Engine - INFO - [cached since 21.36s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:01,709 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:01,710 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:01,710 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:01,712 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:01,712 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:01,713 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:01,717 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:01,717 - sqlalchemy.engine.Engine - INFO - [cached since 21.31s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:01,720 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:01,723 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:01,723 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:01,725 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:01,726 - sqlalchemy.engine.Engine - INFO - [cached since 21.37s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:01,728 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:01,729 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:01,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:01,734 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:01,737 - sqlalchemy.engine.Engine - INFO - [cached since 21.07s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:01,767 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,769 - sqlalchemy.engine.Engine - INFO - [cached since 21.05s ago] {'pk_1': 16}
2025-10-20 00:58:01,772 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,773 - sqlalchemy.engine.Engine - INFO - [cached since 21.05s ago] {'pk_1': 9}
2025-10-20 00:58:01,777 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,777 - sqlalchemy.engine.Engine - INFO - [cached since 21.05s ago] {'pk_1': 15}
2025-10-20 00:58:01,781 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,782 - sqlalchemy.engine.Engine - INFO - [cached since 21.06s ago] {'pk_1': 13}
2025-10-20 00:58:01,785 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,786 - sqlalchemy.engine.Engine - INFO - [cached since 21.06s ago] {'pk_1': 14}
2025-10-20 00:58:01,790 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,791 - sqlalchemy.engine.Engine - INFO - [cached since 21.07s ago] {'pk_1': 18}
2025-10-20 00:58:01,792 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,794 - sqlalchemy.engine.Engine - INFO - [cached since 21.07s ago] {'pk_1': 21}
2025-10-20 00:58:01,797 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,797 - sqlalchemy.engine.Engine - INFO - [cached since 21.07s ago] {'pk_1': 19}
2025-10-20 00:58:01,800 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,801 - sqlalchemy.engine.Engine - INFO - [cached since 21.08s ago] {'pk_1': 22}
2025-10-20 00:58:01,805 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,805 - sqlalchemy.engine.Engine - INFO - [cached since 21.08s ago] {'pk_1': 7}
2025-10-20 00:58:01,809 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,817 - sqlalchemy.engine.Engine - INFO - [cached since 21.09s ago] {'pk_1': 5}
2025-10-20 00:58:01,822 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,825 - sqlalchemy.engine.Engine - INFO - [cached since 21.1s ago] {'pk_1': 6}
2025-10-20 00:58:01,828 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:01,829 - sqlalchemy.engine.Engine - INFO - [cached since 21.11s ago] {'pk_1': 8}
2025-10-20 00:58:01,843 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:01,846 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:09,998 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:10,000 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:10,002 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:10,004 - sqlalchemy.engine.Engine - INFO - [cached since 29.65s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:10,007 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:10,008 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:10,011 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:10,023 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:10,025 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:10,031 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:10,032 - sqlalchemy.engine.Engine - INFO - [cached since 29.68s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:10,037 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:10,037 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:10,040 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:10,044 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:10,045 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:10,047 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:10,049 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:10,050 - sqlalchemy.engine.Engine - INFO - [cached since 29.64s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:10,054 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:10,057 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:10,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:10,061 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:10,062 - sqlalchemy.engine.Engine - INFO - [cached since 29.71s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:10,067 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:10,068 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:10,096 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:10,107 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.menu_items_name AS anon_1_menu_items_name, anon_1.menu_items_description AS anon_1_menu_items_description, anon_1.menu_items_price AS anon_1_menu_items_price, anon_1.menu_items_discount_price AS anon_1_menu_items_discount_price, anon_1.menu_items_category_id AS anon_1_menu_items_category_id, anon_1.menu_items_is_available AS anon_1_menu_items_is_available, anon_1.menu_items_image_url AS anon_1_menu_items_image_url, anon_1.menu_items_ingredients AS anon_1_menu_items_ingredients, anon_1.menu_items_restaurant_id AS anon_1_menu_items_restaurant_id, anon_1.menu_items_id AS anon_1_menu_items_id, anon_1.menu_items_created_at AS anon_1_menu_items_created_at, anon_1.menu_items_updated_at AS anon_1_menu_items_updated_at, anon_1.menu_items_deleted_at AS anon_1_menu_items_deleted_at, anon_1.categories_name AS anon_1_categories_name, categories_1.id AS categories_1_id, categories_1.name AS categories_1_name, categories_1.description AS categories_1_description, categories_1.restaurant_id AS categories_1_restaurant_id, categories_1.created_at AS categories_1_created_at, categories_1.updated_at AS categories_1_updated_at, categories_1.deleted_at AS categories_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at, categories.name AS categories_name 
FROM menu_items INNER JOIN categories ON categories.id = menu_items.category_id 
WHERE menu_items.deleted_at IS NULL AND menu_items.restaurant_id = %(restaurant_id_1)s ORDER BY categories.name ASC, menu_items.name ASC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN categories AS categories_1 ON categories_1.id = anon_1.menu_items_category_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON anon_1.menu_items_id = menu_item_variants_1.menu_item_id AND menu_item_variants_1.deleted_at IS NULL ORDER BY anon_1.categories_name ASC, anon_1.menu_items_name ASC
2025-10-20 00:58:10,120 - sqlalchemy.engine.Engine - INFO - [cached since 15.33s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 100}
2025-10-20 00:58:10,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:10,191 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:12,456 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:12,458 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:12,460 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:12,462 - sqlalchemy.engine.Engine - INFO - [cached since 32.11s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:12,466 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:12,466 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:12,469 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:12,475 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:12,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:12,479 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:12,481 - sqlalchemy.engine.Engine - INFO - [cached since 32.13s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:12,491 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:12,493 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:12,502 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:12,533 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:12,536 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:12,538 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:12,541 - sqlalchemy.engine.Engine - INFO - [cached since 32.19s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:12,545 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:12,545 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:12,548 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:12,573 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:12,575 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:12,578 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:12,579 - sqlalchemy.engine.Engine - INFO - [cached since 32.23s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:12,582 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:12,582 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:12,585 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:12,587 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:12,589 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:12,589 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:12,592 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:12,594 - sqlalchemy.engine.Engine - INFO - [cached since 32.19s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:12,596 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:12,598 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:12,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:12,603 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:12,605 - sqlalchemy.engine.Engine - INFO - [cached since 32.25s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:12,608 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:12,608 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:12,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:12,615 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:12,619 - sqlalchemy.engine.Engine - INFO - [cached since 31.95s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:12,656 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,657 - sqlalchemy.engine.Engine - INFO - [cached since 31.93s ago] {'pk_1': 16}
2025-10-20 00:58:12,662 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,663 - sqlalchemy.engine.Engine - INFO - [cached since 31.94s ago] {'pk_1': 9}
2025-10-20 00:58:12,668 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,669 - sqlalchemy.engine.Engine - INFO - [cached since 31.95s ago] {'pk_1': 15}
2025-10-20 00:58:12,674 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,675 - sqlalchemy.engine.Engine - INFO - [cached since 31.95s ago] {'pk_1': 13}
2025-10-20 00:58:12,680 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,683 - sqlalchemy.engine.Engine - INFO - [cached since 31.96s ago] {'pk_1': 14}
2025-10-20 00:58:12,688 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,690 - sqlalchemy.engine.Engine - INFO - [cached since 31.97s ago] {'pk_1': 18}
2025-10-20 00:58:12,693 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,694 - sqlalchemy.engine.Engine - INFO - [cached since 31.97s ago] {'pk_1': 21}
2025-10-20 00:58:12,698 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,698 - sqlalchemy.engine.Engine - INFO - [cached since 31.98s ago] {'pk_1': 19}
2025-10-20 00:58:12,704 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,705 - sqlalchemy.engine.Engine - INFO - [cached since 31.98s ago] {'pk_1': 22}
2025-10-20 00:58:12,709 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,712 - sqlalchemy.engine.Engine - INFO - [cached since 31.99s ago] {'pk_1': 7}
2025-10-20 00:58:12,715 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,718 - sqlalchemy.engine.Engine - INFO - [cached since 31.99s ago] {'pk_1': 5}
2025-10-20 00:58:12,723 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,724 - sqlalchemy.engine.Engine - INFO - [cached since 32s ago] {'pk_1': 6}
2025-10-20 00:58:12,728 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:12,729 - sqlalchemy.engine.Engine - INFO - [cached since 32.01s ago] {'pk_1': 8}
2025-10-20 00:58:12,750 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:12,753 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,052 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:14,054 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,056 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:14,057 - sqlalchemy.engine.Engine - INFO - [cached since 33.71s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:14,059 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:14,060 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,068 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:14,069 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:14,071 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:14,072 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,073 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:14,074 - sqlalchemy.engine.Engine - INFO - [cached since 33.67s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:14,075 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:14,082 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:14,087 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,092 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:14,095 - sqlalchemy.engine.Engine - INFO - [cached since 33.74s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:14,098 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:14,098 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,101 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,102 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:58:14,104 - sqlalchemy.engine.Engine - INFO - [cached since 33.64s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:58:14,108 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_subscriptions.restaurant_id AS restaurant_subscriptions_restaurant_id, restaurant_subscriptions.plan_id AS restaurant_subscriptions_plan_id, restaurant_subscriptions.status AS restaurant_subscriptions_status, restaurant_subscriptions.billing_cycle AS restaurant_subscriptions_billing_cycle, restaurant_subscriptions.start_date AS restaurant_subscriptions_start_date, restaurant_subscriptions.trial_end_date AS restaurant_subscriptions_trial_end_date, restaurant_subscriptions.current_period_start AS restaurant_subscriptions_current_period_start, restaurant_subscriptions.current_period_end AS restaurant_subscriptions_current_period_end, restaurant_subscriptions.cancelled_at AS restaurant_subscriptions_cancelled_at, restaurant_subscriptions.base_price AS restaurant_subscriptions_base_price, restaurant_subscriptions.total_price AS restaurant_subscriptions_total_price, restaurant_subscriptions.discount_percentage AS restaurant_subscriptions_discount_percentage, restaurant_subscriptions.discount_amount AS restaurant_subscriptions_discount_amount, restaurant_subscriptions.discount_code AS restaurant_subscriptions_discount_code, restaurant_subscriptions.auto_renew AS restaurant_subscriptions_auto_renew, restaurant_subscriptions.subscription_metadata AS restaurant_subscriptions_subscription_metadata, restaurant_subscriptions.id AS restaurant_subscriptions_id, restaurant_subscriptions.created_at AS restaurant_subscriptions_created_at, restaurant_subscriptions.updated_at AS restaurant_subscriptions_updated_at, restaurant_subscriptions.deleted_at AS restaurant_subscriptions_deleted_at 
FROM restaurant_subscriptions 
WHERE restaurant_subscriptions.restaurant_id = %(restaurant_id_1)s AND restaurant_subscriptions.status IN (%(status_1_1)s, %(status_1_2)s) 
 LIMIT %(param_1)s
2025-10-20 00:58:14,110 - sqlalchemy.engine.Engine - INFO - [cached since 33.64s ago] {'restaurant_id_1': 1, 'param_1': 1, 'status_1_1': 'trial', 'status_1_2': 'active'}
2025-10-20 00:58:14,114 - sqlalchemy.engine.Engine - INFO - SELECT subscription_plans.name AS subscription_plans_name, subscription_plans.tier AS subscription_plans_tier, subscription_plans.display_name AS subscription_plans_display_name, subscription_plans.description AS subscription_plans_description, subscription_plans.monthly_price AS subscription_plans_monthly_price, subscription_plans.annual_price AS subscription_plans_annual_price, subscription_plans.max_admin_users AS subscription_plans_max_admin_users, subscription_plans.max_waiter_users AS subscription_plans_max_waiter_users, subscription_plans.max_cashier_users AS subscription_plans_max_cashier_users, subscription_plans.max_kitchen_users AS subscription_plans_max_kitchen_users, subscription_plans.max_owner_users AS subscription_plans_max_owner_users, subscription_plans.max_tables AS subscription_plans_max_tables, subscription_plans.max_menu_items AS subscription_plans_max_menu_items, subscription_plans.max_categories AS subscription_plans_max_categories, subscription_plans.has_kitchen_module AS subscription_plans_has_kitchen_module, subscription_plans.has_ingredients_module AS subscription_plans_has_ingredients_module, subscription_plans.has_inventory_module AS subscription_plans_has_inventory_module, subscription_plans.has_advanced_reports AS subscription_plans_has_advanced_reports, subscription_plans.has_multi_branch AS subscription_plans_has_multi_branch, subscription_plans.has_priority_support AS subscription_plans_has_priority_support, subscription_plans.report_retention_days AS subscription_plans_report_retention_days, subscription_plans.support_hours_monthly AS subscription_plans_support_hours_monthly, subscription_plans.is_trial AS subscription_plans_is_trial, subscription_plans.trial_duration_days AS subscription_plans_trial_duration_days, subscription_plans.is_popular AS subscription_plans_is_popular, subscription_plans.is_active AS subscription_plans_is_active, subscription_plans.sort_order AS subscription_plans_sort_order, subscription_plans.features AS subscription_plans_features, subscription_plans.id AS subscription_plans_id, subscription_plans.created_at AS subscription_plans_created_at, subscription_plans.updated_at AS subscription_plans_updated_at, subscription_plans.deleted_at AS subscription_plans_deleted_at 
FROM subscription_plans 
WHERE subscription_plans.id = %(pk_1)s
2025-10-20 00:58:14,116 - sqlalchemy.engine.Engine - INFO - [cached since 33.6s ago] {'pk_1': 4}
2025-10-20 00:58:14,120 - sqlalchemy.engine.Engine - INFO - SELECT restaurant_addons.subscription_id AS restaurant_addons_subscription_id, restaurant_addons.addon_id AS restaurant_addons_addon_id, restaurant_addons.quantity AS restaurant_addons_quantity, restaurant_addons.unit_price AS restaurant_addons_unit_price, restaurant_addons.total_price AS restaurant_addons_total_price, restaurant_addons.is_active AS restaurant_addons_is_active, restaurant_addons.addon_metadata AS restaurant_addons_addon_metadata, restaurant_addons.id AS restaurant_addons_id, restaurant_addons.created_at AS restaurant_addons_created_at, restaurant_addons.updated_at AS restaurant_addons_updated_at, restaurant_addons.deleted_at AS restaurant_addons_deleted_at 
FROM restaurant_addons 
WHERE %(param_1)s = restaurant_addons.subscription_id
2025-10-20 00:58:14,121 - sqlalchemy.engine.Engine - INFO - [cached since 33.58s ago] {'param_1': 12}
2025-10-20 00:58:14,126 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:58:14,128 - sqlalchemy.engine.Engine - INFO - [cached since 33.57s ago] {'restaurant_id_1': 1, 'role_1': 'admin'}
2025-10-20 00:58:14,131 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:58:14,132 - sqlalchemy.engine.Engine - INFO - [cached since 33.57s ago] {'restaurant_id_1': 1, 'role_1': 'waiter'}
2025-10-20 00:58:14,135 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:58:14,137 - sqlalchemy.engine.Engine - INFO - [cached since 33.58s ago] {'restaurant_id_1': 1, 'role_1': 'cashier'}
2025-10-20 00:58:14,140 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:58:14,142 - sqlalchemy.engine.Engine - INFO - [cached since 33.58s ago] {'restaurant_id_1': 1, 'role_1': 'kitchen'}
2025-10-20 00:58:14,144 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.restaurant_id = %(restaurant_id_1)s AND users.`role` = %(role_1)s AND users.deleted_at IS NULL) AS anon_1
2025-10-20 00:58:14,146 - sqlalchemy.engine.Engine - INFO - [cached since 33.59s ago] {'restaurant_id_1': 1, 'role_1': 'owner'}
2025-10-20 00:58:14,149 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.restaurant_id = %(restaurant_id_1)s AND tables.deleted_at IS NULL) AS anon_1
2025-10-20 00:58:14,149 - sqlalchemy.engine.Engine - INFO - [cached since 33.54s ago] {'restaurant_id_1': 1}
2025-10-20 00:58:14,152 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.restaurant_id = %(restaurant_id_1)s AND menu_items.deleted_at IS NULL) AS anon_1
2025-10-20 00:58:14,154 - sqlalchemy.engine.Engine - INFO - [cached since 33.53s ago] {'restaurant_id_1': 1}
2025-10-20 00:58:14,157 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.restaurant_id = %(restaurant_id_1)s AND categories.deleted_at IS NULL) AS anon_1
2025-10-20 00:58:14,160 - sqlalchemy.engine.Engine - INFO - [cached since 33.48s ago] {'restaurant_id_1': 1}
2025-10-20 00:58:14,164 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,166 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,182 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:14,184 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,185 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:14,185 - sqlalchemy.engine.Engine - INFO - [cached since 33.83s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:14,187 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:14,187 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,187 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:14,194 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:14,196 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,196 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:14,198 - sqlalchemy.engine.Engine - INFO - [cached since 33.85s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:14,199 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:14,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,201 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:14,201 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:14,202 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:14,204 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,205 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:14,205 - sqlalchemy.engine.Engine - INFO - [cached since 33.8s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:14,208 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:14,211 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:14,212 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,214 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:14,215 - sqlalchemy.engine.Engine - INFO - [cached since 33.86s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:14,218 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:14,218 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,223 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.status = %(status_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:14,225 - sqlalchemy.engine.Engine - INFO - [cached since 16.38s ago] {'restaurant_id_1': 1, 'status_1': 'PENDING', 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:14,235 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:14,235 - sqlalchemy.engine.Engine - INFO - [cached since 33.51s ago] {'pk_1': 16}
2025-10-20 00:58:14,238 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:14,240 - sqlalchemy.engine.Engine - INFO - [cached since 33.52s ago] {'pk_1': 9}
2025-10-20 00:58:14,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,249 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,252 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:14,254 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,255 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:14,256 - sqlalchemy.engine.Engine - INFO - [cached since 33.9s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:14,257 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:14,258 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,259 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:14,267 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:14,268 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,270 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:14,270 - sqlalchemy.engine.Engine - INFO - [cached since 33.92s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:14,272 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:14,272 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,275 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:14,277 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:14,277 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:14,278 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,279 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:14,280 - sqlalchemy.engine.Engine - INFO - [cached since 33.87s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:14,282 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:14,284 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:14,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,285 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:14,288 - sqlalchemy.engine.Engine - INFO - [cached since 33.94s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:14,289 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:14,290 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,294 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:14,298 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.status = %(status_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:14,300 - sqlalchemy.engine.Engine - INFO - [cached since 16.45s ago] {'restaurant_id_1': 1, 'status_1': 'PREPARING', 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:14,309 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:14,311 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,275 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:15,278 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,280 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:15,281 - sqlalchemy.engine.Engine - INFO - [cached since 34.93s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:15,284 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:15,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,285 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:15,290 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:15,291 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,294 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:15,295 - sqlalchemy.engine.Engine - INFO - [cached since 34.94s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:15,298 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:15,298 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,299 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:15,303 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:15,303 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:15,305 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,305 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:15,307 - sqlalchemy.engine.Engine - INFO - [cached since 34.9s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:15,309 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:15,313 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,316 - sqlalchemy.engine.Engine - INFO - SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:15,317 - sqlalchemy.engine.Engine - INFO - [generated in 0.00115s] {'id_1': 60, 'param_1': 1}
2025-10-20 00:58:15,329 - sqlalchemy.engine.Engine - INFO - UPDATE orders SET status=%(status)s, updated_at=%(updated_at)s WHERE orders.id = %(orders_id)s
2025-10-20 00:58:15,330 - sqlalchemy.engine.Engine - INFO - [generated in 0.00172s] {'status': 'PREPARING', 'updated_at': datetime.datetime(2025, 10, 20, 7, 58, 15, 322086, tzinfo=datetime.timezone.utc), 'orders_id': 60}
2025-10-20 00:58:15,335 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-20 00:58:15,341 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,345 - sqlalchemy.engine.Engine - INFO - SELECT orders.id, orders.table_id, orders.customer_name, orders.order_type, orders.status, orders.notes, orders.total_amount, orders.user_id, orders.is_paid, orders.payment_method, orders.deleted_at, orders.restaurant_id, orders.created_at, orders.updated_at 
FROM orders 
WHERE orders.id = %(pk_1)s
2025-10-20 00:58:15,346 - sqlalchemy.engine.Engine - INFO - [generated in 0.00170s] {'pk_1': 60}
2025-10-20 00:58:15,351 - sqlalchemy.engine.Engine - INFO - SELECT tables.number AS tables_number, tables.capacity AS tables_capacity, tables.location AS tables_location, tables.is_occupied AS tables_is_occupied, tables.restaurant_id AS tables_restaurant_id, tables.id AS tables_id, tables.created_at AS tables_created_at, tables.updated_at AS tables_updated_at, tables.deleted_at AS tables_deleted_at 
FROM tables 
WHERE tables.id = %(pk_1)s
2025-10-20 00:58:15,352 - sqlalchemy.engine.Engine - INFO - [generated in 0.00151s] {'pk_1': 6}
2025-10-20 00:58:15,358 - sqlalchemy.engine.Engine - INFO - SELECT order_items.id AS order_items_id, order_items.order_id AS order_items_order_id, order_items.menu_item_id AS order_items_menu_item_id, order_items.variant_id AS order_items_variant_id, order_items.quantity AS order_items_quantity, order_items.unit_price AS order_items_unit_price, order_items.special_instructions AS order_items_special_instructions, order_items.status AS order_items_status, order_items.deleted_at AS order_items_deleted_at, order_items.created_at AS order_items_created_at, order_items.updated_at AS order_items_updated_at 
FROM order_items 
WHERE %(param_1)s = order_items.order_id
2025-10-20 00:58:15,360 - sqlalchemy.engine.Engine - INFO - [generated in 0.00171s] {'param_1': 60}
2025-10-20 00:58:15,366 - sqlalchemy.engine.Engine - INFO - SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.id = %(pk_1)s
2025-10-20 00:58:15,367 - sqlalchemy.engine.Engine - INFO - [generated in 0.00159s] {'pk_1': 32}
2025-10-20 00:58:15,370 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:15,372 - sqlalchemy.engine.Engine - INFO - [generated in 0.00194s] {'pk_1': 16}
2025-10-20 00:58:15,378 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,380 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,384 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:15,385 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,386 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:15,387 - sqlalchemy.engine.Engine - INFO - [cached since 35.04s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:15,390 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:15,391 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,393 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:15,403 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:15,405 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,405 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:15,406 - sqlalchemy.engine.Engine - INFO - [cached since 35.06s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:15,409 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:15,409 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,411 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:15,413 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:15,413 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:15,414 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,416 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:15,423 - sqlalchemy.engine.Engine - INFO - [cached since 35.02s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:15,438 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:15,438 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:15,441 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,442 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:15,443 - sqlalchemy.engine.Engine - INFO - [cached since 35.09s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:15,446 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:15,447 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,450 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,452 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.status = %(status_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:15,455 - sqlalchemy.engine.Engine - INFO - [cached since 17.61s ago] {'restaurant_id_1': 1, 'status_1': 'PENDING', 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:15,465 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:15,465 - sqlalchemy.engine.Engine - INFO - [cached since 34.74s ago] {'pk_1': 16}
2025-10-20 00:58:15,470 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:15,471 - sqlalchemy.engine.Engine - INFO - [cached since 34.75s ago] {'pk_1': 9}
2025-10-20 00:58:15,477 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,480 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,484 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:15,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,487 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:15,488 - sqlalchemy.engine.Engine - INFO - [cached since 35.14s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:15,490 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:15,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,493 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:15,500 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:15,502 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,504 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:15,505 - sqlalchemy.engine.Engine - INFO - [cached since 35.15s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:15,507 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:15,508 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,509 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:15,512 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:15,513 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:15,515 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,516 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:15,517 - sqlalchemy.engine.Engine - INFO - [cached since 35.11s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:15,519 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:15,521 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:15,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,523 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:15,523 - sqlalchemy.engine.Engine - INFO - [cached since 35.17s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:15,525 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:15,526 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,529 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:15,530 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.status = %(status_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:15,533 - sqlalchemy.engine.Engine - INFO - [cached since 17.68s ago] {'restaurant_id_1': 1, 'status_1': 'PREPARING', 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:15,539 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:15,542 - sqlalchemy.engine.Engine - INFO - [cached since 34.82s ago] {'pk_1': 16}
2025-10-20 00:58:15,548 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:15,550 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:16,992 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:16,994 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:16,995 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:16,996 - sqlalchemy.engine.Engine - INFO - [cached since 36.64s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:16,998 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:16,998 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:16,999 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:17,004 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:17,005 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,006 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:17,007 - sqlalchemy.engine.Engine - INFO - [cached since 36.66s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:17,010 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:17,010 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,012 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:17,015 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:17,016 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:17,017 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,017 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:17,018 - sqlalchemy.engine.Engine - INFO - [cached since 36.61s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:17,020 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:17,022 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,023 - sqlalchemy.engine.Engine - INFO - SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:17,025 - sqlalchemy.engine.Engine - INFO - [cached since 1.709s ago] {'id_1': 59, 'param_1': 1}
2025-10-20 00:58:17,030 - sqlalchemy.engine.Engine - INFO - UPDATE orders SET status=%(status)s, updated_at=%(updated_at)s WHERE orders.id = %(orders_id)s
2025-10-20 00:58:17,030 - sqlalchemy.engine.Engine - INFO - [cached since 1.702s ago] {'status': 'PREPARING', 'updated_at': datetime.datetime(2025, 10, 20, 7, 58, 17, 28707, tzinfo=datetime.timezone.utc), 'orders_id': 59}
2025-10-20 00:58:17,032 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-10-20 00:58:17,041 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,042 - sqlalchemy.engine.Engine - INFO - SELECT orders.id, orders.table_id, orders.customer_name, orders.order_type, orders.status, orders.notes, orders.total_amount, orders.user_id, orders.is_paid, orders.payment_method, orders.deleted_at, orders.restaurant_id, orders.created_at, orders.updated_at 
FROM orders 
WHERE orders.id = %(pk_1)s
2025-10-20 00:58:17,044 - sqlalchemy.engine.Engine - INFO - [cached since 1.699s ago] {'pk_1': 59}
2025-10-20 00:58:17,049 - sqlalchemy.engine.Engine - INFO - SELECT order_items.id AS order_items_id, order_items.order_id AS order_items_order_id, order_items.menu_item_id AS order_items_menu_item_id, order_items.variant_id AS order_items_variant_id, order_items.quantity AS order_items_quantity, order_items.unit_price AS order_items_unit_price, order_items.special_instructions AS order_items_special_instructions, order_items.status AS order_items_status, order_items.deleted_at AS order_items_deleted_at, order_items.created_at AS order_items_created_at, order_items.updated_at AS order_items_updated_at 
FROM order_items 
WHERE %(param_1)s = order_items.order_id
2025-10-20 00:58:17,050 - sqlalchemy.engine.Engine - INFO - [cached since 1.691s ago] {'param_1': 59}
2025-10-20 00:58:17,055 - sqlalchemy.engine.Engine - INFO - SELECT menu_item_variants.menu_item_id AS menu_item_variants_menu_item_id, menu_item_variants.name AS menu_item_variants_name, menu_item_variants.price AS menu_item_variants_price, menu_item_variants.discount_price AS menu_item_variants_discount_price, menu_item_variants.is_available AS menu_item_variants_is_available, menu_item_variants.id AS menu_item_variants_id, menu_item_variants.created_at AS menu_item_variants_created_at, menu_item_variants.updated_at AS menu_item_variants_updated_at, menu_item_variants.deleted_at AS menu_item_variants_deleted_at 
FROM menu_item_variants 
WHERE menu_item_variants.id = %(pk_1)s
2025-10-20 00:58:17,056 - sqlalchemy.engine.Engine - INFO - [generated in 0.00156s] {'pk_1': 68}
2025-10-20 00:58:17,060 - sqlalchemy.engine.Engine - INFO - SELECT menu_items.name AS menu_items_name, menu_items.description AS menu_items_description, menu_items.price AS menu_items_price, menu_items.discount_price AS menu_items_discount_price, menu_items.category_id AS menu_items_category_id, menu_items.is_available AS menu_items_is_available, menu_items.image_url AS menu_items_image_url, menu_items.ingredients AS menu_items_ingredients, menu_items.restaurant_id AS menu_items_restaurant_id, menu_items.id AS menu_items_id, menu_items.created_at AS menu_items_created_at, menu_items.updated_at AS menu_items_updated_at, menu_items.deleted_at AS menu_items_deleted_at 
FROM menu_items 
WHERE menu_items.id = %(pk_1)s
2025-10-20 00:58:17,061 - sqlalchemy.engine.Engine - INFO - [cached since 1.696s ago] {'pk_1': 12}
2025-10-20 00:58:17,065 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:17,066 - sqlalchemy.engine.Engine - INFO - [cached since 1.697s ago] {'pk_1': 9}
2025-10-20 00:58:17,073 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,076 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,079 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:17,080 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,081 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:17,083 - sqlalchemy.engine.Engine - INFO - [cached since 36.73s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:17,085 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:17,086 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,088 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:17,094 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:17,095 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,097 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:17,098 - sqlalchemy.engine.Engine - INFO - [cached since 36.75s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:17,101 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:17,102 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,104 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:17,106 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:17,106 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:17,127 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,133 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:17,134 - sqlalchemy.engine.Engine - INFO - [cached since 36.73s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:17,136 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:17,138 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:17,140 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,140 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:17,141 - sqlalchemy.engine.Engine - INFO - [cached since 36.79s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:17,144 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:17,145 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,150 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.status = %(status_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:17,151 - sqlalchemy.engine.Engine - INFO - [cached since 19.3s ago] {'restaurant_id_1': 1, 'status_1': 'PENDING', 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:17,267 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:17,269 - sqlalchemy.engine.Engine - INFO - [cached since 36.55s ago] {'pk_1': 16}
2025-10-20 00:58:17,273 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:17,275 - sqlalchemy.engine.Engine - INFO - [cached since 36.55s ago] {'pk_1': 9}
2025-10-20 00:58:17,282 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,287 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:17,288 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,290 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:17,290 - sqlalchemy.engine.Engine - INFO - [cached since 36.94s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:17,292 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:17,292 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,293 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:17,301 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:17,302 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,305 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:17,305 - sqlalchemy.engine.Engine - INFO - [cached since 36.95s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:17,308 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:17,309 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,310 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:17,312 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:17,313 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:17,313 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,315 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:17,316 - sqlalchemy.engine.Engine - INFO - [cached since 36.91s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:17,319 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:17,321 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:17,323 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,325 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:17,326 - sqlalchemy.engine.Engine - INFO - [cached since 36.97s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:17,329 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:17,329 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,332 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:17,334 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.status = %(status_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:17,337 - sqlalchemy.engine.Engine - INFO - [cached since 19.49s ago] {'restaurant_id_1': 1, 'status_1': 'PREPARING', 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:17,344 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:17,346 - sqlalchemy.engine.Engine - INFO - [cached since 36.62s ago] {'pk_1': 16}
2025-10-20 00:58:17,348 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:17,349 - sqlalchemy.engine.Engine - INFO - [cached since 36.63s ago] {'pk_1': 9}
2025-10-20 00:58:17,356 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:17,357 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:19,970 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:19,971 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:19,972 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:19,974 - sqlalchemy.engine.Engine - INFO - [cached since 39.62s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:19,976 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:19,976 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:19,977 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:19,985 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:19,987 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:19,989 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:19,990 - sqlalchemy.engine.Engine - INFO - [cached since 39.64s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:19,994 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:19,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:19,997 - app.middleware.restaurant - DEBUG - Restaurant context set: Default Restaurant
2025-10-20 00:58:19,999 - app.services.user - DEBUG - Decoding token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjA5OTUwNzMsInN1YiI6IjkiLCJzY29wZXMiOlsicmVhZDppdGVtcyIsIndyaXRlOml0ZW1zIiwicmVhZDpvcmRlcnMiLCJ3cml0ZTpvcmRlcnMiXSwidHlwZSI6ImFjY2VzcyJ9.-Z7ZgPImgVVoiIYABLUVcw9nefNiMjIC5mbHFmhf070
2025-10-20 00:58:19,999 - app.services.user - DEBUG - Decoded payload: {'exp': 1760995073, 'sub': '9', 'scopes': ['read:items', 'write:items', 'read:orders', 'write:orders'], 'type': 'access'}
2025-10-20 00:58:20,000 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:20,001 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.hashed_password AS users_hashed_password, users.full_name AS users_full_name, users.`role` AS users_role, users.staff_type AS users_staff_type, users.is_active AS users_is_active, users.restaurant_id AS users_restaurant_id, users.id AS users_id, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-10-20 00:58:20,003 - sqlalchemy.engine.Engine - INFO - [cached since 39.6s ago] {'id_1': 9, 'param_1': 1}
2025-10-20 00:58:20,005 - app.services.user - DEBUG - Found user: cocinero-default@shopacoffee.com with role: UserRole.STAFF
2025-10-20 00:58:20,007 - app.middleware.restaurant - DEBUG - Resolved subdomain from header (Origin): default
2025-10-20 00:58:20,010 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:20,012 - sqlalchemy.engine.Engine - INFO - SELECT restaurants.name AS restaurants_name, restaurants.subdomain AS restaurants_subdomain, restaurants.description AS restaurants_description, restaurants.address AS restaurants_address, restaurants.phone AS restaurants_phone, restaurants.email AS restaurants_email, restaurants.logo_url AS restaurants_logo_url, restaurants.is_active AS restaurants_is_active, restaurants.timezone AS restaurants_timezone, restaurants.currency AS restaurants_currency, restaurants.tax_rate AS restaurants_tax_rate, restaurants.id AS restaurants_id, restaurants.created_at AS restaurants_created_at, restaurants.updated_at AS restaurants_updated_at, restaurants.deleted_at AS restaurants_deleted_at 
FROM restaurants 
WHERE restaurants.subdomain = %(subdomain_1)s AND restaurants.is_active = true 
 LIMIT %(param_1)s
2025-10-20 00:58:20,014 - sqlalchemy.engine.Engine - INFO - [cached since 39.66s ago] {'subdomain_1': 'default', 'param_1': 1}
2025-10-20 00:58:20,015 - app.middleware.restaurant - DEBUG - Found restaurant: Default Restaurant (subdomain: default)
2025-10-20 00:58:20,016 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:20,019 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-10-20 00:58:20,021 - sqlalchemy.engine.Engine - INFO - SELECT anon_1.orders_id AS anon_1_orders_id, anon_1.orders_table_id AS anon_1_orders_table_id, anon_1.orders_customer_name AS anon_1_orders_customer_name, anon_1.orders_order_type AS anon_1_orders_order_type, anon_1.orders_status AS anon_1_orders_status, anon_1.orders_notes AS anon_1_orders_notes, anon_1.orders_total_amount AS anon_1_orders_total_amount, anon_1.orders_user_id AS anon_1_orders_user_id, anon_1.orders_is_paid AS anon_1_orders_is_paid, anon_1.orders_payment_method AS anon_1_orders_payment_method, anon_1.orders_deleted_at AS anon_1_orders_deleted_at, anon_1.orders_restaurant_id AS anon_1_orders_restaurant_id, anon_1.orders_created_at AS anon_1_orders_created_at, anon_1.orders_updated_at AS anon_1_orders_updated_at, tables_1.number AS tables_1_number, tables_1.capacity AS tables_1_capacity, tables_1.location AS tables_1_location, tables_1.is_occupied AS tables_1_is_occupied, tables_1.restaurant_id AS tables_1_restaurant_id, tables_1.id AS tables_1_id, tables_1.created_at AS tables_1_created_at, tables_1.updated_at AS tables_1_updated_at, tables_1.deleted_at AS tables_1_deleted_at, menu_items_1.name AS menu_items_1_name, menu_items_1.description AS menu_items_1_description, menu_items_1.price AS menu_items_1_price, menu_items_1.discount_price AS menu_items_1_discount_price, menu_items_1.category_id AS menu_items_1_category_id, menu_items_1.is_available AS menu_items_1_is_available, menu_items_1.image_url AS menu_items_1_image_url, menu_items_1.ingredients AS menu_items_1_ingredients, menu_items_1.restaurant_id AS menu_items_1_restaurant_id, menu_items_1.id AS menu_items_1_id, menu_items_1.created_at AS menu_items_1_created_at, menu_items_1.updated_at AS menu_items_1_updated_at, menu_items_1.deleted_at AS menu_items_1_deleted_at, menu_item_variants_1.menu_item_id AS menu_item_variants_1_menu_item_id, menu_item_variants_1.name AS menu_item_variants_1_name, menu_item_variants_1.price AS menu_item_variants_1_price, menu_item_variants_1.discount_price AS menu_item_variants_1_discount_price, menu_item_variants_1.is_available AS menu_item_variants_1_is_available, menu_item_variants_1.id AS menu_item_variants_1_id, menu_item_variants_1.created_at AS menu_item_variants_1_created_at, menu_item_variants_1.updated_at AS menu_item_variants_1_updated_at, menu_item_variants_1.deleted_at AS menu_item_variants_1_deleted_at, order_items_1.id AS order_items_1_id, order_items_1.order_id AS order_items_1_order_id, order_items_1.menu_item_id AS order_items_1_menu_item_id, order_items_1.variant_id AS order_items_1_variant_id, order_items_1.quantity AS order_items_1_quantity, order_items_1.unit_price AS order_items_1_unit_price, order_items_1.special_instructions AS order_items_1_special_instructions, order_items_1.status AS order_items_1_status, order_items_1.deleted_at AS order_items_1_deleted_at, order_items_1.created_at AS order_items_1_created_at, order_items_1.updated_at AS order_items_1_updated_at, users_1.email AS users_1_email, users_1.hashed_password AS users_1_hashed_password, users_1.full_name AS users_1_full_name, users_1.`role` AS users_1_role, users_1.staff_type AS users_1_staff_type, users_1.is_active AS users_1_is_active, users_1.restaurant_id AS users_1_restaurant_id, users_1.id AS users_1_id, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at 
FROM (SELECT orders.id AS orders_id, orders.table_id AS orders_table_id, orders.customer_name AS orders_customer_name, orders.order_type AS orders_order_type, orders.status AS orders_status, orders.notes AS orders_notes, orders.total_amount AS orders_total_amount, orders.user_id AS orders_user_id, orders.is_paid AS orders_is_paid, orders.payment_method AS orders_payment_method, orders.deleted_at AS orders_deleted_at, orders.restaurant_id AS orders_restaurant_id, orders.created_at AS orders_created_at, orders.updated_at AS orders_updated_at 
FROM orders 
WHERE orders.restaurant_id = %(restaurant_id_1)s AND orders.deleted_at IS NULL ORDER BY orders.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s) AS anon_1 LEFT OUTER JOIN tables AS tables_1 ON tables_1.id = anon_1.orders_table_id LEFT OUTER JOIN order_items AS order_items_1 ON anon_1.orders_id = order_items_1.order_id LEFT OUTER JOIN menu_items AS menu_items_1 ON menu_items_1.id = order_items_1.menu_item_id LEFT OUTER JOIN menu_item_variants AS menu_item_variants_1 ON menu_item_variants_1.id = order_items_1.variant_id LEFT OUTER JOIN users AS users_1 ON users_1.id = anon_1.orders_user_id ORDER BY anon_1.orders_created_at DESC
2025-10-20 00:58:20,024 - sqlalchemy.engine.Engine - INFO - [cached since 39.36s ago] {'restaurant_id_1': 1, 'param_1': 0, 'param_2': 200}
2025-10-20 00:58:20,062 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,064 - sqlalchemy.engine.Engine - INFO - [cached since 39.34s ago] {'pk_1': 16}
2025-10-20 00:58:20,073 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,075 - sqlalchemy.engine.Engine - INFO - [cached since 39.35s ago] {'pk_1': 9}
2025-10-20 00:58:20,079 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,080 - sqlalchemy.engine.Engine - INFO - [cached since 39.36s ago] {'pk_1': 15}
2025-10-20 00:58:20,083 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,085 - sqlalchemy.engine.Engine - INFO - [cached since 39.36s ago] {'pk_1': 13}
2025-10-20 00:58:20,088 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,089 - sqlalchemy.engine.Engine - INFO - [cached since 39.37s ago] {'pk_1': 14}
2025-10-20 00:58:20,093 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,094 - sqlalchemy.engine.Engine - INFO - [cached since 39.37s ago] {'pk_1': 18}
2025-10-20 00:58:20,098 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,098 - sqlalchemy.engine.Engine - INFO - [cached since 39.38s ago] {'pk_1': 21}
2025-10-20 00:58:20,102 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,103 - sqlalchemy.engine.Engine - INFO - [cached since 39.38s ago] {'pk_1': 19}
2025-10-20 00:58:20,108 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,110 - sqlalchemy.engine.Engine - INFO - [cached since 39.39s ago] {'pk_1': 22}
2025-10-20 00:58:20,115 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,116 - sqlalchemy.engine.Engine - INFO - [cached since 39.39s ago] {'pk_1': 7}
2025-10-20 00:58:20,121 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,121 - sqlalchemy.engine.Engine - INFO - [cached since 39.4s ago] {'pk_1': 5}
2025-10-20 00:58:20,126 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,128 - sqlalchemy.engine.Engine - INFO - [cached since 39.4s ago] {'pk_1': 6}
2025-10-20 00:58:20,131 - sqlalchemy.engine.Engine - INFO - SELECT categories.id AS categories_id, categories.name AS categories_name, categories.description AS categories_description, categories.restaurant_id AS categories_restaurant_id, categories.created_at AS categories_created_at, categories.updated_at AS categories_updated_at, categories.deleted_at AS categories_deleted_at 
FROM categories 
WHERE categories.id = %(pk_1)s
2025-10-20 00:58:20,132 - sqlalchemy.engine.Engine - INFO - [cached since 39.41s ago] {'pk_1': 8}
2025-10-20 00:58:20,142 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:20,145 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-10-20 00:58:34,146 - app.main - INFO - Shutting down background tasks...
